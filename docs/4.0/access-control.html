<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-4.0 docs-doc-page docs-doc-id-access-control" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Authentication, Authorisation, Access Control | RabbitMQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" name="twitter:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" property="og:url" content="https://www.rabbitmq.com/rabbitmq-website/docs/4.0/access-control"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="4.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-4.0"><meta data-rh="true" name="docsearch:version" content="4.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-4.0"><meta data-rh="true" property="og:title" content="Authentication, Authorisation, Access Control | RabbitMQ"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/rabbitmq-website/img/rabbitmq-logo.svg"><link data-rh="true" rel="canonical" href="https://www.rabbitmq.com/rabbitmq-website/docs/4.0/access-control"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/4.0/access-control" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/4.0/access-control" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://H10VQIW16Y-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rabbitmq-website/blog/rss.xml" title="RabbitMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rabbitmq-website/blog/atom.xml" title="RabbitMQ Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="RabbitMQ" href="/rabbitmq-website/opensearch.xml">







<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,700">
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-domain-script="018ee308-473e-754f-b0c2-cbe82d25512f"></script>
<script>function OptanonWrapper(){}</script>
<script>function setGTM(e,t,o,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=t.getElementsByTagName(o)[0],a=t.createElement(o),s="dataLayer"!=n?"&l="+n:"";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+r+s,i.parentNode.insertBefore(a,i)}var timer;function waitForOnetrustActiveGroups(){document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?(clearTimeout(timer),setGTM(window,document,"script","dataLayer","GTM-TT84L8K")):timer=setTimeout(waitForOnetrustActiveGroups,250)}document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?setGTM(window,document,"script","dataLayer","GTM-TT84L8K"):waitForOnetrustActiveGroups()</script><link rel="stylesheet" href="/rabbitmq-website/styles.css">
<script src="/rabbitmq-website/runtime~main.js" defer="defer"></script>
<script src="/rabbitmq-website/main.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:var(--ifm-color-primary-contrast-background);color:var(--ifm-font-color-base)" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong style="font-size: var(--ifm-h4-font-size);"><a href="https://github.com/rabbitmq/rabbitmq-server/releases/tag/v4.1.0">RabbitMQ 4.1.0 is out</a></strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rabbitmq-website/"><div class="navbar__logo"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/rabbitmq-website/tutorials">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rabbitmq-website/docs/4.0">Docs</a><a class="navbar__item navbar__link" href="/rabbitmq-website/blog">Blog</a><a class="navbar__item navbar__link" href="/rabbitmq-website/contact">Support</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/rabbitmq-website/docs/4.0/access-control">4.0</a><ul class="dropdown__menu"><li class=""><strong>Release series</strong></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/next/access-control">Next</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/access-control">4.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/rabbitmq-website/docs/4.0/access-control">4.0</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/3.13/access-control">3.13</a></li><li><a href="https://v3-12.rabbitmq.com/documentation.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/rabbitmq-website/release-information">Release Information</a></li></ul></div><a href="https://github.com/rabbitmq/rabbitmq-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/docs/4.0">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/release-information">Release Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/4.0/download">Install and Upgrade</a><button aria-label="Expand sidebar category &#x27;Install and Upgrade&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/4.0/use-rabbitmq">How to Use RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Use RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/rabbitmq-website/docs/4.0/manage-rabbitmq">How to Manage RabbitMQ</a><button aria-label="Collapse sidebar category &#x27;How to Manage RabbitMQ&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/cli">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/configure">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/relocate">File and Directory Locations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/logging">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/vhosts">Virtual Hosts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/rabbitmq-website/docs/4.0/access-control"> Authentication and Authorization</a><button aria-label="Collapse sidebar category &#x27; Authentication and Authorization&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/authentication">AMQP 0-9-1 Authentication Mechanisms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/passwords">Credentials and Passwords</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/oauth2">OAuth 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/ldap">LDAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/auth-cache-backend">Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/auth-notification">Authentication Failure Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/user-limits">Per User Resource Limits</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/parameters">Policies and Runtime Parameters</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/4.0/metadata-store">Metadata store</a><button aria-label="Expand sidebar category &#x27;Metadata store&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/definitions">Schema Definitions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/4.0/networking">Networking</a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/4.0/clustering">Clustering</a><button aria-label="Expand sidebar category &#x27;Clustering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/rabbitmq-website/docs/4.0/memory-use">Resource Management</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/backup">Backup and Restore</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/rabbitmq-website/docs/4.0/runtime">Tuning</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/production-checklist">Deployment Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/kubernetes/operator/operator-overview">RabbitMQ on Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/4.0/troubleshooting">Troubleshooting RabbitMQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/4.0/monitoring">How to Monitor RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Monitor RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->RabbitMQ<!-- --> <b>4.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/rabbitmq-website/docs/access-control">latest version</a></b> (<!-- -->4.1<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rabbitmq-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/rabbitmq-website/docs/4.0/manage-rabbitmq"><span itemprop="name">How to Manage RabbitMQ</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name"> Authentication and Authorization</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Authentication, Authorisation, Access Control</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>This document describes <a href="#authentication">authentication</a> and <a href="#authorisation">authorisation</a> features
in RabbitMQ. Together they allow the operator to control access to the system.</p>
<p>Different users can be granted access only to specific <a href="/rabbitmq-website/docs/4.0/vhosts">virtual hosts</a>. Their
permissions in each virtual host also can be limited.</p>
<p>RabbitMQ supports two major <a href="#mechanisms">authentication mechanisms</a>
as well as several <a href="#backends">authentication and authorisation backends</a>.</p>
<p>This guide covers a variety of authentication, authorisation and user management topics such as</p>
<ul>
<li><a href="#basics">Access control essentials</a></li>
<li><a href="#default-state">Default virtual host and user</a></li>
<li><a href="#loopback-users">Connectivity limitations</a> imposed on the default user</li>
<li><a href="#authorisation">Authorisation and resource permissions</a></li>
<li>How to <a href="#user-management">manage users and permissions</a> using CLI tools</li>
<li>How to change an authentication or authorization <a href="#backends">backend used</a>, or use a combination of backends</li>
<li>How to <a href="#certificate-authentication">authenticate clients using their TLS certificate information</a></li>
<li>How to limit <a href="#topic-authorisation">access to topics on a topic exchange</a></li>
<li><a href="#user-tags">User tags</a> and how they are used</li>
<li>How to rotate credentials and <a href="#revoke">revoke access</a> for a user</li>
<li><a href="#passwords-and-shell-escaping">Shell escaping</a> of characters in generated passwords</li>
<li>How to <a href="#seeding">pre-create users</a> and their permissions</li>
<li>Troubleshooting of <a href="#troubleshooting-authn">authentication</a> and <a href="#troubleshooting-authz">authorisation failures</a></li>
</ul>
<p><a href="/rabbitmq-website/docs/4.0/passwords">Password-based</a> authentication has a companion guide.
Two closely related topics of <a href="/rabbitmq-website/docs/4.0/oauth2">OAuth 2 support</a> and  <a href="/rabbitmq-website/docs/4.0/ssl">TLS support</a>, including x.509-certificate based authentication,
are covered in dedicated guides.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="terminology-and-definitions">Terminology and Definitions<a href="#terminology-and-definitions" class="hash-link" aria-label="Direct link to Terminology and Definitions" title="Direct link to Terminology and Definitions">​</a></h2>
<p>Authentication and authorisation are often confused or used
interchangeably. That&#x27;s wrong and in RabbitMQ, the two are
separated. For the sake of simplicity, we&#x27;ll define
authentication as &quot;identifying who the user is&quot; and
authorisation as &quot;determining what the user is and isn&#x27;t allowed to do.&quot;</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basics">The Basics<a href="#basics" class="hash-link" aria-label="Direct link to The Basics" title="Direct link to The Basics">​</a></h2>
<p>When clients <a href="/rabbitmq-website/docs/4.0/connections">connect</a> to RabbitMQ, they specify a set of credentials:
a username-password pair, a <a href="/rabbitmq-website/docs/4.0/oauth2">JWT token</a>, or a <a href="/rabbitmq-website/docs/4.0/ssl">x.509 certificate</a>. Every connection has
an associated user which is authenticated. It also targets a <a href="/rabbitmq-website/docs/4.0/vhosts">virtual host</a> for which
the user must have a certain set of permissions.</p>
<p>User credentials, target virtual host and (optionally) client <a href="/rabbitmq-website/docs/4.0/ssl">certificate</a> are specified at connection
initiation time.</p>
<p>There is a default pair of credentials called the <a href="#default-state">default user</a>. This user can only
be <a href="#loopback-users">used for <strong>host-local connections</strong></a> by default. Remote connections that use
the default user will be refused.</p>
<p><a href="/rabbitmq-website/docs/4.0/production-checklist">Production environments</a> should not use the default user.
Create new user accounts with generated credentials instead.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-state">Default Virtual Host and User<a href="#default-state" class="hash-link" aria-label="Direct link to Default Virtual Host and User" title="Direct link to Default Virtual Host and User">​</a></h2>
<p>When the server first starts running, and detects that its
database is uninitialised or has been reset or deleted (the node is a &quot;blank node&quot;), it
initialises a fresh database with the following resources:</p>
<ul>
<li>a <a href="/rabbitmq-website/docs/4.0/vhosts">virtual host</a> named <code>/</code> (a slash)</li>
<li>a user named <code>guest</code> with a default password of <code>guest</code>, granted full access to the <code>/</code> virtual host</li>
</ul>
<p>If a blank node <a href="/rabbitmq-website/docs/4.0/definitions#import-on-boot-nuances">imports definitions on boot</a>,
this default user will not be created.</p>
<p>It is <strong>highly recommended</strong> to <a href="#seeding">pre-configure a new user with a generated username and password</a> or <a href="/rabbitmq-website/docs/4.0/man/rabbitmqctl.8#delete_user">delete</a>
the <code>guest</code> user or at least <a href="/rabbitmq-website/docs/4.0/man/rabbitmqctl.8#change_password">change its password</a>
to reasonably secure generated value that won&#x27;t be known to the public.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="authentication">Authentication: Who Do You Say You Are?<a href="#authentication" class="hash-link" aria-label="Direct link to Authentication: Who Do You Say You Are?" title="Direct link to Authentication: Who Do You Say You Are?">​</a></h2>
<p>After an application connects to RabbitMQ and before it can perform operations, it must
authenticate, that is, present and prove its identity. With that identity, RabbitMQ nodes can
look up its permissions and <a href="#authorisation">authorize</a> access to resources
such as <a href="/rabbitmq-website/docs/4.0/vhosts">virtual hosts</a>, queues, exchanges, and so on.</p>
<p>Two primary ways of authenticating a client are <a href="/rabbitmq-website/docs/4.0/passwords">username/password pairs</a>
and <a href="https://en.wikipedia.org/wiki/X.509" target="_blank" rel="noopener noreferrer">X.509 certificates</a>. Username/password pairs
can be used with a variety of <a href="#backends">authentication backends</a> that verify the credentials.</p>
<p>Connections that fail to authenticate will be closed with an error message in the <a href="/rabbitmq-website/docs/4.0/logging">server log</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="certificate-authentication">Authentication using Client TLS (x.509) Certificate Data<a href="#certificate-authentication" class="hash-link" aria-label="Direct link to Authentication using Client TLS (x.509) Certificate Data" title="Direct link to Authentication using Client TLS (x.509) Certificate Data">​</a></h3>
<p>To authenticate client connections using X.509 certificate a built-in plugin,
<a href="https://github.com/rabbitmq/rabbitmq-server/tree/main/deps/rabbitmq_auth_mechanism_ssl" target="_blank" rel="noopener noreferrer">rabbitmq-auth-mechanism-ssl</a>,
must be enabled and clients must be <a href="#mechanisms">configured to use the EXTERNAL mechanism</a>.
With this mechanism, any client-provided password will be ignored.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="loopback-users">&quot;guest&quot; user can only connect from localhost<a href="#loopback-users" class="hash-link" aria-label="Direct link to &quot;guest&quot; user can only connect from localhost" title="Direct link to &quot;guest&quot; user can only connect from localhost">​</a></h2>
<p>By default, the <code>guest</code> user is prohibited from
connecting from remote hosts; it can only connect over
a loopback interface (<code>localhost</code>). This
applies to <a href="/rabbitmq-website/docs/4.0/connections">connections regardless of the protocol</a>.
Any other users will not (by default) be restricted in this way.</p>
<p>Remote connections that use
the default user will be refused with a <a href="/rabbitmq-website/docs/4.0/logging">log message</a> similar to this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[error] &lt;0.918.0&gt; PLAIN login refused: user &#x27;guest&#x27; can only connect via localhost</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The recommended way to address this in production systems
is to create a new user with generated credentials, or set of users, with the permissions
to access the necessary virtual hosts. This can be done
using <a href="/rabbitmq-website/docs/4.0/cli">CLI tools</a>, <a href="/rabbitmq-website/docs/4.0/management">HTTP API or definitions import</a>.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p><a href="https://packages.fedoraproject.org/pkgs/rabbitmq-server/rabbitmq-server/" target="_blank" rel="noopener noreferrer">Fedora Linux&#x27;s RabbitMQ package</a> is
<a href="https://src.fedoraproject.org/rpms/rabbitmq-server/blob/f41/f/rabbitmq-server-0001-Allow-guest-login-from-non-loopback-connections.patch" target="_blank" rel="noopener noreferrer">patched</a>
to allow for remote connections with well known credentials.</p><p>This practice is very strongly recommended against.
Fedora Linux users should consider installing RabbitMQ from <a href="/rabbitmq-website/docs/install-rpm">Team RabbitMQ&#x27;s package
repositories</a> and avoid using the distribution-packaged version unless this serious
distribution-specific security flaw is <a href="https://bugzilla.redhat.com/show_bug.cgi?id=2333073" target="_blank" rel="noopener noreferrer">addressed</a>.</p></div></div>
<p>This is configured via the <code>loopback_users</code> item
in the <a href="/rabbitmq-website/docs/4.0/configure#configuration-files">configuration file</a>.</p>
<p>It is possible to allow the <code>guest</code> user to connect
from a remote host by setting the
<code>loopback_users</code> configuration to
<code>none</code>.</p>
<p>A minimalistic <a href="/rabbitmq-website/docs/4.0/configure">RabbitMQ config file</a>
which allows remote connections for <code>guest</code> looks like so:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># DANGER ZONE!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># allowing remote connections for default user is highly discouraged</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># as it dramatically decreases the security of the system. Delete the default user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># instead and create a new one with generated secure credentials, or use JWT tokens,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># or x.509 certificates for clients to authenticate themselves</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loopback_users = none</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="user-management">Managing Users and Permissions<a href="#user-management" class="hash-link" aria-label="Direct link to Managing Users and Permissions" title="Direct link to Managing Users and Permissions">​</a></h2>
<p>Users and permissions can be managed using <a href="/rabbitmq-website/docs/4.0/cli">CLI tools</a> and definition import (covered below).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="passwords-and-shell-escaping">Before We Start: Shell Escaping and Generated Passwords<a href="#passwords-and-shell-escaping" class="hash-link" aria-label="Direct link to Before We Start: Shell Escaping and Generated Passwords" title="Direct link to Before We Start: Shell Escaping and Generated Passwords">​</a></h3>
<p>It is a common security practice to generate complex passwords,
often involving non-alphanumeric characters. This practice is perfectly
applicable to RabbitMQ users.</p>
<p>Shells (<code>bash</code>, <code>zsh</code>, and so on) interpret certain characters
(<code>!</code>, <code>?</code>, <code>&amp;</code>, <code>^</code>, <code>&quot;</code>, <code>&#x27;</code>, <code>*</code>, <code>~</code>, and others) as control characters.</p>
<p>When a password is specified on the command line for <code>rabbitmqctl add_user</code>, <code>rabbitmqctl change_password</code>,
and other commands that accept a password, such control characters must be escaped appropriately
for the shell used.
With inappropriate escaping the command will fail or RabbitMQ CLI tools will receive a different value
from the shell.</p>
<p>When generating passwords that will be passed on the command line,
long (say, 40 to 100 characters) alphanumeric value with a very limited set of
symbols (e.g. <code>:</code>, <code>=</code>) is the safest option.</p>
<p>When users are created via <a href="/rabbitmq-website/docs/4.0/management">HTTP API</a> without using a shell (e.g. <code>curl</code>),
the control character limitation does not apply. However, different escaping rules may be necessary
depending on the programming language used.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-a-user">Adding a User<a href="#adding-a-user" class="hash-link" aria-label="Direct link to Adding a User" title="Direct link to Adding a User">​</a></h3>
<p>To add a user, use <code>rabbitmqctl add_user</code>. It has multiple ways of specifying a <a href="/rabbitmq-website/docs/4.0/passwords">password</a>:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">cmd</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># will prompt for password, only use this option interactively</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl add_user </span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Password is provided via standard input.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Note that certain characters such as !, &amp;, $, #, and so on must be escaped to avoid</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># special interpretation by the shell.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2a55f70a841f18b97c3a7db939b7adc9e34a0f1b&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> rabbitmqctl add_user </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Password is provided as a command line argument.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Note that certain characters such as !, &amp;, $, #, and so on must be escaped to avoid</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># special interpretation by the shell.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl add_user </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2a55f70a841f18b97c3a7db939b7adc9e34a0f1b&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># password is provided as a command line argument</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat add_user </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;9a55f70a841f18b97c3a7db939b7adc9e34a0f1d&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># passwords with special characters must be quoted correctly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat add_user </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;w63pnZ&amp;LnYMO(t&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-batch codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-batch codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">rem password is provided as a command line argument</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token command keyword" style="color:#00009f">rabbitmqctl</span><span class="token command">.bat add_user </span><span class="token command string" style="color:#e3116c">&quot;username&quot;</span><span class="token command"> </span><span class="token command string" style="color:#e3116c">&quot;9a55f70a841f18b97c3a7db939b7adc9e34a0f1d&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">rem passwords with special characters must be quoted correctly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token command keyword" style="color:#00009f">rabbitmqctl</span><span class="token command">.bat add_user </span><span class="token command string" style="color:#e3116c">&quot;username&quot;</span><span class="token command"> </span><span class="token command string" style="color:#e3116c">&quot;w63pnZ&amp;LnYMO(t&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>A newly added user must be <a href="#grant-permissions">granted permissions</a> for one or more virtual hosts,
otherwise its connections will be refused.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="listing-users">Listing Users<a href="#listing-users" class="hash-link" aria-label="Direct link to Listing Users" title="Direct link to Listing Users">​</a></h3>
<p>To list users in a cluster, use <code>rabbitmqctl list_users</code>:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl list_users</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat list_users</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>The output can be changed to be JSON:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl list_users </span><span class="token parameter variable" style="color:#36acaa">--formatter</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat list_users </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">formatter=json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deleting-a-user">Deleting a User<a href="#deleting-a-user" class="hash-link" aria-label="Direct link to Deleting a User" title="Direct link to Deleting a User">​</a></h3>
<p>To delete a user, use <code>rabbitmqctl delete_user</code>:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl delete_user </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat delete_user </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="grant-permissions">Granting Permissions to a User<a href="#grant-permissions" class="hash-link" aria-label="Direct link to Granting Permissions to a User" title="Direct link to Granting Permissions to a User">​</a></h3>
<p>To grant <a href="#authorisation">permissions</a> to a user in a <a href="/rabbitmq-website/docs/4.0/vhosts">virtual host</a>, use <code>rabbitmqctl set_permissions</code>:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># First &quot;.*&quot; for configure permission on every entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Second &quot;.*&quot; for write permission on every entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Third &quot;.*&quot; for read permission on every entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl set_permissions </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;custom-vhost&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.*&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.*&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.*&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># First &quot;.*&quot; for configure permission on every entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Second &quot;.*&quot; for write permission on every entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Third &quot;.*&quot; for read permission on every entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat set_permissions </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p </span><span class="token string" style="color:#e3116c">&#x27;custom-vhost&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.*&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.*&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.*&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="clearing-permissions-of-a-user-in-a-virtual-host">Clearing Permissions of a User in a Virtual Host<a href="#clearing-permissions-of-a-user-in-a-virtual-host" class="hash-link" aria-label="Direct link to Clearing Permissions of a User in a Virtual Host" title="Direct link to Clearing Permissions of a User in a Virtual Host">​</a></h3>
<p>To revoke <a href="#authorisation">permissions</a> from a user in a <a href="/rabbitmq-website/docs/4.0/vhosts">virtual host</a>, use <code>rabbitmqctl clear_permissions</code>:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Revokes permissions in a virtual host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl clear_permissions </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;custom-vhost&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Revokes permissions in a virtual host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat clear_permissions </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p </span><span class="token string" style="color:#e3116c">&#x27;custom-vhost&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="operations-on-multiple-virtual-hosts">Operations on Multiple Virtual Hosts<a href="#operations-on-multiple-virtual-hosts" class="hash-link" aria-label="Direct link to Operations on Multiple Virtual Hosts" title="Direct link to Operations on Multiple Virtual Hosts">​</a></h3>
<p>Every <code>rabbitmqctl</code> permission management operation is scoped to a single virtual host.
Bulk operations have to be scripted, with the list of virtual hosts coming from <code>rabbitmqctl list_vhosts --silent</code>:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Assumes a Linux shell.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Grants a user permissions to all virtual hosts.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:#36acaa">v</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">rabbitmqctl list_vhosts </span><span class="token variable parameter variable" style="color:#36acaa">--silent</span><span class="token variable" style="color:#36acaa">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> rabbitmqctl set_permissions </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$v</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a-user&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.*&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.*&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;.*&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat list_vhosts </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">silent </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat set_permissions </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p </span><span class="token variable" style="color:#36acaa">$_</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;a-user&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.*&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.*&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.*&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="seeding">Seeding (Pre-creating) Users and Permissions<a href="#seeding" class="hash-link" aria-label="Direct link to Seeding (Pre-creating) Users and Permissions" title="Direct link to Seeding (Pre-creating) Users and Permissions">​</a></h2>
<p><a href="/rabbitmq-website/docs/4.0/production-checklist">Production environments</a> typically need to pre-configure (seed) a number
of virtual hosts, users and user permissions.</p>
<p>This can be done in a few ways:</p>
<ul>
<li>Using <a href="/rabbitmq-website/docs/4.0/cli">CLI tools</a></li>
<li><a href="/rabbitmq-website/docs/4.0/definitions">Definition export and import on node boot</a> (recommended)</li>
<li>Override <a href="#default-state">default credentials</a> in configuration file(s)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-tools">CLI Tools<a href="#cli-tools" class="hash-link" aria-label="Direct link to CLI Tools" title="Direct link to CLI Tools">​</a></h3>
<p>See the section on <a href="#user-management">User Management</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="definition-import-at-node-boot-time">Definition Import at Node Boot Time<a href="#definition-import-at-node-boot-time" class="hash-link" aria-label="Direct link to Definition Import at Node Boot Time" title="Direct link to Definition Import at Node Boot Time">​</a></h3>
<p>This process involves the following steps:</p>
<ul>
<li>Set up a temporary node and create the necessary virtual host, users, permissions, and so on using CLI tools</li>
<li>Export definitions to a definition file</li>
<li>Remove parts of the file that are not relevant</li>
<li>Configure the node to import the file on node boot or after</li>
</ul>
<p>See <a href="/rabbitmq-website/docs/4.0/definitions#import-on-boot">importing definitions on node boot</a> in the definitions guide to learn more.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="definition-import-after-node-boot">Definition Import After Node Boot<a href="#definition-import-after-node-boot" class="hash-link" aria-label="Direct link to Definition Import After Node Boot" title="Direct link to Definition Import After Node Boot">​</a></h3>
<p>See <a href="/rabbitmq-website/docs/4.0/definitions#import">importing definitions after node boot</a> in the definitions guide.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="override-default-user-credentials">Override Default User Credentials<a href="#override-default-user-credentials" class="hash-link" aria-label="Direct link to Override Default User Credentials" title="Direct link to Override Default User Credentials">​</a></h3>
<p>Two configuration options can be used to override default user credentials. This user will only
be created <strong>on first node boot</strong> so they must exist in the configuration file before
first boot.</p>
<p>The settings are:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># default is &quot;guest&quot;, and its access is limited to localhost only.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># See ./access-control#default-state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_user = a-user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># default is &quot;guest&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_pass = 768a852ed69ce916fa7faa278c962de3e4275e5f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As with all values in <a href="/rabbitmq-website/docs/4.0/configure#config-file"><code>rabbitmq.conf</code></a>, the <code>#</code> character
starts a comment so this character must be avoided in generated credentials.</p>
<p>Default user credentials can also be encrypted.
That requires the use of the <a href="/rabbitmq-website/docs/4.0/configure#advanced-config-file">advanced configuration file</a>, <code>advanced.config</code>.
This topic is covered in more detail in <a href="/rabbitmq-website/docs/4.0/configure#configuration-encryption">Configuration Value Encryption</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="authorisation">Authorisation: How Permissions Work<a href="#authorisation" class="hash-link" aria-label="Direct link to Authorisation: How Permissions Work" title="Direct link to Authorisation: How Permissions Work">​</a></h2>
<p>When a RabbitMQ client establishes a connection to a
server and <a href="#authentication">authenticates</a>, it specifies a virtual host within which it intends
to operate. A first level of access control is enforced at
this point, with the server checking whether the user has
any permissions to access the virtual hosts, and rejecting
the connection attempt otherwise.</p>
<p>Resources, i.e. exchanges and queues, are named entities
inside a particular virtual host; the same name denotes a
different resource in each virtual host. A second level of
access control is enforced when certain operations are
performed on resources.</p>
<p>RabbitMQ distinguishes between <code>configure</code>,
<code>write</code> and <code>read</code> operations on a
resource. The <code>configure</code> operations create or
destroy resources, or alter their behaviour. The
<code>write</code> operations inject messages into a
resource. And the <code>read</code> operations retrieve messages
from a resource.</p>
<p>In order to perform an operation on a resource the user must
have been granted the appropriate permissions for it. The
following table shows what permissions on what type of
resource are required for all the AMQP 0-9-1 commands which
perform permission checks.</p>
<table><tr><th>AMQP 0-9-1 Operation</th><th></th><th>configure</th><th>write</th><th>read</th></tr><tr><td>exchange.declare</td><td>(passive=false)</td><td>exchange</td><td></td><td></td></tr><tr><td>exchange.declare</td><td>(passive=true)</td><td></td><td></td><td></td></tr><tr><td>exchange.declare</td><td>(with <a href="./ae">AE</a>)</td><td>exchange</td><td>exchange (AE)</td><td>exchange</td></tr><tr><td>exchange.delete</td><td></td><td>exchange</td><td></td><td></td></tr><tr><td>queue.declare</td><td>(passive=false)</td><td>queue</td><td></td><td></td></tr><tr><td>queue.declare</td><td>(passive=true)</td><td></td><td></td><td></td></tr><tr><td>queue.declare</td><td>(with <a href="./dlx">DLX</a>)</td><td>queue</td><td>exchange (DLX)</td><td>queue</td></tr><tr><td>queue.delete</td><td></td><td>queue</td><td></td><td></td></tr><tr><td>exchange.bind</td><td></td><td></td><td>exchange (destination)</td><td>exchange (source)</td></tr><tr><td>exchange.unbind</td><td></td><td></td><td>exchange (destination)</td><td>exchange (source)</td></tr><tr><td>queue.bind</td><td></td><td></td><td>queue</td><td>exchange</td></tr><tr><td>queue.unbind</td><td></td><td></td><td>queue</td><td>exchange</td></tr><tr><td>basic.publish</td><td></td><td></td><td>exchange</td><td></td></tr><tr><td>basic.get</td><td></td><td></td><td></td><td>queue</td></tr><tr><td>basic.consume</td><td></td><td></td><td></td><td>queue</td></tr><tr><td>queue.purge</td><td></td><td></td><td></td><td>queue</td></tr></table>
<p>Permissions are expressed as a triple of regular expressions
— one each for configure, write and read — on a per-vhost
basis. The user is granted the respective permission for
operations on all resources with names matching the regular
expressions.</p>
<p>For example, the table above demonstrates that the <code>queue.bind</code>
protocol operation requires <code>write</code> permission on the target <code>queue</code>
and the <code>read</code> permission is required on the target <code>exchange</code>.</p>
<p>In other words, in order to allow a user to bind a queue named <code>queueA</code> to
an exchange named <code>exchangeB</code> the user will need the <code>write</code>
permission regex (for the correct virtual host) to match <code>queueA</code>,
and the <code>read</code> permission regex to match <code>exchangeB</code>.</p>
<p>For convenience RabbitMQ maps AMQP 0-9-1&#x27;s
default exchange&#x27;s blank name to &#x27;amq.default&#x27; when
performing permission checks.</p>
<p>The regular expression <code>&#x27;^$&#x27;</code>, i.e. matching
nothing but the empty string, covers all resources and
effectively stops the user from performing any operation.
Built-in AMQP 0-9-1 resource names are prefixed with
<code>amq.</code> and server generated names are prefixed
with <code>amq.gen</code>.</p>
<p>For example, <code>&#x27;^(amq\.gen.*|amq\.default)$&#x27;</code> gives a user access to
server-generated names and the default exchange.  The empty
string, <code>&#x27;&#x27;</code> is a synonym for <code>&#x27;^$&#x27;</code>
and restricts permissions in the exact same way.</p>
<p>RabbitMQ may <a href="/rabbitmq-website/docs/4.0/auth-cache-backend">cache</a> the results of access control checks on a
per-connection or per-channel basis. Hence changes to user
permissions may only take effect when the user reconnects.</p>
<p>For details of how to set up access control, please see the
<a href="#user-management">User management</a> section
as well as the <a href="/rabbitmq-website/docs/4.0/man/rabbitmqctl.8">rabbitmqctl man page</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-tags">User Tags and Management UI Access<a href="#user-tags" class="hash-link" aria-label="Direct link to User Tags and Management UI Access" title="Direct link to User Tags and Management UI Access">​</a></h3>
<p>In addition to the permissions covered above, users can have tags
associated with them. Currently only management UI access is  controlled by user tags.</p>
<p>The tags are managed using <a href="/rabbitmq-website/docs/4.0/man/rabbitmqctl.8#set_user_tags">rabbitmqctl</a>.
Newly created users do not have any tags set on them by default.</p>
<p>Please refer to the <a href="/rabbitmq-website/docs/4.0/management#permissions">management plugin guide</a> to learn
more about what tags are supported and how they limit management UI access.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="topic-authorisation">Topic Authorisation<a href="#topic-authorisation" class="hash-link" aria-label="Direct link to Topic Authorisation" title="Direct link to Topic Authorisation">​</a></h2>
<p>RabbitMQ supports topic authorisation for topic exchanges. The routing key of a message
published to a topic exchange is taken into account when
publishing authorisation is enforced (e.g. in RabbitMQ default authorisation backend,
the routing key is matched against a regular expression to decide whether the message can be
routed downstream or not).
Topic authorisation targets protocols like STOMP and MQTT, which are structured
around topics and use topic exchanges under the hood.</p>
<p>Topic authorisation is an additional layer on top of
existing checks for publishers. Publishing a
message to a topic-typed exchange will go through both the
<code>basic.publish</code> and the routing key checks.
The latter is never called if the former refuses access.</p>
<p>Topic authorisation can also be enforced for topic consumers.
Note that it works differently for different protocols. The concept
of topic authorisation only really makes sense for the topic-oriented protocols such as MQTT
and STOMP. In AMQP 0-9-1, for example, consumers consume from queues
and thus the standard resource permissions apply. In addition for AMQP 0-9-1,
binding routing keys between an AMQP 0-9-1 topic exchange and
a queue/exchange are checked against the topic permissions configured, if any.
For more information about how RabbitMQ handles authorisation for topics, please see
the <a href="/rabbitmq-website/docs/4.0/stomp">STOMP</a> and <a href="/rabbitmq-website/docs/4.0/mqtt">MQTT</a>
documentation guides.</p>
<p>When default authorisation backend is used, publishing to a
topic exchange or consuming from a topic is always authorised
if no topic permissions
are defined (which is the case on a fresh RabbitMQ
installation). With this authorisation backend, topic
authorisation is optional: you don&#x27;t need to approve any
exchanges. To use topic authorisation therefore you need to opt in
and define topic permissions for one or more exchanges. For details please see
the <a href="/rabbitmq-website/docs/4.0/man/rabbitmqctl.8">rabbitmqctl man page</a>.</p>
<p>Internal (default) authorisation backend supports variable expansion
in permission patterns.
Three variables are supported: <code>username</code>, <code>vhost</code>,
and <code>client_id</code>. Note that <code>client_id</code> only
applies to MQTT. For example, if <code>tonyg</code> is the
connected user, the permission <code>^{username}-.*</code> is expanded to
<code>^tonyg-.*</code></p>
<p>If a different authorisation backend (e.g. <a href="/rabbitmq-website/docs/4.0/ldap">LDAP</a>,
<a href="https://github.com/rabbitmq/rabbitmq-server/tree/v3.13.x/deps/rabbitmq_auth_backend_http" target="_blank" rel="noopener noreferrer">HTTP</a>,
<a href="/rabbitmq-website/docs/4.0/oauth2">OAuth 2</a>) is used, please refer
to the documentation of those backends.</p>
<p>If a custom authorisation backend is used, topic
authorisation is enforced by implementing the
<code>check_topic_access</code> callback of the
<code>rabbit_authz_backend</code> behavior.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="revoke">Revoking User Access and Credential Rotation<a href="#revoke" class="hash-link" aria-label="Direct link to Revoking User Access and Credential Rotation" title="Direct link to Revoking User Access and Credential Rotation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="revoking-user-access">Revoking User Access<a href="#revoking-user-access" class="hash-link" aria-label="Direct link to Revoking User Access" title="Direct link to Revoking User Access">​</a></h3>
<p>To revoke user access, the recommended procedure is <a href="#user-management">deleting the user</a>.
All open connections that belong to a deleted user will be closed.</p>
<p>It is also possible to clear user permissions but that will not affect
any currently open connections. Connections
use an authorization operation cache, so client operations
will be refused eventually. The period of time depends on the
<a href="#backends">authorization backend</a> used.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="credential-rotation">Credential Rotation<a href="#credential-rotation" class="hash-link" aria-label="Direct link to Credential Rotation" title="Direct link to Credential Rotation">​</a></h3>
<p>A credential rotation for credentials of users stored in the internal data store usually involves the following steps:</p>
<ul>
<li><a href="/rabbitmq-website/docs/4.0/man/rabbitmqctl.8#change_password">changing user password</a> using CLI tools
or update it using the <code>PUT /api/users/{user}</code> <a href="/rabbitmq-website/docs/4.0/management">HTTP API</a> endpoint</li>
<li>Using <code>rabbitmqctl close_all_user_connections</code> or <code>rabbitmqctl close_all_connections</code> to close all existing connections</li>
<li>Making sure that applications can discover the new credentials and reconnect, for example, by restarting them</li>
</ul>
<p>In case of a suspected credential leak, a more thorough credential rotation procedure can be employed:</p>
<ul>
<li>Assessing the permissions of the user and <a href="/rabbitmq-website/docs/4.0/definitions">obtaining a complete cluster definitions file</a></li>
<li><a href="#user-management">Delete the user</a>, thus revoking its access and closing all existing connections that used those credentials</li>
<li>Re-adding the user with a new generated password</li>
<li>Re-granting the user access to all the virtual hosts it had access to earlier</li>
<li>Making sure that applications can discover the new credentials and reconnect, for example, by restarting them</li>
</ul>
<p>With external <a href="#backends">authN backends</a> such as <a href="/rabbitmq-website/docs/4.0/ldap">LDAP</a>, user accounts are managed externally to RabbitMQ,
therefore the credential rotation routine will also be external to RabbitMQ.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="backends">Authentication and Authorisation Backends<a href="#backends" class="hash-link" aria-label="Direct link to Authentication and Authorisation Backends" title="Direct link to Authentication and Authorisation Backends">​</a></h2>
<p>Authentication and authorisation are pluggable. Plugins can provide implementations
of:</p>
<ul>
<li>authentication (&quot;authn&quot;) backends: they determine client identity and decide whether the client should be allowed to connect</li>
<li>authorisation (&quot;authz&quot;) backends: they determine whether an identified (authenticated) client is authorized to perform a certain operation</li>
</ul>
<p>It is possible and common for a plugin to provide both backends. RabbitMQ ships with
the following <a href="/rabbitmq-website/docs/4.0/plugins">built-in plugins</a> which provide both authentication and authorisation backends:</p>
<ul>
<li><a href="/rabbitmq-website/docs/4.0/ldap">LDAP</a></li>
<li><a href="https://github.com/rabbitmq/rabbitmq-server/tree/v3.13.x/deps/rabbitmq_auth_backend_http" target="_blank" rel="noopener noreferrer">HTTP</a></li>
</ul>
<p>The following built-in plugins provide authorisation backend implementations:</p>
<ul>
<li><a href="/rabbitmq-website/docs/4.0/oauth2">OAuth2</a></li>
</ul>
<p>Some plugins such as <a href="https://github.com/gotthardp/rabbitmq-auth-backend-ip-range" target="_blank" rel="noopener noreferrer">Source IP range one</a>
also only provide an authorisation backend.</p>
<p>Authentication is supposed to be handled by the internal database, LDAP, etc.</p>
<p>A special <a href="/rabbitmq-website/docs/4.0/auth-cache-backend">cache backend</a>
can be used in <a href="#combined-backends">combination</a> with other backends to significantly
reduce the load they generate on external services, such as LDAP or HTTP servers.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="combined-backends">Combining Backends<a href="#combined-backends" class="hash-link" aria-label="Direct link to Combining Backends" title="Direct link to Combining Backends">​</a></h3>
<p>It is possible to use multiple backends for
<code>authn</code> or <code>authz</code> using the
<code>auth_backends</code> configuration key. When
several authentication backends are used then the first
positive result returned by a backend in the chain is
considered to be final. This should not be confused with
mixed backends (for example, using LDAP for authentication and internal
backend for authorisation).</p>
<p>The following example configures RabbitMQ to use the internal backend
only (and is the default):</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rabbitmq.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1 here is a backend name. It can be anything.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Since we only really care about backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ordering, we use numbers throughout this guide.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># &quot;internal&quot; is an alias for rabbit_auth_backend_internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1 = internal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The example above uses an alias, <code>internal</code> for <code>rabbit_auth_backend_internal</code>.
The following aliases are available:</p>
<ul>
<li><code>internal</code> for <code>rabbit_auth_backend_internal</code></li>
<li><code>ldap</code> for <code>rabbit_auth_backend_ldap</code> (from the <a href="/rabbitmq-website/docs/4.0/ldap">LDAP plugin</a>)</li>
<li><code>oauth</code> or <code>oauth2</code> for <code>rabbit_auth_backend_oauth2</code> (from the <a href="/rabbitmq-website/docs/4.0/oauth2">OAuth 2.0 plugin</a>)</li>
<li><code>http</code> for <code>rabbit_auth_backend_http</code> (from the <a href="https://github.com/rabbitmq/rabbitmq-server/tree/main/deps/rabbitmq_auth_backend_http" target="_blank" rel="noopener noreferrer">HTTP auth backend plugin</a>)</li>
<li><code>dummy</code> for <code>rabbit_auth_backend_dummy</code></li>
</ul>
<p>For plugins that do not have a shortcut, a full module (not the name of the plugin!) must
be used:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># note that the module name begins with a &quot;rabbit_&quot;, not &quot;rabbitmq_&quot;, like plugin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># names usually do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1 = rabbit_auth_backend_ip_range</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When using third party plugins, providing a full module name is necessary.</p>
<p>The following example configures RabbitMQ to use the <a href="/rabbitmq-website/docs/4.0/ldap">LDAP backend</a>
for both authentication and authorisation. Internal database will not be consulted:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1 = ldap</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will check LDAP first, and then fall back to the internal
database if the user cannot be authenticated through LDAP:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1 = ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.2 = internal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Same as above but will fall back to the <a href="https://github.com/rabbitmq/rabbitmq-server/tree/v3.13.x/deps/rabbitmq_auth_backend_http" target="_blank" rel="noopener noreferrer">HTTP backend</a>
instead:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rabbitmq.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1 = ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># uses module name instead of a short alias, &quot;http&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.2 = rabbit_auth_backend_http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># See HTTP backend docs for details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_http.user_path = http://my-authenticator-app/auth/user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_http.vhost_path = http://my-authenticator-app/auth/vhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_http.resource_path = http://my-authenticator-app/auth/resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_http.topic_path = http://my-authenticator-app/auth/topic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The following example configures RabbitMQ to use the internal
database for authentication and the <a href="https://github.com/gotthardp/rabbitmq-auth-backend-ip-range" target="_blank" rel="noopener noreferrer">source IP range backend</a> for authorisation:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rabbitmq.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1.authn = internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># uses module name because this backend is from a 3rd party</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1.authz = rabbit_auth_backend_ip_range</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The following example configures RabbitMQ to use the <a href="/rabbitmq-website/docs/4.0/ldap">LDAP backend</a>
for authentication and the internal backend for authorisation:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rabbitmq.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1.authn = ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1.authz = internal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The example below is fairly advanced. It will check LDAP
first. If the user is found in LDAP then the password will be
checked against LDAP and subsequent authorisation checks will
be performed against the internal database (therefore users in
LDAP must exist in the internal database as well, but do not
need a password there). If the user is not found in LDAP then
a second attempt is made using only the internal database:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># rabbitmq.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1.authn = ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.1.authz = internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_backends.2       = internal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mechanisms">Authentication Mechanisms<a href="#mechanisms" class="hash-link" aria-label="Direct link to Authentication Mechanisms" title="Direct link to Authentication Mechanisms">​</a></h2>
<p>RabbitMQ supports multiple SASL authentication
mechanisms. There are four such mechanisms built into the
server: <code>PLAIN</code>, <code>AMQPLAIN</code>, <code>ANONYMOUS</code>,
and <code>RABBIT-CR-DEMO</code>, and one — <code>EXTERNAL</code> —
available as a <a href="https://github.com/rabbitmq/rabbitmq-server/tree/main/deps/rabbitmq_auth_mechanism_ssl" target="_blank" rel="noopener noreferrer">plugin</a>.</p>
<p>More authentication mechanisms can be provided by plugins. See
the <a href="/rabbitmq-website/plugin-development">plugin development guide</a> for more information on general plugin
development.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="available-mechanisms">Built-in Authentication Mechanisms<a href="#available-mechanisms" class="hash-link" aria-label="Direct link to Built-in Authentication Mechanisms" title="Direct link to Built-in Authentication Mechanisms">​</a></h3>
<p>The built-in mechanisms are:</p>
<table><thead><td>Mechanism</td><td>Description</td></thead><tr><td>PLAIN</td><td><p>SASL PLAIN authentication. This is enabled by default in
the RabbitMQ server and clients, and is the default for most
other clients.</p></td></tr><tr><td>AMQPLAIN</td><td><p>Non-standard version of PLAIN retained for backwards compatibility.
This is enabled by default in the RabbitMQ server.</p></td></tr><tr><td>ANONYMOUS</td><td><p>This mechanism is enabled by default allowing anonymous clients to connect without providing
any credentials. RabbitMQ will internally authenticate and authorize the client using the credentials
configured in <code>anonymous_login_user</code> and <code>anonymous_login_pass</code> (both are set to <code>guest</code> by default).
In other words, any unauthenticated client will be able to connect and act as the configured <code>anonymous_login_user</code>.
<strong>For production environments, remove this mechanism.</strong>
See the <a href="./production-checklist#anonymous-login">Deployment Guidelines</a> guide.</p></td></tr><tr><td>EXTERNAL</td><td><p>Authentication happens using an out-of-band mechanism
such as <a href="https://github.com/rabbitmq/rabbitmq-server/tree/main/deps/rabbitmq_auth_mechanism_ssl">x509 certificate peer verification</a>,
client IP address range, or similar. Such mechanisms are usually provided by RabbitMQ plugins.</p></td></tr><tr><td>RABBIT-CR-DEMO</td><td>Non-standard mechanism which demonstrates
challenge-response authentication. This mechanism has
security equivalent to <code>PLAIN</code>, and
is <strong>not</strong> enabled by default in the RabbitMQ server.</td></tr></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="server-mechanism-configuration">Mechanism Configuration in the Server<a href="#server-mechanism-configuration" class="hash-link" aria-label="Direct link to Mechanism Configuration in the Server" title="Direct link to Mechanism Configuration in the Server">​</a></h3>
<p>The <code>auth_mechanisms</code> configuration key determines which of the
installed mechanisms are offered to connecting clients.</p>
<p>This variable should be a list of accepted values corresponding to
mechanism names, for example, the following list</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">auth_mechanisms.1 = PLAIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_mechanisms.2 = AMQPLAIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_mechanisms.3 = ANONYMOUS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>is used by default.</p>
<p>The server mechanisms are ordered in decreasing level of preference.
See the <a href="/rabbitmq-website/docs/4.0/configure#configuration-files">configuration file</a> documentation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="client-mechanism-configuration">Mechanism Configuration in the Client<a href="#client-mechanism-configuration" class="hash-link" aria-label="Direct link to Mechanism Configuration in the Client" title="Direct link to Mechanism Configuration in the Client">​</a></h3>
<p>Applications must opt-in to use a different authentication mechanism
such as <code>EXTERNAL</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="client-mechanism-configuration-java">Mechanism Configuration in Java<a href="#client-mechanism-configuration-java" class="hash-link" aria-label="Direct link to Mechanism Configuration in Java" title="Direct link to Mechanism Configuration in Java">​</a></h4>
<p>The Java client does not use
the <code>javax.security.sasl</code> package by default
since this can be unpredictable on non-Oracle JDKs and is
missing entirely on Android. There is a RabbitMQ-specific
SASL implementation, configured by
the <code>SaslConfig</code> interface. A
class <code>DefaultSaslConfig</code> is provided to make
SASL configuration more convenient in the common case. A
class <code>JDKSaslConfig</code> is provided to act as a
bridge to <code>javax.security.sasl</code>.</p>
<p><code>ConnectionFactory.getSaslConfig()</code>
and <code>ConnectionFactory.setSaslConfig(SaslConfig)</code>
are the primary methods for interacting with authentication mechanisms.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="client-mechanism-configuration-dotnet">Mechanism Configuration in .NET<a href="#client-mechanism-configuration-dotnet" class="hash-link" aria-label="Direct link to Mechanism Configuration in .NET" title="Direct link to Mechanism Configuration in .NET">​</a></h4>
<p>The .NET client provides its own SASL mechanism
implementations based on the <code>AuthMechanism</code>
and <code>AuthMechanismFactory</code>
interfaces. The <code>ConnectionFactory.AuthMechanisms</code>
property is a list of authentication mechanism factories in
preference order.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="client-mechanism-configuration-erlang">Mechanism Configuration in Erlang<a href="#client-mechanism-configuration-erlang" class="hash-link" aria-label="Direct link to Mechanism Configuration in Erlang" title="Direct link to Mechanism Configuration in Erlang">​</a></h4>
<p>The Erlang client provides its own SASL mechanism
implementations in the <code>amqp_auth_mechanisms</code>
module. The <code>#amqp_params</code> record can be
provided with a list of authentication functions in
preference order for network connections.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-authn">Troubleshooting Authentication<a href="#troubleshooting-authn" class="hash-link" aria-label="Direct link to Troubleshooting Authentication" title="Direct link to Troubleshooting Authentication">​</a></h2>
<p>This section covers several very common problems related to authentication.
For authorization (permission) errors, see <a href="#troubleshooting-authz">another section below</a>.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Inspecting <a href="/rabbitmq-website/docs/4.0/logging">server logs</a> is crucially important when investigating authentication-related
issues.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="incorrect-permissions">Incorrect Permissions<a href="#incorrect-permissions" class="hash-link" aria-label="Direct link to Incorrect Permissions" title="Direct link to Incorrect Permissions">​</a></h3>
<p>A failed authentication attempt, that is, when incorrect credentials were specified by the client,
will result in <a href="/rabbitmq-website/docs/4.0/logging">a server log message</a> that looks like this:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2019-03-25 12:28:19.047 [info] &lt;0.1613.0&gt; accepting AMQP connection &lt;0.1613.0&gt; (127.0.0.1:63839 -&gt; 127.0.0.1:5672)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2019-03-25 12:28:19.056 [error] &lt;0.1613.0&gt; Error on AMQP connection &lt;0.1613.0&gt; (127.0.0.1:63839 -&gt; 127.0.0.1:5672, state: starting):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PLAIN login refused: user &#x27;user2&#x27; - invalid credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2019-03-25 12:28:22.057 [info] &lt;0.1613.0&gt; closing AMQP connection &lt;0.1613.0&gt; (127.0.0.1:63839 -&gt; 127.0.0.1:5672)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Authentication failures on connections that <a href="#authentication">authenticate using X.509 certificates</a>
will be logged differently. See <a href="/rabbitmq-website/docs/4.0/troubleshooting-ssl">TLS Troubleshooting guide</a> for details.</p>
<p><a href="/rabbitmq-website/docs/4.0/cli">rabbitmqctl authenticate_user</a> can be used to test authentication
for a username and password pair:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl authenticate_user </span><span class="token string" style="color:#e3116c">&quot;a-username&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a/password&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># note that double quotes are required due to the &amp; character</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat authenticate_user </span><span class="token string" style="color:#e3116c">&#x27;a-username&#x27;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;a/p&amp;assword&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>If authentication succeeds, it will exit with the code of zero. In case of a failure,
a non-zero exit code will be used and a failure error message will be printed.</p>
<p><code>rabbitmqctl authenticate_user</code> will use a CLI-to-node communication connection to attempt to authenticate
the username/password pair against an internal API endpoint.
The connection is assumed to be trusted. If that&#x27;s not the case, its traffic can be <a href="/rabbitmq-website/docs/4.0/clustering-ssl">encrypted using TLS</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-users-connection-from-remote-hosts-are-refused">Default User&#x27;s Connection From Remote Hosts are Refused<a href="#default-users-connection-from-remote-hosts-are-refused" class="hash-link" aria-label="Direct link to Default User&#x27;s Connection From Remote Hosts are Refused" title="Direct link to Default User&#x27;s Connection From Remote Hosts are Refused">​</a></h3>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p><a href="#loopback-users">Default user cannot connect from remote hosts</a> for a reason. Enabling such
connections can dramatically decrease the security of the cluster. Consider creating
a <a href="#user-management">unique user with generated credentials</a> for all production clusters.</p></div></div>
<p>If credentials are reported as correct, connections from localhost succeed but remote connections
fail, the issue is <a href="#loopback-users">default user connectivity limitations</a>.</p>
<p>In this case, the error will look like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2024-08-24 17:28:32.153698-04:00 [error] &lt;0.1567.0&gt; PLAIN login refused: user &#x27;guest&#x27; can only connect via localhost</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A separate user with generated credentials must be <a href="#user-management">created</a> for clients (including <a href="/rabbitmq-website/docs/4.0/shovel">shovels</a>
and <a href="/rabbitmq-website/docs/4.0/federation">federation links</a>) connecting from remote hosts.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-failure-notifications-in-amqp-0-9-1">Authentication Failure Notifications in AMQP 0-9-1<a href="#authentication-failure-notifications-in-amqp-0-9-1" class="hash-link" aria-label="Direct link to Authentication Failure Notifications in AMQP 0-9-1" title="Direct link to Authentication Failure Notifications in AMQP 0-9-1">​</a></h3>
<p>Per AMQP 0-9-1 spec, authentication failures should result
in the server closing TCP connection immediately. However,
with RabbitMQ clients can opt in to receive a more specific
notification using the <a href="/rabbitmq-website/docs/4.0/auth-notification">authentication failure notification</a> extension to AMQP 0-9-1. Modern client libraries
support that extension transparently to the user: no configuration would be necessary and
authentication failures will result in a visible returned error, exception or other way of communicating
a problem used in a particular programming language or environment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-authz">Troubleshooting Authorisation<a href="#troubleshooting-authz" class="hash-link" aria-label="Direct link to Troubleshooting Authorisation" title="Direct link to Troubleshooting Authorisation">​</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Inspecting <a href="/rabbitmq-website/docs/4.0/logging">server logs</a> is crucially important when investigating authorization-related
issues.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="missing-permissions">Missing Permissions<a href="#missing-permissions" class="hash-link" aria-label="Direct link to Missing Permissions" title="Direct link to Missing Permissions">​</a></h3>
<p>The most common scenario with authorization failures is when a user was
created but not <a href="#grant-permissions">granted permissions</a> for the virtual host the client
tries to connect to.</p>
<p>In this case, the connection will be refused with a message that looks like this:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2019-03-25 12:26:16.301 [info] &lt;0.1594.0&gt; accepting AMQP connection &lt;0.1594.0&gt; (127.0.0.1:63793 -&gt; 127.0.0.1:5672)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2019-03-25 12:26:16.309 [error] &lt;0.1594.0&gt; Error on AMQP connection &lt;0.1594.0&gt; (127.0.0.1:63793 -&gt; 127.0.0.1:5672, user: &#x27;user2&#x27;, state: opening):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">access to vhost &#x27;/&#x27; refused for user &#x27;user2&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2019-03-25 12:26:16.310 [info] &lt;0.1594.0&gt; closing AMQP connection &lt;0.1594.0&gt; (127.0.0.1:63793 -&gt; 127.0.0.1:5672, vhost: &#x27;none&#x27;, user: &#x27;user2&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="insufficient-permissions">Insufficient Permissions<a href="#insufficient-permissions" class="hash-link" aria-label="Direct link to Insufficient Permissions" title="Direct link to Insufficient Permissions">​</a></h3>
<p>Another very common scenario is that the permissions are defined but they are
<a href="#authorisation">insufficient for the operations that the client tries to perform</a>.</p>
<p>In this case the connection will be accepted</p>
<p><a href="/rabbitmq-website/docs/4.0/cli">rabbitmqctl list_permissions</a> can be used to inspect a user&#x27;s
permission in a given virtual host:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl list_permissions </span><span class="token parameter variable" style="color:#36acaa">--vhost</span><span class="token plain"> /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Listing permissions for vhost &quot;/&quot; ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; user	configure	write	read</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; user2	.*	.*	.*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; guest	.*	.*	.*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; temp-user	.*	.*	.*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl list_permissions </span><span class="token parameter variable" style="color:#36acaa">--vhost</span><span class="token plain"> gw1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Listing permissions for vhost &quot;gw1&quot; ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; user	configure	write	read</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; guest	.*	.*	.*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; user2	^user2	^user2	^user2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat list_permissions </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">vhost </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat list_permissions </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">vhost gw1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>Authorisation failures (permission violations) are logged with the following messages:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2019-03-25 12:30:05.209 [error] &lt;0.1627.0&gt; Channel error on connection &lt;0.1618.0&gt; (127.0.0.1:63881 -&gt; 127.0.0.1:5672, vhost: &#x27;gw1&#x27;, user: &#x27;user2&#x27;), channel 1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">operation queue.declare caused a channel exception access_refused: access to queue &#x27;user3.q1&#x27; in vhost &#x27;gw1&#x27; refused for user &#x27;user2&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rabbitmq/rabbitmq-website/tree/main/versioned_docs/version-4.0/access-control.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rabbitmq-website/docs/4.0/vhosts"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Virtual Hosts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rabbitmq-website/docs/4.0/authentication"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AMQP 0-9-1 Authentication Mechanisms</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#terminology-and-definitions" class="table-of-contents__link toc-highlight">Terminology and Definitions</a></li><li><a href="#basics" class="table-of-contents__link toc-highlight">The Basics</a></li><li><a href="#default-state" class="table-of-contents__link toc-highlight">Default Virtual Host and User</a></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication: Who Do You Say You Are?</a><ul><li><a href="#certificate-authentication" class="table-of-contents__link toc-highlight">Authentication using Client TLS (x.509) Certificate Data</a></li></ul></li><li><a href="#loopback-users" class="table-of-contents__link toc-highlight">&quot;guest&quot; user can only connect from localhost</a></li><li><a href="#user-management" class="table-of-contents__link toc-highlight">Managing Users and Permissions</a><ul><li><a href="#passwords-and-shell-escaping" class="table-of-contents__link toc-highlight">Before We Start: Shell Escaping and Generated Passwords</a></li><li><a href="#adding-a-user" class="table-of-contents__link toc-highlight">Adding a User</a></li><li><a href="#listing-users" class="table-of-contents__link toc-highlight">Listing Users</a></li><li><a href="#deleting-a-user" class="table-of-contents__link toc-highlight">Deleting a User</a></li><li><a href="#grant-permissions" class="table-of-contents__link toc-highlight">Granting Permissions to a User</a></li><li><a href="#clearing-permissions-of-a-user-in-a-virtual-host" class="table-of-contents__link toc-highlight">Clearing Permissions of a User in a Virtual Host</a></li><li><a href="#operations-on-multiple-virtual-hosts" class="table-of-contents__link toc-highlight">Operations on Multiple Virtual Hosts</a></li></ul></li><li><a href="#seeding" class="table-of-contents__link toc-highlight">Seeding (Pre-creating) Users and Permissions</a><ul><li><a href="#cli-tools" class="table-of-contents__link toc-highlight">CLI Tools</a></li><li><a href="#definition-import-at-node-boot-time" class="table-of-contents__link toc-highlight">Definition Import at Node Boot Time</a></li><li><a href="#definition-import-after-node-boot" class="table-of-contents__link toc-highlight">Definition Import After Node Boot</a></li><li><a href="#override-default-user-credentials" class="table-of-contents__link toc-highlight">Override Default User Credentials</a></li></ul></li><li><a href="#authorisation" class="table-of-contents__link toc-highlight">Authorisation: How Permissions Work</a><ul><li><a href="#user-tags" class="table-of-contents__link toc-highlight">User Tags and Management UI Access</a></li></ul></li><li><a href="#topic-authorisation" class="table-of-contents__link toc-highlight">Topic Authorisation</a></li><li><a href="#revoke" class="table-of-contents__link toc-highlight">Revoking User Access and Credential Rotation</a><ul><li><a href="#revoking-user-access" class="table-of-contents__link toc-highlight">Revoking User Access</a></li><li><a href="#credential-rotation" class="table-of-contents__link toc-highlight">Credential Rotation</a></li></ul></li><li><a href="#backends" class="table-of-contents__link toc-highlight">Authentication and Authorisation Backends</a><ul><li><a href="#combined-backends" class="table-of-contents__link toc-highlight">Combining Backends</a></li></ul></li><li><a href="#mechanisms" class="table-of-contents__link toc-highlight">Authentication Mechanisms</a><ul><li><a href="#available-mechanisms" class="table-of-contents__link toc-highlight">Built-in Authentication Mechanisms</a></li><li><a href="#server-mechanism-configuration" class="table-of-contents__link toc-highlight">Mechanism Configuration in the Server</a></li><li><a href="#client-mechanism-configuration" class="table-of-contents__link toc-highlight">Mechanism Configuration in the Client</a></li></ul></li><li><a href="#troubleshooting-authn" class="table-of-contents__link toc-highlight">Troubleshooting Authentication</a><ul><li><a href="#incorrect-permissions" class="table-of-contents__link toc-highlight">Incorrect Permissions</a></li><li><a href="#default-users-connection-from-remote-hosts-are-refused" class="table-of-contents__link toc-highlight">Default User&#39;s Connection From Remote Hosts are Refused</a></li><li><a href="#authentication-failure-notifications-in-amqp-0-9-1" class="table-of-contents__link toc-highlight">Authentication Failure Notifications in AMQP 0-9-1</a></li></ul></li><li><a href="#troubleshooting-authz" class="table-of-contents__link toc-highlight">Troubleshooting Authorisation</a><ul><li><a href="#missing-permissions" class="table-of-contents__link toc-highlight">Missing Permissions</a></li><li><a href="#insufficient-permissions" class="table-of-contents__link toc-highlight">Insufficient Permissions</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn about RabbitMQ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Reach out to the RabbitMQ team</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rabbitmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/rabbitmq/rabbitmq-server/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact?utm_source=rmq_release-information_tableheader&amp;utm_medium=rmq_website&amp;utm_campaign=tanzu">Long Term Commercial Support</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact">Contact Us</a></li><li class="footer__item"><a href="https://www.rabbitmq.com/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Broadcom</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tanzu.vmware.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VMware Tanzu<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/legal.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/trademark-guidelines">Trademark Guidelines</a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy/california-privacy-rights.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Your California Privacy Rights<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item ot-sdk-show-settings">Cookie Settings</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2005-2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div>
</body>
</html>