<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-4.1 docs-doc-page docs-doc-id-memory-use/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Reasoning About Memory Use | RabbitMQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" name="twitter:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" property="og:url" content="https://www.rabbitmq.com/rabbitmq-website/docs/memory-use"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="4.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-4.1"><meta data-rh="true" name="docsearch:version" content="4.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-4.1"><meta data-rh="true" property="og:title" content="Reasoning About Memory Use | RabbitMQ"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/rabbitmq-website/img/rabbitmq-logo.svg"><link data-rh="true" rel="canonical" href="https://www.rabbitmq.com/rabbitmq-website/docs/memory-use"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/memory-use" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/memory-use" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://H10VQIW16Y-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rabbitmq-website/blog/rss.xml" title="RabbitMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rabbitmq-website/blog/atom.xml" title="RabbitMQ Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="RabbitMQ" href="/rabbitmq-website/opensearch.xml">







<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,700">
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-domain-script="018ee308-473e-754f-b0c2-cbe82d25512f"></script>
<script>function OptanonWrapper(){}</script>
<script>function setGTM(e,t,o,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=t.getElementsByTagName(o)[0],a=t.createElement(o),s="dataLayer"!=n?"&l="+n:"";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+r+s,i.parentNode.insertBefore(a,i)}var timer;function waitForOnetrustActiveGroups(){document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?(clearTimeout(timer),setGTM(window,document,"script","dataLayer","GTM-TT84L8K")):timer=setTimeout(waitForOnetrustActiveGroups,250)}document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?setGTM(window,document,"script","dataLayer","GTM-TT84L8K"):waitForOnetrustActiveGroups()</script><link rel="stylesheet" href="/rabbitmq-website/styles.css">
<script src="/rabbitmq-website/runtime~main.js" defer="defer"></script>
<script src="/rabbitmq-website/main.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:var(--ifm-color-primary-contrast-background);color:var(--ifm-font-color-base)" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong style="font-size: var(--ifm-h4-font-size);"><a href="https://github.com/rabbitmq/rabbitmq-server/releases/tag/v4.1.0">RabbitMQ 4.1.0 is out</a></strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rabbitmq-website/"><div class="navbar__logo"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/rabbitmq-website/tutorials">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rabbitmq-website/docs">Docs</a><a class="navbar__item navbar__link" href="/rabbitmq-website/blog">Blog</a><a class="navbar__item navbar__link" href="/rabbitmq-website/contact">Support</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/rabbitmq-website/docs/memory-use">4.1</a><ul class="dropdown__menu"><li class=""><strong>Release series</strong></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/next/memory-use">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/rabbitmq-website/docs/memory-use">4.1</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/4.0/memory-use">4.0</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/3.13/memory-use">3.13</a></li><li><a href="https://v3-12.rabbitmq.com/documentation.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/rabbitmq-website/release-information">Release Information</a></li></ul></div><a href="https://github.com/rabbitmq/rabbitmq-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/release-information">Release Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/download">Install and Upgrade</a><button aria-label="Expand sidebar category &#x27;Install and Upgrade&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/use-rabbitmq">How to Use RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Use RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/rabbitmq-website/docs/manage-rabbitmq">How to Manage RabbitMQ</a><button aria-label="Collapse sidebar category &#x27;How to Manage RabbitMQ&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/cli">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/configure">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/relocate">File and Directory Locations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/logging">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/vhosts">Virtual Hosts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/access-control"> Authentication and Authorization</a><button aria-label="Expand sidebar category &#x27; Authentication and Authorization&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/parameters">Policies and Runtime Parameters</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/metadata-store">Metadata store</a><button aria-label="Expand sidebar category &#x27;Metadata store&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/definitions">Schema Definitions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/networking">Networking</a><button aria-label="Expand sidebar category &#x27;Networking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/clustering">Clustering</a><button aria-label="Expand sidebar category &#x27;Clustering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/rabbitmq-website/docs/memory-use">Resource Management</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rabbitmq-website/docs/memory-use">Analyzing how Memory is Used</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/alarms">Memory and Disk Alarms</a><button aria-label="Expand sidebar category &#x27;Memory and Disk Alarms&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/flow-control">Flow Control</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/backup">Backup and Restore</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/rabbitmq-website/docs/runtime">Tuning</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/production-checklist">Deployment Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/kubernetes/operator/operator-overview">RabbitMQ on Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/troubleshooting">Troubleshooting RabbitMQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/monitoring">How to Monitor RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Monitor RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rabbitmq-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/rabbitmq-website/docs/manage-rabbitmq"><span itemprop="name">How to Manage RabbitMQ</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Resource Management</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Analyzing how Memory is Used</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Reasoning About Memory Footprint</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>Operators need to be able to reason about node&#x27;s memory use,
both absolute and relative (&quot;what uses most memory&quot;). This is an
important aspect of <a href="/rabbitmq-website/docs/monitoring">system monitoring</a>.</p>
<p>This guide focusses on reasoning about node&#x27;s reported (monitored) memory footprint.
It is accompanied by a few closely related guides:</p>
<ul>
<li><a href="/rabbitmq-website/docs/memory">Memory Alarm Threshold</a></li>
<li><a href="/rabbitmq-website/docs/alarms">Resource Alarms</a></li>
</ul>
<p>RabbitMQ provides tools that report and help analyse node memory use:</p>
<ul>
<li><a href="/rabbitmq-website/docs/cli"><code>rabbitmq-diagnostics memory_breakdown</code></a></li>
<li><a href="/rabbitmq-website/docs/cli"><code>rabbitmq-diagnostics status</code></a> includes the above breakdown as a section</li>
<li><a href="/rabbitmq-website/docs/prometheus">Prometheus and Grafana</a>-based monitoring makes it possible to observe memory breakdown over time</li>
<li><a href="/rabbitmq-website/docs/management">Management UI</a> provides the same breakdown on the node page as <code>rabbitmq-diagnostics status</code></li>
<li><a href="/rabbitmq-website/docs/management#http-api">HTTP API</a> provides the same information as the management UI, useful <a href="/rabbitmq-website/docs/monitoring">for monitoring</a></li>
<li><a href="https://github.com/rabbitmq/rabbitmq-server/tree/main/deps/rabbitmq_top" target="_blank" rel="noopener noreferrer">rabbitmq-top</a> and <code>rabbitmq-diagnostics observer</code> provide a more fine-grained <a href="https://en.wikipedia.org/wiki/Top_(software)" target="_blank" rel="noopener noreferrer">top</a>-like per Erlang process view</li>
</ul>
<p>Obtaining a node memory breakdown should be the first step when reasoning about node memory use.</p>
<p>Note that all measurements are somewhat approximate, based on values
returned by the underlying runtime or the kernel at a specific point in
time, usually within a 5 seconds time window.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="containers">Running RabbitMQ in Containers and on Kubernetes<a href="#containers" class="hash-link" aria-label="Direct link to Running RabbitMQ in Containers and on Kubernetes" title="Direct link to Running RabbitMQ in Containers and on Kubernetes">​</a></h2>
<p>When a RabbitMQ runs in an environment where cgroups are used, namely in various
containerized environments and on Kubernetes, certain aspects related to <a href="/rabbitmq-website/docs/memory#absolute-limit">memory limits</a>
and <a href="#page-cache">kernel page cache</a> must be taken into account,
in particular in clusters where streams and super streams are used.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown">Memory Use Breakdown<a href="#breakdown" class="hash-link" aria-label="Direct link to Memory Use Breakdown" title="Direct link to Memory Use Breakdown">​</a></h2>
<p>A RabbitMQ node can report its memory usage breakdown. The breakdown is provided
as a list of categories (shown below) and the memory footprint of that category.</p>
<p>Each category is a sum of runtime-reported memory footprint of every process or table
of that kind. This means that the connections category is the sum of memory used by
all connection processes, the channels category is the sum of memory used by all channel
processes, ETS tables is the sum of memory used of all in-memory tables on the node,
and so on.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-intro">How Memory Breakdown Works<a href="#breakdown-intro" class="hash-link" aria-label="Direct link to How Memory Breakdown Works" title="Direct link to How Memory Breakdown Works">​</a></h3>
<p>Memory use breakdown reports allocated memory distribution on the target node, by category:</p>
<ul>
<li><a href="#breakdown-connections">Connections</a> (further split into four categories: readers, writers, channels, other)</li>
<li><a href="/rabbitmq-website/docs/quorum-queues">Quorum queue</a> replicas</li>
<li><a href="/rabbitmq-website/docs/streams">Stream</a> replicas</li>
<li>Classic queue message store and indices</li>
<li><a href="#breakdown-binaries">Binary heap references</a></li>
<li>Node-local metrics (<a href="/rabbitmq-website/docs/management">management plugin</a> stats database)</li>
<li>Internal schema database tables</li>
<li><a href="/rabbitmq-website/docs/plugins">Plugins</a>, including protocols that transfer messages, such as <a href="/rabbitmq-website/docs/shovel">Shovel</a> and <a href="/rabbitmq-website/docs/federation">Federation</a>, and their internal queues</li>
<li>Memory <a href="/rabbitmq-website/docs/runtime#allocators">allocated but not yet used</a></li>
<li>Code (bytecode, module metadata)</li>
<li>ETS (in memory key/value store) tables</li>
<li><a href="/rabbitmq-website/docs/runtime">Atom tables</a></li>
<li>Other</li>
</ul>
<p>Generally there is no overlap between the categories (no double accounting for the same memory).
Plugins and runtime versions may affect this.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-cli">Producing Memory Use Breakdown Using CLI Tools<a href="#breakdown-cli" class="hash-link" aria-label="Direct link to Producing Memory Use Breakdown Using CLI Tools" title="Direct link to Producing Memory Use Breakdown Using CLI Tools">​</a></h3>
<p>A common way of producing memory breakdown is via <code>rabbitmq-diagnostics memory_breakdown</code>.</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">quorum_queue_procs: 0.4181 gb (28.8%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binary: 0.4129 gb (28.44%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">allocated_unused: 0.1959 gb (13.49%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection_other: 0.1894 gb (13.05%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plugins: 0.0373 gb (2.57%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">other_proc: 0.0325 gb (2.24%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">code: 0.0305 gb (2.1%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quorum_ets: 0.0303 gb (2.09%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection_readers: 0.0222 gb (1.53%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">other_system: 0.0209 gb (1.44%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection_channels: 0.017 gb (1.17%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mgmt_db: 0.017 gb (1.17%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metrics: 0.0109 gb (0.75%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">other_ets: 0.0073 gb (0.5%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection_writers: 0.007 gb (0.48%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">atom: 0.0015 gb (0.11%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mnesia: 0.0006 gb (0.04%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msg_index: 0.0002 gb (0.01%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">queue_procs: 0.0002 gb (0.01%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reserved_unallocated: 0.0 gb (0.0%)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><td>Report Field</td><td>Category</td><td>Details</td></thead><tr><td>total</td><td></td><td>Total amount as reported by the effective memory calculation strategy (see above)</td></tr><tr><td>connection_readers</td><td>Connections</td><td><p>Processes responsible for connection parser and most of connection state. Most of their memory attributes
to TCP buffers. The more client connections a node has, the more memory will be used by this category.
See <a href="./networking">Networking guide</a> for more information.</p></td></tr><tr><td>connection_writers</td><td>Connections</td><td><p>Processes responsible for serialisation of outgoing protocol frames and writing to client connection sockets.
The more client connections a node has, the more memory will be used by this category.
See <a href="./networking">Networking guide</a> for more information.</p></td></tr><tr><td>connection_channels</td><td>Channels</td><td>The more channels client connections use, the more memory will be used by this category.</td></tr><tr><td>connection_other</td><td>Connections</td><td>Other memory related to client connections</td></tr><tr><td>quorum_queue_procs</td><td>Queues</td><td><p><a href="./quorum-queues">Quorum queue</a> processes, both currently elected leaders and followers.
Memory footprint can be capped on a per-queue basis.
See the <a href="./quorum-queues">Quorum Queues</a> guide for more information.</p></td></tr><tr><td>queue_procs</td><td>Queues</td><td><p>Classic queue leaders, indices and messages kept in memory. The greater the number of messages enqueued,
the more memory will generally be attributed to this section. However, this greatly depends on
queue type and properties.
See <a href="./memory">Memory</a>, <a href="./classic-queues">Classic Queues</a> for more information.</p></td></tr><tr><td>metrics</td><td><a href="./management">Stats DB</a></td><td><p>Node-local metrics. The more connections, channels, queues are node hosts, the more stats there are to collect and keep.
See <a href="./management">management plugin guide</a> for more information.</p></td></tr><tr><td>stats_db</td><td>Stats DB</td><td><p>Aggregated and pre-computed metrics, inter-node HTTP API request cache and everything else related to the stats DB.
See <a href="./management">management plugin guide</a> for more information.</p></td></tr><tr><td>binaries</td><td>Binaries</td><td>Runtime binary heap. Most of this section is usually message bodies and properties (metadata).</td></tr><tr><td>plugins</td><td>Plugins</td><td><p>Plugins such as <a href="./shovel">Shovel</a>, <a href="./federation">Federation</a>, or protocol implementations such as <a href="./stomp">STOMP</a>
can accumulate messages in memory.</p></td></tr><tr><td>allocated_unused</td><td>Preallocated Memory</td><td>Allocated by the runtime but not yet used.</td></tr><tr><td>reserved_unallocated</td><td>Preallocated Memory</td><td>Allocated/reserved by the kernel but not the runtime</td></tr><tr><td>mnesia</td><td>Internal Database</td><td>Virtual hosts, users, permissions, queue metadata and state, exchanges, bindings, runtime parameters and so on.</td></tr><tr><td>quorum_ets</td><td>Internal Database</td><td>Raft implementation&#x27;s WAL and other memory tables. Most of these are periodically moved to disk.</td></tr><tr><td>other_ets</td><td>Internal Database</td><td>Some plugins can use ETS tables to store their state</td></tr><tr><td>code</td><td>Code</td><td><p>Bytecode and module metadata. This should only consume double digit % of
memory on blank/empty nodes.</p></td></tr><tr><td>other</td><td>Other</td><td><p>All other processes that RabbitMQ cannot categorise</p></td></tr></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-management-ui">Producing Memory Use Breakdown Using Management UI<a href="#breakdown-management-ui" class="hash-link" aria-label="Direct link to Producing Memory Use Breakdown Using Management UI" title="Direct link to Producing Memory Use Breakdown Using Management UI">​</a></h2>
<p>Management UI can be used to produce a memory breakdown chart. This information is available on the
node metrics page that can be accessed from Overview:</p>
<figure><p><img decoding="async" loading="lazy" alt="Cluster node list in management UI" src="/rabbitmq-website/assets/images/mgmt-ui-node-list-b08bb58e56514c82731d7a10cc28f588.png" width="1061" height="112" class="img_ev3q"></p></figure>
<p>On the node metrics page, scroll down to the memory breakdown buttons:</p>
<figure><p><img decoding="async" loading="lazy" alt="Node memory use breakdown buttons" src="/rabbitmq-website/assets/images/mgmt-ui-memory-use-breakdown-buttons-b16c49b9851c61e5f687ba78c9abf0d4.png" width="650" height="198" class="img_ev3q"></p></figure>
<p>Memory and binary heap breakdowns can be expensive to calculate and are produced on demand when the <code>Update</code> button is pressed:</p>
<figure><p><img decoding="async" loading="lazy" alt="Node memory use breakdown chart" src="/rabbitmq-website/assets/images/mgmt-ui-memory-use-breakdown-ff91d5cba04f72d7188e4130b97f35d2.png" width="1886" height="772" class="img_ev3q"></p></figure>
<p>It is also possible to display a breakdown of binary heap use by various
things in the system (e.g. connections, queues):</p>
<figure><p><img decoding="async" loading="lazy" alt="Binary heap use breakdown chart" src="/rabbitmq-website/assets/images/mgmt-ui-binaries-breakdown-31d40db18f25ac1965a933c82e751c79.png" width="1882" height="522" class="img_ev3q"></p></figure>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-http-api-curl">Producing Memory Use Breakdown Using HTTP API and curl<a href="#breakdown-http-api-curl" class="hash-link" aria-label="Direct link to Producing Memory Use Breakdown Using HTTP API and curl" title="Direct link to Producing Memory Use Breakdown Using HTTP API and curl">​</a></h2>
<p>It is possible to produce memory use breakdown over <a href="/rabbitmq-website/docs/management">HTTP API</a>
by issuing a <code>GET</code> request to the <code>/api/nodes/{node}/memory</code> endpoint.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -u guest</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">guest http</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//127.0.0.1:15672/api/nodes/rabbit@mercurio/memory | python -m json.tool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;memory&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;atom&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1041593</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;binary&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5133776</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25299059</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_channels&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1823320</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_other&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">150168</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_readers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">83760</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_writers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">113112</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;metrics&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">217816</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;mgmt_db&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">266560</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;mnesia&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93344</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;msg_index&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48880</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;other_ets&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2294184</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;other_proc&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27131728</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;other_system&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21496756</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;plugins&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3103424</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;queue_procs&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2957624</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;total&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">89870336</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It is also possible to retrieve a relative breakdown using the
<code>GET</code> request to the <code>/api/nodes/{node}/memory</code> endpoint.
Note that reported relative values are rounded to integers. This endpoint is
intended to be used for relative comparison (identifying top contributing categories),
not precise calculations.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -u guest</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">guest http</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//127.0.0.1:15672/api/nodes/rabbit@mercurio/memory/relative | python -m json.tool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;memory&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;allocated_unused&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;atom&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;binary&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_channels&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_other&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_readers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;connection_writers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;metrics&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;mgmt_db&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;mnesia&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;msg_index&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;other_ets&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;other_proc&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;other_system&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;plugins&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;queue_procs&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;reserved_unallocated&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;total&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-categories">Memory Breakdown Categories<a href="#breakdown-categories" class="hash-link" aria-label="Direct link to Memory Breakdown Categories" title="Direct link to Memory Breakdown Categories">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-connections">Connections<a href="#breakdown-connections" class="hash-link" aria-label="Direct link to Connections" title="Direct link to Connections">​</a></h3>
<p>This includes memory used by client connections (including <a href="/rabbitmq-website/docs/shovel">Shovels</a> and <a href="/rabbitmq-website/docs/federation">Federation links</a>)
and channels, and outgoing ones (Shovels and Federation upstream links). Most of the memory
is usually used by TCP buffers, which on Linux autotune to about 100 kB in size by default.
TCP buffer size can be reduced at the cost of a proportional decrease in connection throughput.
See the <a href="/rabbitmq-website/docs/networking">Networking guide</a> for details.</p>
<p>Channels also consume RAM. By optimising how many channels applications use, that amount
can be decreased. It is possible to cap the max number of channels on a connection using
the <code>channel_max</code> configuration setting:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">channel_max = 16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that some libraries and tools that build on top of RabbitMQ clients may implicitly require
a certain number of channels. Finding an optimal value is usually a matter of trial and error.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-queues">Queues and Messages<a href="#breakdown-queues" class="hash-link" aria-label="Direct link to Queues and Messages" title="Direct link to Queues and Messages">​</a></h3>
<p>Memory used by queues, queue indices, queue state. Messages enqueued will
in part contribute to this category.</p>
<p>Queues will <a href="/rabbitmq-website/docs/memory">swap their contents out to disc when under memory pressure</a>.
The exact behavior of this depends on <a href="/rabbitmq-website/docs/queues">queue properties</a>,
whether clients publish messages as persistent or transient, and <a href="/rabbitmq-website/docs/persistence-conf">persistence configuration</a> of the node.</p>
<p>Message bodies do not show up here but in Binaries.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-message-store-indexes">Message Store Indexes<a href="#breakdown-message-store-indexes" class="hash-link" aria-label="Direct link to Message Store Indexes" title="Direct link to Message Store Indexes">​</a></h3>
<p>By default message store uses an in-memory
index of all messages, including those paged out to disc.
Plugins allow for replacing it with disk-based implementations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-plugins">Plugins<a href="#breakdown-plugins" class="hash-link" aria-label="Direct link to Plugins" title="Direct link to Plugins">​</a></h3>
<p>Memory used by plugins (apart from the Erlang client which
is counted under Connections, and the management database
which is counted separately). This category will include
some per-connection memory here for protocol plugins such as
STOMP and MQTT as well as messages enqueued by plugins such
as Shovel and Federation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-preallocated-memory">Preallocated Memory<a href="#breakdown-preallocated-memory" class="hash-link" aria-label="Direct link to Preallocated Memory" title="Direct link to Preallocated Memory">​</a></h3>
<p>Memory preallocated by the runtime (VM allocators) but not yet
used. This is covered in more detail below.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-internal-database">Internal Database<a href="#breakdown-internal-database" class="hash-link" aria-label="Direct link to Internal Database" title="Direct link to Internal Database">​</a></h3>
<p>Internal database (Mnesia) tables keep an in-memory copy of all its data (even on disc
nodes). Typically this will only be large when there are a
large number of queues, exchanges, bindings, users or
virtual hosts. Plugins can store data in the same database as well.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-management-stats-db">Management (Stats) Database<a href="#breakdown-management-stats-db" class="hash-link" aria-label="Direct link to Management (Stats) Database" title="Direct link to Management (Stats) Database">​</a></h3>
<p>The stats database (if the management plugin is enabled). In
a cluster, most stats are stored locally on the
node. Cross-node requests needed to aggregate stats in a
cluster can be cached. The cached data will be reported in
this category.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-binaries">Binaries<a href="#breakdown-binaries" class="hash-link" aria-label="Direct link to Binaries" title="Direct link to Binaries">​</a></h3>
<p>Memory used by shared binary data in the runtime. Most of this
memory is message bodies and metadata.</p>
<p>With some workloads binary data heap can be garbage collected infrequently.
<code>rabbitmqctl force_gc</code> can be used force collection. The following
couple of commands forces collection and reports top processes that released most
binary heap references:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl </span><span class="token builtin class-name">eval</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;recon:bin_leak(10).&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl force_gc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With RabbitMQ versions that do not provide <code>rabbitmqctl force_gc</code>, use</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl </span><span class="token builtin class-name">eval</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;recon:bin_leak(10).&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl </span><span class="token builtin class-name">eval</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;[garbage_collect(P) || P &lt;- processes()].&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-ets-tables">Other ETS tables<a href="#breakdown-ets-tables" class="hash-link" aria-label="Direct link to Other ETS tables" title="Direct link to Other ETS tables">​</a></h3>
<p>Other in-memory tables besides those belonging to the stats database
and internal database tables.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-code">Code<a href="#breakdown-code" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h3>
<p>Memory used by code (bytecode, module metadata). This
section is usually fairly constant and relatively small
(unless the node is entirely blank and stores no data).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-atoms">Atoms<a href="#breakdown-atoms" class="hash-link" aria-label="Direct link to Atoms" title="Direct link to Atoms">​</a></h3>
<p>Memory used by atoms. Should be fairly constant.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breakdown-top">Per-process Analysis with rabbitmq-top<a href="#breakdown-top" class="hash-link" aria-label="Direct link to Per-process Analysis with rabbitmq-top" title="Direct link to Per-process Analysis with rabbitmq-top">​</a></h3>
<p><a href="https://github.com/rabbitmq/rabbitmq-server/tree/main/deps/rabbitmq_top" target="_blank" rel="noopener noreferrer">rabbitmq-top</a> is a plugin that helps
identify runtime processes (&quot;lightweight threads&quot;) that consume most memory or scheduler (CPU)
time.</p>
<p>The plugin ships with RabbitMQ. Enable it with</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sudo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> rabbitmq-plugins </span><span class="token builtin class-name">enable</span><span class="token plain"> rabbitmq_top</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The plugin adds new administrative tabs to the <a href="/rabbitmq-website/docs/management">management UI</a>. One
tab displays top processes by one of the metrics:</p>
<ul>
<li>Memory used</li>
<li>Reductions (unit of scheduler/CPU consumption)</li>
<li>Erlang mailbox length</li>
<li>For <code>gen_server2</code> processes, internal operation buffer length</li>
</ul>
<figure><p><img decoding="async" loading="lazy" alt="Top processes in rabbitmq-top" src="/rabbitmq-website/assets/images/rabbitmq-top-processes-aec14cd31ebaec3eba751f76293689da.png" width="1169" height="698" class="img_ev3q"></p></figure>
<p>Second tab displays ETS (internal key/value store) tables. The tables can be sorted by
the amount of memory used or number of rows:</p>
<figure><p><img decoding="async" loading="lazy" alt="Top ETS tables in rabbitmq-top" src="/rabbitmq-website/assets/images/rabbitmq-top-ets-tables-32090274f28447deff78ca154d4cf940.jpg" width="1165" height="682" class="img_ev3q"></p></figure>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preallocated-memory">Preallocated Memory<a href="#preallocated-memory" class="hash-link" aria-label="Direct link to Preallocated Memory" title="Direct link to Preallocated Memory">​</a></h2>
<p>Erlang memory breakdown reports only memory is currently being used, and not
the memory that has been allocated for later use or reserved by the operating system.
OS tools like <code>ps</code> can report more memory used than the runtime.</p>
<p>This memory consists of allocated but not used,
as well as unallocated but reserved by the OS. Both values depend on the OS and Erlang VM allocator
settings and can fluctuate significantly.</p>
<p>How the value in both sections is computed depend on the <code>vm_memory_calculation_strategy</code> setting.
If the strategy is set to <code>erlang</code>, unused
memory will not be reported.
If memory calculation strategy is set to <code>allocated</code>, memory
reserved by OS will not be reported. Therefore <code>rss</code> is the strategy
that provides most information from both the kernel and the runtime.</p>
<p>When a node reports a large amount of allocated but unused memory on a long running node, it may be
an indicator of runtime memory fragmentation. A different set of allocator settings can reduce fragmentation
and increase the percentage of efficiently used memory. The right set of settings depends on
the workload and message payload size distribution.</p>
<p>Runtime&#x27;s memory allocator behavior can be tuned, please refer to the <a href="/rabbitmq-website/docs/runtime#allocators">Runtime guide</a>,
<a href="http://erlang.org/doc/man/erl.html" target="_blank" rel="noopener noreferrer">erl</a> and
<a href="http://erlang.org/doc/man/erts_alloc.html" target="_blank" rel="noopener noreferrer">erts_alloc</a>
documentation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="page-cache">Kernel Page Cache<a href="#page-cache" class="hash-link" aria-label="Direct link to Kernel Page Cache" title="Direct link to Kernel Page Cache">​</a></h2>
<p>Besides the memory allocated and used directly by a RabbitMQ node, files read by that node
can be cached by the operating system. This cache improves I/O operation efficiency and is
evicted (cleared) when the OS detects that a high percentage of available memory is in used.</p>
<p>Workloads that use <a href="/rabbitmq-website/docs/streams">RabbitMQ streams</a> often lead to large kernel page cache size,
in particular when consumers access messages that span days or weeks.</p>
<p>Some monitoring tools do not include the size of page cache into process monitoring metrics. Others
add it to the residential set size (RSS)
footprint of the process. This can lead to confusion: the <strong>page cache is not maintained or controlled
by RabbitMQ nodes. It is maintained, controlled and evicted (cleared) by the operating system kernel</strong>.</p>
<p>This is particularly <a href="https://github.com/kubernetes/kubernetes/issues/43916" target="_blank" rel="noopener noreferrer">common in Kubernetes-based</a> deployments
<a href="https://kubernetes.io/blog/2022/08/31/cgroupv2-ga-1-25/" target="_blank" rel="noopener noreferrer">that do not use cgroup v2</a>) and run RabbitMQ
using container images based on <a href="https://kubernetes.io/blog/2022/08/31/cgroupv2-ga-1-25/#how-do-you-use-cgroup-v2" target="_blank" rel="noopener noreferrer">older distributions</a> that use cgroups v1.</p>
<p>Kubernetes 1.25.0 and the following distributions are highly recommended as they
use a more reasonable approach to kernel page cache memory accounting:</p>
<ul>
<li>CentOS Stream 9 or later</li>
<li>Fedora 31 or later</li>
<li>Ubuntu 21.10 or later</li>
<li>Debian 11 Bullseye or later</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-a-large-page-cache-size-tell-us-about-a-workload">What Does a Large Page Cache Size Tell Us About a Workload?<a href="#what-does-a-large-page-cache-size-tell-us-about-a-workload" class="hash-link" aria-label="Direct link to What Does a Large Page Cache Size Tell Us About a Workload?" title="Direct link to What Does a Large Page Cache Size Tell Us About a Workload?">​</a></h3>
<p>Usually a large page cache size simply indicates that the workload is I/O heavy and likely uses streams
with large data sets. It does not indicate a memory leak by the node: the cache will be cleared
by the kernel when it detects that the system runs low on available memory.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-page-cache-without-containerization-in-virtual-or-physical-machines">Inspecting Page Cache without Containerization (in Virtual or Physical Machines)<a href="#inspecting-page-cache-without-containerization-in-virtual-or-physical-machines" class="hash-link" aria-label="Direct link to Inspecting Page Cache without Containerization (in Virtual or Physical Machines)" title="Direct link to Inspecting Page Cache without Containerization (in Virtual or Physical Machines)">​</a></h3>
<p>In non-containerized environments (e.g. RabbitMQ nodes run in virtual machines or on bare metal hardware),
use</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /proc/meminfo </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-we</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Cached&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>to inspect the size of the kernel page cache.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-page-cache-size-in-containerized-environments">Inspecting Page Cache Size in Containerized Environments<a href="#inspecting-page-cache-size-in-containerized-environments" class="hash-link" aria-label="Direct link to Inspecting Page Cache Size in Containerized Environments" title="Direct link to Inspecting Page Cache Size in Containerized Environments">​</a></h3>
<p>In containerized environments such as Kubernetes, the following two <code>/sys</code> pseudo filesystem
paths can be used to inspect both RSS and page cache footprint:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /sys/fs/cgroup/memory/memory.stat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /sys/fs/cgroup/memory/memory.usage_in_bytes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The two key metrics are named <code>rss</code> (for resident set size) and <code>cache</code> (for page cache).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="memory-breakdown-and-monitoring">Memory Use Monitoring<a href="#memory-breakdown-and-monitoring" class="hash-link" aria-label="Direct link to Memory Use Monitoring" title="Direct link to Memory Use Monitoring">​</a></h2>
<p>It is recommended that production systems monitor memory usage of all cluster nodes,
ideally with a breakdown, together with <a href="/rabbitmq-website/docs/monitoring">infrastructure-level metrics</a>.
By correlating breakdown categories with other metrics, e.g. the number of concurrent
connections or enqueued messages, it becomes possible to detect problems that
stem from an application-specific behavior (e.g. connection leaks or ever growing queues without consumers).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="queue-memory">Queue Memory<a href="#queue-memory" class="hash-link" aria-label="Direct link to Queue Memory" title="Direct link to Queue Memory">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="message-memory-usage">How much memory does a message use?<a href="#message-memory-usage" class="hash-link" aria-label="Direct link to How much memory does a message use?" title="Direct link to How much memory does a message use?">​</a></h3>
<p>A message has multiple parts that use up memory:</p>
<ul>
<li>Payload: &gt;= 1 byte, variable size, typically few hundred bytes to a few hundred kilobytes</li>
<li>Protocol attributes: &gt;= 0 bytes, variable size, contains headers, priority, timestamp, reply to, etc.</li>
<li>RabbitMQ metadata: &gt;= 720 bytes, variable size, contains exchange, routing keys, message properties, persistence, redelivery status, etc.</li>
<li>RabbitMQ message ordering structure: 16 bytes</li>
</ul>
<p>Messages with a 1KB payload will use up 2KB of memory once attributes and metadata is factored in.</p>
<p>Some messages can be stored on disk, but still have their metadata kept in memory.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="queue-memory-usage">How much memory does a queue use?<a href="#queue-memory-usage" class="hash-link" aria-label="Direct link to How much memory does a queue use?" title="Direct link to How much memory does a queue use?">​</a></h3>
<p>A message has multiple parts that use up memory. Every queue is backed by an Erlang process.
If a queue is replicated, each replica is a separate Erlang process running on separate cluster nodes.</p>
<p>Since every replica of a queue, whether leader or follower, is a single Erlang process, message ordering can be guaranteed.
Multiple queues means multiple Erlang processes which get an even amount of CPU time.
This ensures that no queue can block other queues.</p>
<p>The memory use of a single queue can be obtained via the HTTP API:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -u guest</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">guest http</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//127.0.0.1:15672/api/queues/%2f/queue-name |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  python -m json.tool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;memory&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97921904</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;message_bytes_ram&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2153429941</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>memory</code>: memory used by the queue process, accounts for message metadata (at least 720 bytes per message), does not account for message payloads over 64 bytes</li>
<li><code>message_bytes_ram</code>: memory used by the message payloads, regardless of the size</li>
</ul>
<p>If messages are small, message metadata can use more memory than the message payload.
10,000 messages with 1 byte of payload will use 10KB of <code>message_bytes_ram</code> (payload) and 7MB of <code>memory</code> (metadata).</p>
<p>If message payloads are large, they will not be reflected in the queue process memory.
10,000 messages with 100 KB of payload will use 976MB of <code>message_bytes_ram</code> (payload) and 7MB of <code>memory</code> (metadata).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="queue-memory-usage-dynamics">Why does the queue memory grow and shrink when publishing/consuming?<a href="#queue-memory-usage-dynamics" class="hash-link" aria-label="Direct link to Why does the queue memory grow and shrink when publishing/consuming?" title="Direct link to Why does the queue memory grow and shrink when publishing/consuming?">​</a></h3>
<p>Erlang uses <a href="https://www.erlang-solutions.com/blog/erlang-garbage-collector/" target="_blank" rel="noopener noreferrer">generational garbage collection</a> for each Erlang process.
Garbage collection is done per queue, independently of all other Erlang processes.</p>
<p>When garbage collection runs, it will copy used process memory before deallocating unused memory.
This can lead to the queue process using up to twice as much memory during garbage collection, as shown here (queue contains a lot of messages):</p>
<figure><p><img decoding="async" loading="lazy" alt="Queue under load memory usage" src="/rabbitmq-website/assets/images/queue-memory-usage-spikes-6a3ddad305ee118dee9e9ddaa149c8da.png" width="2216" height="486" class="img_ev3q"></p></figure>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="queue-memory-usage-gc">Is queue memory growth during garbage collection a concern?<a href="#queue-memory-usage-gc" class="hash-link" aria-label="Direct link to Is queue memory growth during garbage collection a concern?" title="Direct link to Is queue memory growth during garbage collection a concern?">​</a></h3>
<p>If Erlang VM tries to allocate more memory than is available, the VM itself will either crash or be killed by the OOM killer.
When the Erlang VM crashes, RabbitMQ will lose all non-persistent data.</p>
<p>Garbage collection can briefly double the memory used by a queue. However, given that:</p>
<ul>
<li>the garbage collection process is performed on different queues at different times</li>
<li>and given that in modern RabbitMQ versions, all types of queues (classic, quorum, streams)
either don&#x27;t store messages in memory at all or store only a limited amount of messages in memory</li>
</ul>
<p>a significant spike in overall RabbitMQ node memory usage caused by the garbage collection process is very unlikely.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="strategies">Total Memory Use Calculation Strategies<a href="#strategies" class="hash-link" aria-label="Direct link to Total Memory Use Calculation Strategies" title="Direct link to Total Memory Use Calculation Strategies">​</a></h2>
<p>RabbitMQ can use different strategies to compute how much memory a node uses.
Historically, nodes obtained this information from the runtime, reporting how much
memory is used (not just allocated). This strategy, known as <code>legacy</code> (alias for <code>erlang</code>) tends to
underreport and is not recommended.</p>
<p>Effective strategy is configured using the <code>vm_memory_calculation_strategy</code> key.
There are two primary options:</p>
<ul>
<li>
<p><code>rss</code> uses OS-specific means of querying the kernel to find
RSS (Resident Set Size) value of the node OS process. This strategy is most precise
and used by default on Linux, MacOS, BSD and Solaris systems. When
this strategy is used, RabbitMQ runs short lived subprocesses once a second.</p>
</li>
<li>
<p><code>allocated</code> is a strategy that queries runtime memory allocator
information. It is usually quite close to the values reported by the <code>rss</code>
strategy. This strategy is used by default on Windows.</p>
</li>
</ul>
<p>The <code>vm_memory_calculation_strategy</code> setting also impacts
memory breakdown reporting. If set to <code>legacy</code> (<code>erlang</code>) or <code>allocated</code>,
some memory breakdown fields will not be reported. This is covered in more detail
further in this guide.</p>
<p>The following configuration example uses the <code>rss</code> strategy:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vm_memory_calculation_strategy = rss</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Similarly, for the <code>allocated</code> strategy, use:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vm_memory_calculation_strategy = allocated</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To find out what strategy a node uses, see its <a href="/rabbitmq-website/docs/configure">effective configuration</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rabbitmq/rabbitmq-website/tree/main/versioned_docs/version-4.1/memory-use/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rabbitmq-website/docs/ec2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RabbitMQ on Amazon EC2</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rabbitmq-website/docs/alarms"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Memory and Disk Alarms</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#containers" class="table-of-contents__link toc-highlight">Running RabbitMQ in Containers and on Kubernetes</a></li><li><a href="#breakdown" class="table-of-contents__link toc-highlight">Memory Use Breakdown</a><ul><li><a href="#breakdown-intro" class="table-of-contents__link toc-highlight">How Memory Breakdown Works</a></li><li><a href="#breakdown-cli" class="table-of-contents__link toc-highlight">Producing Memory Use Breakdown Using CLI Tools</a></li></ul></li><li><a href="#breakdown-management-ui" class="table-of-contents__link toc-highlight">Producing Memory Use Breakdown Using Management UI</a></li><li><a href="#breakdown-http-api-curl" class="table-of-contents__link toc-highlight">Producing Memory Use Breakdown Using HTTP API and curl</a></li><li><a href="#breakdown-categories" class="table-of-contents__link toc-highlight">Memory Breakdown Categories</a><ul><li><a href="#breakdown-connections" class="table-of-contents__link toc-highlight">Connections</a></li><li><a href="#breakdown-queues" class="table-of-contents__link toc-highlight">Queues and Messages</a></li><li><a href="#breakdown-message-store-indexes" class="table-of-contents__link toc-highlight">Message Store Indexes</a></li><li><a href="#breakdown-plugins" class="table-of-contents__link toc-highlight">Plugins</a></li><li><a href="#breakdown-preallocated-memory" class="table-of-contents__link toc-highlight">Preallocated Memory</a></li><li><a href="#breakdown-internal-database" class="table-of-contents__link toc-highlight">Internal Database</a></li><li><a href="#breakdown-management-stats-db" class="table-of-contents__link toc-highlight">Management (Stats) Database</a></li><li><a href="#breakdown-binaries" class="table-of-contents__link toc-highlight">Binaries</a></li><li><a href="#breakdown-ets-tables" class="table-of-contents__link toc-highlight">Other ETS tables</a></li><li><a href="#breakdown-code" class="table-of-contents__link toc-highlight">Code</a></li><li><a href="#breakdown-atoms" class="table-of-contents__link toc-highlight">Atoms</a></li><li><a href="#breakdown-top" class="table-of-contents__link toc-highlight">Per-process Analysis with rabbitmq-top</a></li></ul></li><li><a href="#preallocated-memory" class="table-of-contents__link toc-highlight">Preallocated Memory</a></li><li><a href="#page-cache" class="table-of-contents__link toc-highlight">Kernel Page Cache</a><ul><li><a href="#what-does-a-large-page-cache-size-tell-us-about-a-workload" class="table-of-contents__link toc-highlight">What Does a Large Page Cache Size Tell Us About a Workload?</a></li><li><a href="#inspecting-page-cache-without-containerization-in-virtual-or-physical-machines" class="table-of-contents__link toc-highlight">Inspecting Page Cache without Containerization (in Virtual or Physical Machines)</a></li><li><a href="#inspecting-page-cache-size-in-containerized-environments" class="table-of-contents__link toc-highlight">Inspecting Page Cache Size in Containerized Environments</a></li></ul></li><li><a href="#memory-breakdown-and-monitoring" class="table-of-contents__link toc-highlight">Memory Use Monitoring</a></li><li><a href="#queue-memory" class="table-of-contents__link toc-highlight">Queue Memory</a><ul><li><a href="#message-memory-usage" class="table-of-contents__link toc-highlight">How much memory does a message use?</a></li><li><a href="#queue-memory-usage" class="table-of-contents__link toc-highlight">How much memory does a queue use?</a></li><li><a href="#queue-memory-usage-dynamics" class="table-of-contents__link toc-highlight">Why does the queue memory grow and shrink when publishing/consuming?</a></li><li><a href="#queue-memory-usage-gc" class="table-of-contents__link toc-highlight">Is queue memory growth during garbage collection a concern?</a></li></ul></li><li><a href="#strategies" class="table-of-contents__link toc-highlight">Total Memory Use Calculation Strategies</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn about RabbitMQ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Reach out to the RabbitMQ team</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rabbitmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/rabbitmq/rabbitmq-server/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact?utm_source=rmq_release-information_tableheader&amp;utm_medium=rmq_website&amp;utm_campaign=tanzu">Long Term Commercial Support</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact">Contact Us</a></li><li class="footer__item"><a href="https://www.rabbitmq.com/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Broadcom</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tanzu.vmware.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VMware Tanzu<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/legal.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/trademark-guidelines">Trademark Guidelines</a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy/california-privacy-rights.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Your California Privacy Rights<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item ot-sdk-show-settings">Cookie Settings</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2005-2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div>
</body>
</html>