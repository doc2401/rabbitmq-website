<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-3.13 docs-doc-page docs-doc-id-troubleshooting-oauth2" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Troubleshooting OAuth 2 | RabbitMQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" name="twitter:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" property="og:url" content="https://www.rabbitmq.com/rabbitmq-website/docs/3.13/troubleshooting-oauth2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="3.13"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.13"><meta data-rh="true" name="docsearch:version" content="3.13"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.13"><meta data-rh="true" property="og:title" content="Troubleshooting OAuth 2 | RabbitMQ"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/rabbitmq-website/img/rabbitmq-logo.svg"><link data-rh="true" rel="canonical" href="https://www.rabbitmq.com/rabbitmq-website/docs/3.13/troubleshooting-oauth2"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/3.13/troubleshooting-oauth2" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/3.13/troubleshooting-oauth2" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://H10VQIW16Y-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rabbitmq-website/blog/rss.xml" title="RabbitMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rabbitmq-website/blog/atom.xml" title="RabbitMQ Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="RabbitMQ" href="/rabbitmq-website/opensearch.xml">







<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,700">
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-domain-script="018ee308-473e-754f-b0c2-cbe82d25512f"></script>
<script>function OptanonWrapper(){}</script>
<script>function setGTM(e,t,o,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=t.getElementsByTagName(o)[0],a=t.createElement(o),s="dataLayer"!=n?"&l="+n:"";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+r+s,i.parentNode.insertBefore(a,i)}var timer;function waitForOnetrustActiveGroups(){document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?(clearTimeout(timer),setGTM(window,document,"script","dataLayer","GTM-TT84L8K")):timer=setTimeout(waitForOnetrustActiveGroups,250)}document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?setGTM(window,document,"script","dataLayer","GTM-TT84L8K"):waitForOnetrustActiveGroups()</script><link rel="stylesheet" href="/rabbitmq-website/styles.css">
<script src="/rabbitmq-website/runtime~main.js" defer="defer"></script>
<script src="/rabbitmq-website/main.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:var(--ifm-color-primary-contrast-background);color:var(--ifm-font-color-base)" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong style="font-size: var(--ifm-h4-font-size);"><a href="https://github.com/rabbitmq/rabbitmq-server/releases/tag/v4.1.0">RabbitMQ 4.1.0 is out</a></strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rabbitmq-website/"><div class="navbar__logo"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/rabbitmq-website/tutorials">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rabbitmq-website/docs/3.13">Docs</a><a class="navbar__item navbar__link" href="/rabbitmq-website/blog">Blog</a><a class="navbar__item navbar__link" href="/rabbitmq-website/contact">Support</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/rabbitmq-website/docs/3.13/troubleshooting-oauth2">3.13</a><ul class="dropdown__menu"><li class=""><strong>Release series</strong></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/next/troubleshooting-oauth2">Next</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/troubleshooting-oauth2">4.1</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/4.0/troubleshooting-oauth2">4.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/rabbitmq-website/docs/3.13/troubleshooting-oauth2">3.13</a></li><li><a href="https://v3-12.rabbitmq.com/documentation.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/rabbitmq-website/release-information">Release Information</a></li></ul></div><a href="https://github.com/rabbitmq/rabbitmq-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/docs/3.13">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/docs/3.13/whats-new">What&#x27;s New</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/3.13/download">Install and Upgrade</a><button aria-label="Expand sidebar category &#x27;Install and Upgrade&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/3.13/use-rabbitmq">How to Use RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Use RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/3.13/manage-rabbitmq">How to Manage RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Manage RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/3.13/monitoring">How to Monitor RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Monitor RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->RabbitMQ<!-- --> <b>3.13</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/rabbitmq-website/docs/troubleshooting-oauth2">latest version</a></b> (<!-- -->4.1<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rabbitmq-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 3.13</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Troubleshooting OAuth 2</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>This guide covers the most common errors encountered using <a href="/rabbitmq-website/docs/3.13/oauth2">OAuth 2.0</a> and the <a href="/rabbitmq-website/docs/3.13/management">management plugin</a> and how to diagnose them.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-client-connections">Troubleshooting Client Connections<a href="#troubleshooting-client-connections" class="hash-link" aria-label="Direct link to Troubleshooting Client Connections" title="Direct link to Troubleshooting Client Connections">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="maximum-jwt-token-length-limit">Maximum JWT Token Length Limit<a href="#maximum-jwt-token-length-limit" class="hash-link" aria-label="Direct link to Maximum JWT Token Length Limit" title="Direct link to Maximum JWT Token Length Limit">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-reproduce">Steps to reproduce<a href="#steps-to-reproduce" class="hash-link" aria-label="Direct link to Steps to reproduce" title="Direct link to Steps to reproduce">​</a></h4>
<p>A client can run into a maximum messaging protocol frame limit exception when connecting
a node that is configured to use JWT tokens for authentication and authorization.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h4>
<p>Depending on the encoded content, JWT tokens can vary greatly in length.
Messaging protocols supported by RabbitMQ have practical limits on the maximum
frame length.</p>
<p>The default is usually much higher than a practically possible JWT token length,
for example, for AMQP 0-9-1 and the <a href="/rabbitmq-website/docs/3.13/stream">RabbitMQ Stream Protocol</a> the default
is 128 kB. However, the maximum frame limit can be overriden <a href="/rabbitmq-website/docs/3.13/configure">via <code>rabbitmq.conf</code></a> and via client library configuration.</p>
<p>If a long token is provided by a client and a lower limit is configured, the connection will be refused with
a &quot;frame length exceeded&quot;, &quot;frame is too large&quot; and similar error messages
in <a href="/rabbitmq-website/docs/3.13/logging">server logs</a>.</p>
<p>For example, in the case of AMQP 0-9-1 it would look like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2025-03-15 05:55:21.689185+00:00 [info] &lt;0.2771.0&gt; accepting AMQP connection &lt;0.2771.0&gt; (10.8.121.164:45024 -&gt; 10.8.121.141:5672)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-03-15 05:55:24.745906+00:00 [error] &lt;0.2771.0&gt; closing AMQP connection &lt;0.2771.0&gt; (10.8.121.164:45024 -&gt; 10.8.121.141:5672):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-03-15 05:55:24.745906+00:00 [error] &lt;0.2771.0&gt; {handshake_error,starting,0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-03-15 05:55:24.745906+00:00 [error] &lt;0.2771.0&gt;                  {amqp_error,frame_error,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-03-15 05:55:24.745906+00:00 [error] &lt;0.2771.0&gt;                              &quot;type 1, all octets = &lt;&lt;&gt;&gt;: {frame_too_large,6307,4088}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025-03-15 05:55:24.745906+00:00 [error] &lt;0.2771.0&gt;                              none}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The only solution available in the 3.13.x series is to reduce size of JWT token,
or <a href="/rabbitmq-website/docs/3.13/upgrade">upgrade</a> to a newer version.</p>
<p>JWT token size can often be reduced by dropping certain scopes that are not used by RabbitMQ.
Alternatively, a new JWT token can be generated with a more narrow set of scopes
and thus a smaller size.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="management-ui">Troubleshooting OAuth 2 in the management UI<a href="#management-ui" class="hash-link" aria-label="Direct link to Troubleshooting OAuth 2 in the management UI" title="Direct link to Troubleshooting OAuth 2 in the management UI">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="openid-discovery-endpoint-not-reachable-error">OpenId Discovery endpoint not reachable<a href="#openid-discovery-endpoint-not-reachable-error" class="hash-link" aria-label="Direct link to OpenId Discovery endpoint not reachable" title="Direct link to OpenId Discovery endpoint not reachable">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-reproduce-1">Steps to reproduce<a href="#steps-to-reproduce-1" class="hash-link" aria-label="Direct link to Steps to reproduce" title="Direct link to Steps to reproduce">​</a></h4>
<p>Open the root URL of the management UI in the browser.
Rather than getting the button &quot;Click here to login&quot; you see the following error message:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OAuth resource [rabbitmq] not available. OpenId Discovery endpoint https://&lt;the_issuer_url&gt;/.well-known/openid-configuration not reachable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-1">Troubleshooting<a href="#troubleshooting-1" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h4>
<p>These are the most common reasons for this issue:</p>
<ul>
<li>The endpoint is unreachable, for example, there is a firewall which blocks access or a target service is down</li>
<li>The endpoint has a <a href="/rabbitmq-website/docs/3.13/ssl#peer-verification">TLS certificate not trusted</a> by the browser</li>
<li>The browser is blocking access due to a <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" target="_blank" rel="noopener noreferrer">CORS</a> policy</li>
</ul>
<p>The quickest way to identity the root cause is by opening the browser&#x27;s JavaScript console and searching for <code>net::ERR_</code>.
The most likely errors are:</p>
<ul>
<li><code>net::ERR_CONNECTION_REFUSED</code>: the endpoint is down or is unreachable</li>
<li><code>net::ERR_CERT_AUTHORITY_INVALID</code>: the endpoint&#x27;s <a href="/rabbitmq-website/docs/3.13/ssl#peer-verification">TLS certificate is not trusted</a> by the browser. To trust this certificate, click on the URL in the error message and follow the prompt</li>
</ul>
<p>If no errors match <code>net::ERR</code>, search for <code>CORS</code>. If there is an error similar to the following one</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Access to fetch at &#x27;https://&lt;the_issuer_url&gt;&gt;/.well-known/openid-configuration&#x27; from origin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;&lt;rabbitmq_url_to_management_ui&gt;&#x27; has been blocked by CORS policy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>then the browser is blocking the response returned by the endpoint and therefore it is not being delivered it to the management UI.
This is due to a <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" target="_blank" rel="noopener noreferrer">CORS</a> policy.
Ask the administrator of the Identity Provider to add the management UI&#x27;s URL to the list of allowed <strong>origins</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="openid-discovery-endpoint-not-compliant-error">OpenId Discovery endpoint not compliant<a href="#openid-discovery-endpoint-not-compliant-error" class="hash-link" aria-label="Direct link to OpenId Discovery endpoint not compliant" title="Direct link to OpenId Discovery endpoint not compliant">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-reproduce-2">Steps to reproduce<a href="#steps-to-reproduce-2" class="hash-link" aria-label="Direct link to Steps to reproduce" title="Direct link to Steps to reproduce">​</a></h4>
<p>Open the root url of the management UI in the browser.
Rather than getting the button &quot;Click here to login&quot; you see the following error message:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OAuth resource [rabbitmq] not available. OpenId Discovery endpoint https://&lt;the_issuer_url&gt;/.well-known/openid-configuration not compliant</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-2">Troubleshooting<a href="#troubleshooting-2" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h4>
<p>This issue is caused when the endpoint is not returning a JSON payload which matches with the <a href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfig" target="_blank" rel="noopener noreferrer">OpenId Connect Discovery Configuration</a>.
These are the possible causes:</p>
<ul>
<li>The payload returned by the endpoint is not compliant because it is empty or it is missing some critical information. To identify the root cause, open the browser&#x27;s JavaScript console and search for one of these possible error messages:<!-- -->
<ul>
<li><code>Payload does not contain openid configuration</code> This error occurs when the payload is empty or it is not a JSON payload.</li>
<li><code>Missing authorization_endpoint</code> This error occurs when the JSON attribute <code>authorization_endpoint</code> is missing.</li>
<li><code>Missing token_endpoint</code> This error occurs when the JSON attribute <code>token_endpoint</code> is missing.</li>
<li><code>Missing jwks_uri</code> This error occurs when the JSON attribute <code>jwks_uri</code> is missing.</li>
</ul>
</li>
<li>The URL is wrong. Retrieve the correct url to the OpenId Connect Discovery endpoint from your identity provider administrator.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="not-authorized-error">Not authorized<a href="#not-authorized-error" class="hash-link" aria-label="Direct link to Not authorized" title="Direct link to Not authorized">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-reproduce-3">Steps to reproduce<a href="#steps-to-reproduce-3" class="hash-link" aria-label="Direct link to Steps to reproduce" title="Direct link to Steps to reproduce">​</a></h4>
<p>Open the root URL of the management UI in the browser. Click on the button &quot;Click here to logon&quot; and
enter the credentials requested by the identity provider.</p>
<p>You are redirected back to the management UI with the following error:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Not authorized</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-3">Troubleshooting<a href="#troubleshooting-3" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h4>
<p>This issue occurs when the token does not have enough scopes or permissions to access the management UI. You need at least one of these scopes or the equivalent scope:</p>
<ul>
<li><code>rabbitmq.tag:administrator</code>.</li>
<li><code>rabbitmq.tag:management</code>.</li>
<li><code>rabbitmq.tag:monitoring</code>.</li>
<li><code>rabbitmq.tag:policymaker</code>.</li>
</ul>
<p>Follow these steps to find out which scopes or permissions are carried in the token:</p>
<ol>
<li>Open your browwser&#x27;s developer tool (for example, in Chrome or Firefox, right-click on the page and click on <em>Inspect</em> menu option)</li>
<li>Go to the <em>Application</em> tab</li>
<li>Select the option <em>Storage</em> &gt; <em>Local Storage</em> in the left panel</li>
<li>Click on the tree option which matches the URL of the management UI</li>
<li>Select the Key <em>rabbitmq.credentials</em> in the right panel</li>
<li>Copy its value</li>
<li>Navigate to <a href="https://jwt.io" target="_blank" rel="noopener noreferrer">https://jwt.io</a></li>
<li>Paste the value into the text field <em>Encoded</em></li>
<li>Look at the payload&#x27;s text field <em>Decoded</em></li>
<li>Search for the token attribute <code>scope</code> in the tokens&#x27; payload or for the value configured in <code>auth_oauth2.additional_scopes_key</code>, if any</li>
<li>Once you found the appropriate token&#x27;s scope attribute, find within the attribute&#x27;s value any of the scopes listed above. If <a href="/rabbitmq-website/docs/3.13/oauth2#scope-prefix">auth_oauth2.scope_prefix</a> is used, it must be taken into account: the scopes will be named like  <code>myprefix_tag:administrator</code>. If <a href="/rabbitmq-website/docs/3.13/oauth2-examples#using-scope-aliases">scope aliases</a> are used, find the scope alias that maps to one of the scopes listed above</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="openid-discovery-endpoint-bad-certificate">OpenId Discovery endpoint unreachable due to bad certificate<a href="#openid-discovery-endpoint-bad-certificate" class="hash-link" aria-label="Direct link to OpenId Discovery endpoint unreachable due to bad certificate" title="Direct link to OpenId Discovery endpoint unreachable due to bad certificate">​</a></h3>
<p>This issue is not necessarily specific to the management UI, it may also occur when an application is authenticating via one of the messaging protocols. It occurs when RabbitMQ has to download the OpenId Connect configuration via the url configured in <code>auth_oauth2.issuer</code> and the certificate used by the issuer uses a wildcard certificate. This means that the certificate&#x27;s CN attribute does not match exactly the issuer&#x27;s domain name. This is very common on SaaS deployments.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-reproduce-4">Steps to reproduce<a href="#steps-to-reproduce-4" class="hash-link" aria-label="Direct link to Steps to reproduce" title="Direct link to Steps to reproduce">​</a></h4>
<ol>
<li>Open the root URL of the management UI in the browser.</li>
<li>Click on &quot;Click here to login&quot;.</li>
<li>Enter your credentials.</li>
<li>You are redirected back to RabbitMQ but with an error &quot;No Authorized&quot;.</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-4">Troubleshooting<a href="#troubleshooting-4" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h4>
<ol>
<li>Access the RabbitMQ logs</li>
<li>Look for <code>{bad_cert,hostname_check_failed}</code></li>
<li>If you find an entry, it means that RabbitMQ tried to contact the URL found in <code>auth_oauth2.issuer</code> and the issuer presented a wildcard certificate</li>
<li>To fix this issue, add the following line to <code>rabbitmq.conf</code>: <code>auth_oauth2.https.hostname_verification = wildcard</code>, or <code>auth_oauth2.oauth_providers.&lt;my_oauth_provider_name&gt;.https.hostname_verification = wildcard</code> if multiple identity providers are used</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rabbitmq/rabbitmq-website/tree/main/versioned_docs/version-3.13/troubleshooting-oauth2.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#troubleshooting-client-connections" class="table-of-contents__link toc-highlight">Troubleshooting Client Connections</a><ul><li><a href="#maximum-jwt-token-length-limit" class="table-of-contents__link toc-highlight">Maximum JWT Token Length Limit</a></li></ul></li><li><a href="#management-ui" class="table-of-contents__link toc-highlight">Troubleshooting OAuth 2 in the management UI</a><ul><li><a href="#openid-discovery-endpoint-not-reachable-error" class="table-of-contents__link toc-highlight">OpenId Discovery endpoint not reachable</a></li><li><a href="#openid-discovery-endpoint-not-compliant-error" class="table-of-contents__link toc-highlight">OpenId Discovery endpoint not compliant</a></li><li><a href="#not-authorized-error" class="table-of-contents__link toc-highlight">Not authorized</a></li><li><a href="#openid-discovery-endpoint-bad-certificate" class="table-of-contents__link toc-highlight">OpenId Discovery endpoint unreachable due to bad certificate</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn about RabbitMQ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Reach out to the RabbitMQ team</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rabbitmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/rabbitmq/rabbitmq-server/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact?utm_source=rmq_release-information_tableheader&amp;utm_medium=rmq_website&amp;utm_campaign=tanzu">Long Term Commercial Support</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact">Contact Us</a></li><li class="footer__item"><a href="https://www.rabbitmq.com/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Broadcom</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tanzu.vmware.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VMware Tanzu<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/legal.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/trademark-guidelines">Trademark Guidelines</a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy/california-privacy-rights.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Your California Privacy Rights<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item ot-sdk-show-settings">Cookie Settings</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2005-2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div>
</body>
</html>