<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-monitoring/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Monitoring | RabbitMQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" name="twitter:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" property="og:url" content="https://www.rabbitmq.com/rabbitmq-website/docs/next/monitoring"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Monitoring | RabbitMQ"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/rabbitmq-website/img/rabbitmq-logo.svg"><link data-rh="true" rel="canonical" href="https://www.rabbitmq.com/rabbitmq-website/docs/next/monitoring"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/next/monitoring" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/next/monitoring" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://H10VQIW16Y-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rabbitmq-website/blog/rss.xml" title="RabbitMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rabbitmq-website/blog/atom.xml" title="RabbitMQ Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="RabbitMQ" href="/rabbitmq-website/opensearch.xml">







<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,700">
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-domain-script="018ee308-473e-754f-b0c2-cbe82d25512f"></script>
<script>function OptanonWrapper(){}</script>
<script>function setGTM(e,t,o,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=t.getElementsByTagName(o)[0],a=t.createElement(o),s="dataLayer"!=n?"&l="+n:"";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+r+s,i.parentNode.insertBefore(a,i)}var timer;function waitForOnetrustActiveGroups(){document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?(clearTimeout(timer),setGTM(window,document,"script","dataLayer","GTM-TT84L8K")):timer=setTimeout(waitForOnetrustActiveGroups,250)}document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?setGTM(window,document,"script","dataLayer","GTM-TT84L8K"):waitForOnetrustActiveGroups()</script><link rel="stylesheet" href="/rabbitmq-website/styles.css">
<script src="/rabbitmq-website/runtime~main.js" defer="defer"></script>
<script src="/rabbitmq-website/main.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:var(--ifm-color-primary-contrast-background);color:var(--ifm-font-color-base)" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong style="font-size: var(--ifm-h4-font-size);"><a href="https://github.com/rabbitmq/rabbitmq-server/releases/tag/v4.1.0">RabbitMQ 4.1.0 is out</a></strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rabbitmq-website/"><div class="navbar__logo"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/rabbitmq-website/tutorials">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rabbitmq-website/docs/next">Docs</a><a class="navbar__item navbar__link" href="/rabbitmq-website/blog">Blog</a><a class="navbar__item navbar__link" href="/rabbitmq-website/contact">Support</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/rabbitmq-website/docs/next/monitoring">Next</a><ul class="dropdown__menu"><li class=""><strong>Release series</strong></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/rabbitmq-website/docs/next/monitoring">Next</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/monitoring">4.1</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/4.0/monitoring">4.0</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/3.13/monitoring">3.13</a></li><li><a href="https://v3-12.rabbitmq.com/documentation.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/rabbitmq-website/release-information">Release Information</a></li></ul></div><a href="https://github.com/rabbitmq/rabbitmq-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/docs/next">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/release-information">Release Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/next/download">Install and Upgrade</a><button aria-label="Expand sidebar category &#x27;Install and Upgrade&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/next/use-rabbitmq">How to Use RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Use RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/next/manage-rabbitmq">How to Manage RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Manage RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" href="/rabbitmq-website/docs/next/monitoring">How to Monitor RabbitMQ</a><button aria-label="Collapse sidebar category &#x27;How to Monitor RabbitMQ&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/next/prometheus">Prometheus and Grafana</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/next/event-exchange">Event Exchange Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/next/firehose">Firehose Tracing</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->RabbitMQ<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/rabbitmq-website/docs/monitoring">latest version</a></b> (<!-- -->4.1<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rabbitmq-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to Monitor RabbitMQ</span><meta itemprop="position" content="1"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Monitoring</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>This document provides an overview of topics related to RabbitMQ monitoring.
Monitoring RabbitMQ and applications that use it is critically important. Monitoring helps
detect issues before they affect the rest of the environment and, eventually, the end users.</p>
<p>The combination of <a href="/rabbitmq-website/docs/next/prometheus">Prometheus and Grafana</a> is the highly recommended option
for RabbitMQ monitoring.</p>
<p>Monitoring is a broad topic. This guide covers several :</p>
<ul>
<li><a href="#fundamentals">What is monitoring</a>, why it is important, what common approaches to it exist</li>
<li>Available monitoring options:<!-- -->
<ul>
<li><a href="#with-prometheus">Prometheus-compatible</a> external scrapers for production clusters</li>
<li><a href="#on-kubernetes">Kubernetes Operator monitoring</a> features for Kubernetes users</li>
<li><a href="#with-cli-observer">interactive command line tool</a> for focused troubleshooting</li>
<li><a href="#with-management">management plugin</a>&#x27;s HTTP API for development environments</li>
</ul>
</li>
<li>What <a href="#system-metrics">infrastructure and kernel metrics</a> are important to monitor</li>
<li>What <a href="#rabbitmq-metrics">RabbitMQ metrics</a> are available:<!-- -->
<ul>
<li><a href="#node-metrics">Node metrics</a></li>
<li><a href="#queue-metrics">Queue metrics</a></li>
<li><a href="#cluster-wide-metrics">Cluster-wide metrics</a></li>
</ul>
</li>
<li>How much <a href="#overhead">overhead does monitoring introduce</a> and <a href="#monitoring-frequency">how frequently</a> should monitoring checks be performed?</li>
<li><a href="#app-metrics">Application-level metrics</a></li>
<li>How to approach <a href="#health-checks">node health checking</a> and why it&#x27;s more involved than a single
CLI command</li>
<li>Health checks use as <a href="#readiness-probes">node readiness probes</a> during deployment or upgrades</li>
<li><a href="#log-aggregation">Log aggregation</a> across all nodes and applications is closely related to monitoring</li>
</ul>
<p>A number of <a href="#monitoring-tools">popular tools</a>, both open source and commercial,
can be used to monitor RabbitMQ. As mentioned above, the combination of <a href="/rabbitmq-website/docs/next/prometheus">Prometheus and Grafana</a>
is what team RabbitMQ would recommend to most users. <a href="/rabbitmq-website/kubernetes/operator/operator-monitoring">On Kubernetes</a>,
the Prometheus plugin is automatically enabled by the Kubernetes RabbitMQ Operator.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fundamentals">What is Monitoring?<a href="#fundamentals" class="hash-link" aria-label="Direct link to What is Monitoring?" title="Direct link to What is Monitoring?">​</a></h2>
<p>In this guide we define monitoring as a process of
capturing the behaviour of a system via health checks and metrics  over time.
This helps detect anomalies: when the system is unavailable, experiences an unusual load,
exhausted of certain resources or otherwise does not behave within its normal
(expected) parameters. Monitoring involves collecting and storing metrics for the long term,
which is important for more than anomaly detection
but also root cause analysis, trend detection and capacity planning.</p>
<p>Monitoring systems typically integrate with alerting systems.
When an anomaly is detected by a monitoring system an alarm of some sort is typically
passed to an alerting system, which notifies interested parties such as the technical operations team.</p>
<p>Having monitoring in place means that important deviations in system behavior,
from degraded service in some areas to complete unavailability, is easier
to detect and the root cause takes much less time to find.
Operating a distributed system without monitoring data is a bit like trying to get out of a forest
without a GPS navigator device or compass. It doesn&#x27;t matter how brilliant or experienced
the person is, having relevant information is very important for
a good outcome.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-checks-role-in-monitoring">Health Checks&#x27; Role in Monitoring<a href="#health-checks-role-in-monitoring" class="hash-link" aria-label="Direct link to Health Checks&#x27; Role in Monitoring" title="Direct link to Health Checks&#x27; Role in Monitoring">​</a></h3>
<p><a href="#health-checks">Health checks</a> are another important aspect of monitoring. A health check involves a command or
set of commands that collect a few essential metrics of the monitored system <a href="#monitoring-frequency">over time</a>
and assert on the state (health) of the system based on that metric.</p>
<p>For example, whether RabbitMQ&#x27;s Erlang VM is running is
one such check. The metric in this case is &quot;is an OS process running?&quot;. The normal operating
parameters are &quot;the process must be running&quot;. Finally, there is an evaluation step.</p>
<p>Of course, there are more varieties of health checks. Which ones are most appropriate depends on the
definition of a &quot;healthy node&quot; used. So, it is a system- and team-specific decision. <a href="/rabbitmq-website/docs/next/cli">RabbitMQ CLI
tools</a> provide commands that can serve as useful health checks. They will be covered
<a href="#health-checks">later in this guide</a>.</p>
<p>While health checks are a useful tool, they only provide so much insight into the state of the
system because they are by design focused on one or a handful of metrics, usually check a single
node and can only reason about the state of that node at a particular moment in time. For a more
comprehensive assessment, collect more metrics <a href="#monitoring-frequency">over time</a>. This detects more
types of anomalies as some can only be identified over longer periods of time. This is usually done
by tools known as monitoring tools of which there are a grand variety. This guides covers some tools
used for RabbitMQ monitoring.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="system-and-rabbitmq-metrics">System and RabbitMQ Metrics<a href="#system-and-rabbitmq-metrics" class="hash-link" aria-label="Direct link to System and RabbitMQ Metrics" title="Direct link to System and RabbitMQ Metrics">​</a></h3>
<p>Some metrics are RabbitMQ-specific: they are <a href="#rabbitmq-metrics">collected and reported by RabbitMQ
nodes</a>. In this guide we refer to them as &quot;RabbitMQ metrics&quot;. Examples include
the number of socket descriptors used, total number of enqueued messages or inter-node communication
traffic rates. Others metrics are <a href="#system-metrics">collected and reported by the OS kernel</a>. Such
metrics are often called system metrics or infrastructure metrics. System metrics are not specific
to RabbitMQ. Examples include CPU utilisation rate, amount of memory used by processes, network
packet loss rate, et cetera. Both types are important to track. Individual metrics are not always
useful but when analysed together, they can provide a more complete insight into the state of the
system. Then operators can form a hypothesis about what&#x27;s going on and needs addressing.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="system-metrics">Infrastructure and Kernel Metrics<a href="#system-metrics" class="hash-link" aria-label="Direct link to Infrastructure and Kernel Metrics" title="Direct link to Infrastructure and Kernel Metrics">​</a></h3>
<p>First step towards a useful monitoring system starts with infrastructure and
kernel metrics. There are quite a few of them but some are more important than others.
Collect the following metrics on all hosts that run RabbitMQ nodes or applications:</p>
<ul>
<li>CPU stats (user, system, iowait, idle percentages)</li>
<li>Memory usage (used, buffered, cached and free percentages)</li>
<li><a href="/rabbitmq-website/docs/next/memory-use#page-cache">Kernel page cache</a>, in particular in clusters where <a href="/rabbitmq-website/docs/next/streams">streams</a> are used</li>
<li><a href="https://www.kernel.org/doc/Documentation/sysctl/vm.txt" target="_blank" rel="noopener noreferrer">Virtual Memory</a> statistics (dirty page flushes, writeback volume)</li>
<li>Disk I/O (frequency of operations, amount of data transferred per unit time, statistical distribution of long I/O operation take to completes, I/O operation failure rates)</li>
<li>Free disk space on the mount used for the <a href="/rabbitmq-website/docs/next/relocate">node data directory</a></li>
<li>File descriptors used by <code>beam.smp</code> vs. <a href="/rabbitmq-website/docs/next/networking#open-file-handle-limit">max system limit</a></li>
<li>TCP connections by state (<code>ESTABLISHED</code>, <code>CLOSE_WAIT</code>, <a href="https://vincent.bernat.ch/en/blog/2014-tcp-time-wait-state-linux" target="_blank" rel="noopener noreferrer"><code>TIME_WAIT</code></a>)</li>
<li>Network throughput (bytes received, bytes sent) &amp; maximum network throughput</li>
<li>Network latency (between all RabbitMQ nodes in a cluster as well as to/from clients)</li>
</ul>
<p>There is no shortage of existing tools (such as Prometheus or Datadog) that collect infrastructure
and kernel metrics, store and visualise them over periods of time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="with-prometheus">Monitoring with Prometheus-compatible Tools<a href="#with-prometheus" class="hash-link" aria-label="Direct link to Monitoring with Prometheus-compatible Tools" title="Direct link to Monitoring with Prometheus-compatible Tools"> ​</a></h2>
<p>RabbitMQ comes with a built-in plugin that exposes metrics in the Prometheus format: <a href="/rabbitmq-website/docs/next/prometheus"><code>rabbitmq_prometheus</code></a>.
The plugin expose a number of <a href="#rabbitmq-metrics">RabbitMQ metrics</a> for nodes, connections, queues, message rates and so on.
This plugin has low overhead and is highly recommended for production environments.</p>
<p><a href="/rabbitmq-website/docs/next/prometheus">Prometheus in combination with Grafana</a> or the <a href="https://www.elastic.co/what-is/elk-stack" target="_blank" rel="noopener noreferrer">ELK stack</a>
have a number of benefits compared to other monitoring options:</p>
<ul>
<li>Decoupling of the monitoring system from the system being monitored</li>
<li>Lower overhead</li>
<li>Long term metric storage</li>
<li>Access to additional related metrics such as those of the <a href="/rabbitmq-website/docs/next/runtime">runtime</a></li>
<li>More powerful and customizable user interface</li>
<li>Ease of metric data sharing: both metric state and dashboards</li>
<li>Metric access permissions are not specific to RabbitMQ</li>
<li>Collection and aggregation of node-specific metrics which is more resilient to individual node failures</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-enable-it">How to Enable It<a href="#how-to-enable-it" class="hash-link" aria-label="Direct link to How to Enable It" title="Direct link to How to Enable It">​</a></h3>
<p>To enable the Prometheus plugin, use</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-plugins </span><span class="token builtin class-name">enable</span><span class="token plain"> rabbitmq_prometheus</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>or <a href="/rabbitmq-website/docs/next/plugins#enabled-plugins-file">pre-configure</a> the plugin.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-api-endpoint">HTTP API Endpoint<a href="#http-api-endpoint" class="hash-link" aria-label="Direct link to HTTP API Endpoint" title="Direct link to HTTP API Endpoint">​</a></h3>
<p>The plugin serves metrics to Prometheus-compatible scrapers on port <code>15692</code> by default:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">:15692/metrics</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Please consult the <a href="/rabbitmq-website/docs/next/prometheus">Prometheus plugin guide</a> to learn more.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="with-management">Monitoring using Management Plugin<a href="#with-management" class="hash-link" aria-label="Direct link to Monitoring using Management Plugin" title="Direct link to Monitoring using Management Plugin">​</a></h2>
<p>The built-in <a href="/rabbitmq-website/docs/next/management">management plugin</a> can also collect metrics and display them in the UI.
This is a convenient option for development environments.</p>
<p>The plugin can also serve metrics to monitoring tools.
It has, however, a number of significant limitations compared to <a href="#with-prometheus">monitoring with Prometheus</a>:</p>
<ul>
<li>The monitoring system is intertwined with the system being monitored</li>
<li>Monitoring using management plugin tends to have more overhead, in partiicular to node RAM footprint</li>
<li>It only stores recent data (think hours, not days or months)</li>
<li>It only has a basic user interface</li>
<li>Its design <a href="/rabbitmq-website/docs/next/management#clustering">emphasizes ease of use over best possible availability</a>.</li>
<li>Management UI access is controlled via the <a href="/rabbitmq-website/docs/next/access-control">RabbitMQ permission tags system</a>
(or a convention on JWT token scopes)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-enable-it-1">How to Enable It<a href="#how-to-enable-it-1" class="hash-link" aria-label="Direct link to How to Enable It" title="Direct link to How to Enable It">​</a></h3>
<p>To enable the management plugin, use</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-plugins </span><span class="token builtin class-name">enable</span><span class="token plain"> rabbitmq_management</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>or <a href="/rabbitmq-website/docs/next/plugins#enabled-plugins-file">pre-configure</a> the plugin.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-api-endpoint-1">HTTP API Endpoint<a href="#http-api-endpoint-1" class="hash-link" aria-label="Direct link to HTTP API Endpoint" title="Direct link to HTTP API Endpoint">​</a></h3>
<p>The plugin serves metrics via the HTTP API on port <code>15672</code> by default and uses Basic HTTP Authentication:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">password</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">:15672/api/overview</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Please consult the <a href="/rabbitmq-website/docs/next/management">Management plugin guide</a> to learn more.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="on-kubernetes">Monitoring of Kubernetes Operator-deployed Clusters<a href="#on-kubernetes" class="hash-link" aria-label="Direct link to Monitoring of Kubernetes Operator-deployed Clusters" title="Direct link to Monitoring of Kubernetes Operator-deployed Clusters">​</a></h2>
<p>RabbitMQ clusters deployed to Kubernetes using the <a href="/rabbitmq-website/kubernetes/operator/operator-overview">RabbitMQ Kubernetes Operator</a>
can be monitored with Prometheus or compatible tools.</p>
<p>This is covered in a dedicated guide on <a href="/rabbitmq-website/kubernetes/operator/operator-monitoring">Monitoring RabbitMQ in Kubernetes</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="with-cli-observer">Interactive Command Line-Based Observer Tool<a href="#with-cli-observer" class="hash-link" aria-label="Direct link to Interactive Command Line-Based Observer Tool" title="Direct link to Interactive Command Line-Based Observer Tool">​</a></h2>
<p><code>rabbitmq-diagnostics observer</code> is a command-line tool similar to <code>top</code>, <code>htop</code>, <code>vmstat</code>. It is a command line
alternative to <a href="http://erlang.org/doc/man/observer.html" target="_blank" rel="noopener noreferrer">Erlang&#x27;s Observer application</a>. It provides
access to many metrics, including detailed state of individual <a href="/rabbitmq-website/docs/next/runtime">runtime</a> processes:</p>
<ul>
<li>Runtime version information</li>
<li>CPU and schedule stats</li>
<li>Memory allocation and usage stats</li>
<li>Top processes by CPU (reductions) and memory usage</li>
<li>Network link stats</li>
<li>Detailed process information such as basic TCP socket stats</li>
</ul>
<p>and more, in an interactive <a href="https://en.wikipedia.org/wiki/Ncurses" target="_blank" rel="noopener noreferrer">ncurses</a>-like command line interface with periodic updates.</p>
<p>Here are some screenshots that demonstrate what kind of information the
tool provides.</p>
<p>An overview page with key runtime metrics:</p>
<figure><p><img decoding="async" loading="lazy" alt="rabbitmq-diagnostics observer overview" src="/rabbitmq-website/assets/images/diagnostics-observer-overview-4af65b164e3a1ca45e8c45f589017d87.png" width="1960" height="1266" class="img_ev3q"></p></figure>
<p>Memory allocator stats:</p>
<figure><p><img decoding="async" loading="lazy" alt="rabbitmq-diagnostics memory breakdown" src="/rabbitmq-website/assets/images/diagnostics-observer-heap-inspector-ca3a378883d52777b0031e04db81045c.png" width="1958" height="792" class="img_ev3q"></p></figure>
<p>A client connection process metrics:</p>
<figure><p><img decoding="async" loading="lazy" alt="rabbitmq-diagnostics connection process" src="/rabbitmq-website/assets/images/diagnostics-observer-connection-process-2982c24a7d3b1c04a2bdd05353507f6b.png" width="1892" height="554" class="img_ev3q"></p></figure>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overhead">Resource Use and Overhead of Monitoring<a href="#overhead" class="hash-link" aria-label="Direct link to Resource Use and Overhead of Monitoring" title="Direct link to Resource Use and Overhead of Monitoring">​</a></h2>
<p>Monitoring can be intrusive and increase load on the system being monitored. This depends
on how many entities (connections, queues, etc) there are in the monitored cluster but
also on other factors: monitoring frequency, how much data monitoring tools request,
and so on.</p>
<p>Many monitoring systems poll their monitored services periodically. How often that&#x27;s
done varies from tool to tool but usually can be configured by the operator.</p>
<p>Very frequent polling can have negative consequences on the system under monitoring. For example,
excessive load balancer checks that open a test TCP connection to a node can lead to a <a href="/rabbitmq-website/docs/next/networking#dealing-with-high-connection-churn">high connection churn</a>.
Excessive checks of channels and queues in RabbitMQ will increase its CPU consumption. When there
are many (say, 10s of thousands) of them on a node, the difference can be significant.</p>
<p>Another common issue with monitoring tools is how much data they request from RabbitMQ nodes.
Some monitoring tools query a full page or all queues just to get a single metric value of one queue.
This can significantly increase CPU load footprint of monitoring.</p>
<p>Such conditions can be identified using the <code>rabbitmq_top</code> plugin or <code>rabbitmq-diagnostics observer</code>.
Top processes by the number of reductions (a unit of runtime scheduler time) will usually be one
of the following processes:</p>
<ul>
<li><code>rabbit_mgmt_db_cache_connections</code></li>
<li><code>rabbit_mgmt_external_stats</code></li>
<li><code>queue_metrics_metrics_collector</code></li>
<li>and other processes whose names end with a <code>_metrics_collector</code></li>
</ul>
<p>To reduce monitoring footprint, reduce frequency of monitoring and make sure that the monitoring
tool only queries for the data it needs.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-frequency">Frequency of Monitoring<a href="#monitoring-frequency" class="hash-link" aria-label="Direct link to Frequency of Monitoring" title="Direct link to Frequency of Monitoring">​</a></h3>
<p>The recommended metric collection interval for production is <strong>30 seconds</strong>, or another suitable
value in the 30 to 60 second range. <a href="/rabbitmq-website/docs/next/prometheus">Prometheus</a> exporter API is designed to be
scraped every 15 to 30 seconds, including production systems.</p>
<p>In a development environment, to collect at an interval which is closer to real-time, use 5 seconds —- but not lower!</p>
<p>For rate metrics, use a time range that spans four or more metric collection intervals so that it
can tolerate race-conditions and is resilient to scrape failures.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rabbitmq-metrics">RabbitMQ Metrics<a href="#rabbitmq-metrics" class="hash-link" aria-label="Direct link to RabbitMQ Metrics" title="Direct link to RabbitMQ Metrics">​</a></h2>
<p>This section will cover multiple RabbitMQ-specific aspects of monitoring. Most metrics mentioned
in this section are exposed by both the <a href="/rabbitmq-website/docs/next/prometheus">Prometheus plugin</a> and management UI.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-wide-metrics">Cluster-wide Metrics<a href="#cluster-wide-metrics" class="hash-link" aria-label="Direct link to Cluster-wide Metrics" title="Direct link to Cluster-wide Metrics">​</a></h3>
<p>Cluster-wide metrics provide a high level view of cluster state. Some of them describe interaction
between nodes. Examples of such metrics are cluster link traffic and detected network partitions.
Others combine metrics across all cluster members. A complete list of connections to all nodes would
be one example. Both types are complimentary to infrastructure and node metrics.</p>
<p><code>GET /api/overview</code> is the <a href="/rabbitmq-website/docs/next/management#http-api">HTTP API</a> endpoint that returns cluster-wide metrics.</p>
<table><thead><tr><td>Metric</td><td>JSON field name</td></tr></thead><tbody><tr><td>Cluster name</td><td><code>cluster_name</code></td></tr><tr><td>Cluster-wide message rates</td><td><code>message_stats</code></td></tr><tr><td>Total number of connections</td><td><code>object_totals.connections</code></td></tr><tr><td>Total number of channels</td><td><code>object_totals.channels</code></td></tr><tr><td>Total number of queues</td><td><code>object_totals.queues</code></td></tr><tr><td>Total number of consumers</td><td><code>object_totals.consumers</code></td></tr><tr><td>Total number of messages (ready plus unacknowledged)</td><td><code>queue_totals.messages</code></td></tr><tr><td>Number of messages ready for delivery</td><td><code>queue_totals.messages_ready</code></td></tr><tr><td>Number of <a href="./confirms">unacknowledged</a> messages</td><td><code>queue_totals.messages_unacknowledged</code></td></tr><tr><td>Messages published recently</td><td><code>message_stats.publish</code></td></tr><tr><td>Message publish rate</td><td><code>message_stats.publish_details.rate</code></td></tr><tr><td>Messages delivered to consumers recently</td><td><code>message_stats.deliver_get</code></td></tr><tr><td>Message delivery rate</td><td><code>message_stats.deliver_get_details.rate</code></td></tr><tr><td>Other message stats</td><td><p><code>message_stats.*</code> (see <a href="https://rawcdn.githack.com/rabbitmq/rabbitmq-server/&lt;unreleased&gt;/deps/rabbitmq_management/priv/www/api/index.html">HTTP API reference</a>)</p></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="node-metrics">Node Metrics<a href="#node-metrics" class="hash-link" aria-label="Direct link to Node Metrics" title="Direct link to Node Metrics">​</a></h3>
<p>There are two  <a href="/rabbitmq-website/docs/next/management#http-api">HTTP API</a> endpoints that provide access to node-specific metrics:</p>
<ul>
<li><code>GET /api/nodes/{node}</code> returns stats for a single node</li>
<li><code>GET /api/nodes</code> returns stats for all cluster members</li>
</ul>
<p>The latter endpoint returns an array of objects. Monitoring tools that support (or can support) that
as an input should prefer that endpoint since it reduces the number of requests. When that&#x27;s not
the case, use the former endpoint to retrieve stats for every cluster member in turn. That implies
that the monitoring system is aware of the list of cluster members.</p>
<p>Most of the metrics represent point-in-time absolute values. Some, represent activity over a recent
period of time (for example, GC runs and bytes reclaimed). The latter metrics are most useful when
compared to their previous values and historical mean/percentile values.</p>
<table><thead><tr><td>Metric</td><td>JSON field name</td></tr></thead><tbody><tr><td>Total amount of <a href="./memory-use">memory used</a></td><td><code>mem_used</code></td></tr><tr><td>Memory usage high watermark</td><td><code>mem_limit</code></td></tr><tr><td>Is a <a href="./memory">memory alarm</a> in effect?</td><td><code>mem_alarm</code></td></tr><tr><td>Free disk space low watermark</td><td><code>disk_free_limit</code></td></tr><tr><td>Is a <a href="./disk-alarms">disk alarm</a> in effect?</td><td><code>disk_free_alarm</code></td></tr><tr><td><a href="./networking#open-file-handle-limit">File descriptors available</a></td><td><code>fd_total</code></td></tr><tr><td>File descriptors used</td><td><code>fd_used</code></td></tr><tr><td>File descriptor open attempts</td><td><code>io_file_handle_open_attempt_count</code></td></tr><tr><td>Inter-node communication links</td><td>cluster_links</td></tr><tr><td>GC runs</td><td><code>gc_num</code></td></tr><tr><td>Bytes reclaimed by GC</td><td><code>gc_bytes_reclaimed</code></td></tr><tr><td>Erlang process limit</td><td><code>proc_total</code></td></tr><tr><td>Erlang processes used</td><td><code>proc_used</code></td></tr><tr><td>Runtime run queue</td><td><code>run_queue</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="queue-metrics">Individual Queue Metrics<a href="#queue-metrics" class="hash-link" aria-label="Direct link to Individual Queue Metrics" title="Direct link to Individual Queue Metrics">​</a></h3>
<p>Individual queue metrics are made available through the <a href="/rabbitmq-website/docs/next/management#http-api">HTTP API</a>
via the <code>GET /api/queues/{vhost}/{qname}</code> endpoint.</p>
<p>The table below lists some key metrics that can be useful for monitoring queue state.
Some other metrics (such as queue state and &quot;idle period&quot;) should be considered <strong>internal metrics</strong>
used by RabbitMQ contributors.</p>
<table><thead><tr><td>Metric</td><td>JSON field name</td></tr></thead><tbody><tr><td>Memory</td><td><code>memory</code></td></tr><tr><td>Total number of messages (ready plus unacknowledged)</td><td><code>messages</code></td></tr><tr><td>Number of messages ready for delivery</td><td><code>messages_ready</code></td></tr><tr><td>Number of <a href="./confirms">unacknowledged</a> messages</td><td><code>messages_unacknowledged</code></td></tr><tr><td>Messages published recently</td><td><code>message_stats.publish</code></td></tr><tr><td>Message publishing rate</td><td><code>message_stats.publish_details.rate</code></td></tr><tr><td>Messages delivered recently</td><td><code>message_stats.deliver_get</code></td></tr><tr><td>Message delivery rate</td><td><code>message_stats.deliver_get_details.rate</code></td></tr><tr><td>Other message stats</td><td><p><code>message_stats.*</code> (see <a href="https://rawcdn.githack.com/rabbitmq/rabbitmq-server/&lt;unreleased&gt;/deps/rabbitmq_management/priv/www/api/index.html">HTTP API reference</a>)</p></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="app-metrics">Application-level Metrics<a href="#app-metrics" class="hash-link" aria-label="Direct link to Application-level Metrics" title="Direct link to Application-level Metrics">​</a></h2>
<p>A system that uses messaging is almost always distributed. In such systems it is often not
immediately obvious which component is misbehaving. Every single part of the system, including
applications, should be monitored and investigated.</p>
<p>Some infrastructure-level and RabbitMQ metrics can show
presence of an unusual system behaviour or issue but can&#x27;t
pinpoint the root cause. For example, it is easy to tell that a
node is running out of disk space but not always easy to tell why.
This is where application metrics come in: they can help identify
a run-away publisher, a repeatedly failing consumer, a consumer that cannot
keep up with the rate, or even a downstream service that&#x27;s experiencing a slowdown
(e.g. a missing index in a database used by the consumers).</p>
<p>Some client libraries and frameworks
provide means of registering metrics collectors or collect metrics out of the box.
<a href="/rabbitmq-website/client-libraries/java-api-guide">RabbitMQ Java client</a>, <a href="http://spring.io/projects/spring-amqp" target="_blank" rel="noopener noreferrer">Spring AMQP</a>, and <a href="https://docs.particular.net/transports/rabbitmq/" target="_blank" rel="noopener noreferrer">NServiceBus</a> are some examples.
With others developers have to track metrics in their application code.</p>
<p>What metrics applications track can be system-specific but some are relevant
to most systems:</p>
<ul>
<li>Connection opening rate</li>
<li>Channel opening rate</li>
<li>Connection failure (recovery) rate</li>
<li>Publishing rate</li>
<li>Delivery rate</li>
<li>Positive delivery acknowledgement rate</li>
<li>Negative delivery acknowledgement rate</li>
<li>Mean/95th percentile delivery processing latency</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="health-checks">Health Checks<a href="#health-checks" class="hash-link" aria-label="Direct link to Health Checks" title="Direct link to Health Checks">​</a></h2>
<p>A health check is a command that
tests whether an aspect of the RabbitMQ service is operating as expected.
Health checks are <a href="#monitoring-frequency">executed periodically by machines</a> or interactively by operators.</p>
<p>Health checks can be used to both assess the state and liveness of a node but also as <a href="#readiness-probes">readiness probes</a>
by deployment automation and orchestration tools, including during upgrades.</p>
<p>There are a series of health checks that can be performed, starting
with the most basic and very rarely producing <a href="https://en.wikipedia.org/wiki/False_positives_and_false_negatives" target="_blank" rel="noopener noreferrer">false positives</a>,
to increasingly more comprehensive, intrusive, and opinionated that have a
higher probability of false positives. In other words, the more comprehensive a
health check is, the less conclusive the result will be.</p>
<p>Health checks can verify the state of an individual node (node health checks), or the entire cluster
(cluster health checks).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="individual-checks">Individual Node Checks<a href="#individual-checks" class="hash-link" aria-label="Direct link to Individual Node Checks" title="Direct link to Individual Node Checks">​</a></h3>
<p>This section covers several examples of node health check. They are organised in stages.
Higher stages perform more comprehensive and opinionated checks. Such checks will have a higher probability of
false positives. Some stages have dedicated RabbitMQ CLI tool commands, others can involve extra tools.</p>
<p>While the health checks are ordered, a higher number does not mean a check is &quot;better&quot;.</p>
<p>The health checks can be used selectively and combined.
Unless noted otherwise, the checks should follow the same <a href="#monitoring-frequency">monitoring frequency</a> recommendation
as metric collection.</p>
<p>Earlier versions of RabbitMQ used an <a href="#deprecations">intrusive health check</a> that has since been deprecated
and should be avoided. Use one of the checks covered in this section (or their combination).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-1">Stage 1<a href="#stage-1" class="hash-link" aria-label="Direct link to Stage 1" title="Direct link to Stage 1">​</a></h4>
<p>The most basic check ensures that the <a href="/rabbitmq-website/docs/next/runtime">runtime</a> is running
and (indirectly) that CLI tools can <a href="/rabbitmq-website/docs/next/cli#erlang-cookie">authenticate</a> with it.</p>
<p>Except for the CLI tool authentication
part, the probability of false positives can be considered approaching <code>0</code>
except for upgrades and maintenance windows.</p>
<p><a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics ping</code></a> performs this check:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Ping succeeded if exit code is 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-2">Stage 2<a href="#stage-2" class="hash-link" aria-label="Direct link to Stage 2" title="Direct link to Stage 2">​</a></h4>
<p>A slightly more comprehensive check is executing <a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics status</code></a> status:</p>
<p>This includes the stage 1 check plus retrieves some essential
system information which is useful for other checks and should always be
available if RabbitMQ is running on the node (see below).</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; [output elided for brevity]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is a common way of confidence checking a node.
The probability of false positives can be considered approaching <code>0</code>
except for upgrades and maintenance windows.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-3">Stage 3<a href="#stage-3" class="hash-link" aria-label="Direct link to Stage 3" title="Direct link to Stage 3">​</a></h4>
<p>Includes previous checks and also verifies that the RabbitMQ application is running
(not stopped with <a href="/rabbitmq-website/docs/next/man/rabbitmqctl.8#stop_app"><code>rabbitmqctl stop_app</code></a>
or the <a href="/rabbitmq-website/docs/next/partitions">Pause Minority partition handling strategy</a>)
and there are no resource alarms.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># lists alarms in effect across the cluster, if any</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> alarms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics check_running</code></a> is a check that makes sure that the runtime is running
and the RabbitMQ application on it is not stopped or paused.</p>
<p><a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics check_local_alarms</code></a> checks that there are no local alarms in effect
on the node. If there are any, it will exit with a non-zero status.</p>
<p>The two commands in combination deliver the stage 3 check:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> check_running </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> check_local_alarms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># if both checks succeed, the exit code will be 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The probability of false positives is low. Systems hovering around their
<a href="/rabbitmq-website/docs/next/alarms">high runtime memory watermark</a> will have a high probability of false positives.
During upgrades and maintenance windows can raise significantly.</p>
<p>Specifically for memory alarms, the <code>GET /api/nodes/{node}/memory</code> HTTP API endpoint can be used for additional checks.
In the following example its output is piped to <a href="https://stedolan.github.io/jq/manual/" target="_blank" rel="noopener noreferrer">jq</a>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--silent</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> guest:guest </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> GET http://127.0.0.1:15672/api/nodes/rabbit@hostname/memory </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;     &quot;memory&quot;: {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;connection_readers&quot;: 24100480,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;connection_writers&quot;: 1452000,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;connection_channels&quot;: 3924000,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;connection_other&quot;: 79830276,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;queue_procs&quot;: 17642024,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;plugins&quot;: 63119396,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;other_proc&quot;: 18043684,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;metrics&quot;: 7272108,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;mgmt_db&quot;: 21422904,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;mnesia&quot;: 1650072,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;other_ets&quot;: 5368160,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;binary&quot;: 4933624,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;msg_index&quot;: 31632,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;code&quot;: 24006696,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;atom&quot;: 1172689,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;other_system&quot;: 26788975,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;allocated_unused&quot;: 82315584,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;reserved_unallocated&quot;: 0,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;strategy&quot;: &quot;rss&quot;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         &quot;total&quot;: {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;             &quot;erlang&quot;: 300758720,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;             &quot;rss&quot;: 342409216,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;             &quot;allocated&quot;: 383074304</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;         }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt;     }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <a href="/rabbitmq-website/docs/next/memory-use">breakdown information</a> it produces can be reduced down to a single value using <a href="https://stedolan.github.io/jq/manual/" target="_blank" rel="noopener noreferrer">jq</a>
or similar tools:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--silent</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> guest:guest </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> GET http://127.0.0.1:15672/api/nodes/rabbit@hostname/memory </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jq </span><span class="token string" style="color:#e3116c">&quot;.memory.total.allocated&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; 397365248</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics -q memory_breakdown</code></a> provides access to the same per category data
and supports various units:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> memory_breakdown </span><span class="token parameter variable" style="color:#36acaa">--unit</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; connection_other: 50.18 mb (22.1%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; allocated_unused: 43.7058 mb (19.25%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; other_proc: 26.1082 mb (11.5%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; other_system: 26.0714 mb (11.48%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; connection_readers: 22.34 mb (9.84%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; code: 20.4311 mb (9.0%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; queue_procs: 17.687 mb (7.79%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; other_ets: 4.3429 mb (1.91%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; connection_writers: 4.068 mb (1.79%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; connection_channels: 4.012 mb (1.77%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; metrics: 3.3802 mb (1.49%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; binary: 1.992 mb (0.88%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; mnesia: 1.6292 mb (0.72%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; atom: 1.0826 mb (0.48%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; msg_index: 0.0317 mb (0.01%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; plugins: 0.0119 mb (0.01%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; mgmt_db: 0.0 mb (0.0%)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; reserved_unallocated: 0.0 mb (0.0%)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-4">Stage 4<a href="#stage-4" class="hash-link" aria-label="Direct link to Stage 4" title="Direct link to Stage 4">​</a></h4>
<p>Includes all checks in stage 3 plus a check on all enabled listeners
(using a temporary TCP connection).</p>
<p>To inspect all listeners enabled on a node, use <a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics listeners</code></a>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> listeners </span><span class="token parameter variable" style="color:#36acaa">--node</span><span class="token plain"> rabbit@target-hostname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Interface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Interface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Interface: [::], port: 5671, protocol: amqp/ssl, purpose: AMQP 0-9-1 and AMQP 1.0 over TLS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Interface: [::], port: 15672, protocol: http, purpose: HTTP API</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># =&gt; Interface: [::], port: 15671, protocol: https, purpose: HTTP API over TLS (HTTPS)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics check_port_connectivity [--address &lt;address&gt;]</code></a> is a command that
performs the basic TCP connectivity check mentioned above:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># This check will try to open a TCP connection to the discovered listener ports.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Since nodes can be configured to listen to specific interfaces, an --address should</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># be provided, or CLI tools will have to rely on the configured hostname resolver to know where to connect.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> check_port_connectivity </span><span class="token parameter variable" style="color:#36acaa">--node</span><span class="token plain"> rabbit@target-hostname </span><span class="token parameter variable" style="color:#36acaa">--address</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ip-address-to-connect-to</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If the check succeeds, the exit code will be 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The probability of false positives is generally low but during upgrades and
maintenance windows can raise significantly.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-5">Stage 5<a href="#stage-5" class="hash-link" aria-label="Direct link to Stage 5" title="Direct link to Stage 5">​</a></h4>
<p>Includes all checks in stage 4 plus checks that there are no failed <a href="/rabbitmq-website/docs/next/vhosts">virtual hosts</a>.</p>
<p><a href="/rabbitmq-website/docs/next/man/rabbitmq-diagnostics.8"><code>rabbitmq-diagnostics check_virtual_hosts</code></a> is a command
checks whether any virtual host dependencies may have failed. This is done for all
virtual hosts.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> check_virtual_hosts </span><span class="token parameter variable" style="color:#36acaa">--node</span><span class="token plain"> rabbit@target-hostname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># if the check succeeded, exit code will be 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The probability of false positives is generally low except for systems that are under
high CPU load.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="readiness-probes">Health Checks as Readiness Probes<a href="#readiness-probes" class="hash-link" aria-label="Direct link to Health Checks as Readiness Probes" title="Direct link to Health Checks as Readiness Probes">​</a></h3>
<p>In some environments, node restarts are controlled with a designated <a href="/rabbitmq-website/docs/next/monitoring#health-checks">health check</a>.
The checks verify that one node has started and the deployment process can proceed to the next one.
If the check does not pass, the deployment of the node is considered to be incomplete and the deployment process
will typically wait and retry for a period of time. One popular example of such environment is Kubernetes
where an operator-defined <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-readiness-gate" target="_blank" rel="noopener noreferrer">readiness probe</a>
can prevent a deployment from proceeding when the <a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#deployment-and-scaling-guarantees" target="_blank" rel="noopener noreferrer"><code>OrderedReady</code> pod management policy</a>
is used (which is not recommended to use with RabbitMQ!) or when a rolling restart is performed.</p>
<p>Given the <a href="/rabbitmq-website/docs/next/clustering#restarting-schema-sync">peer syncing behavior during node restarts</a>, such a health check can prevent a cluster-wide restart
from completing in time. Checks that explicitly or implicitly assume a fully booted node that&#x27;s rejoined
its cluster peers will fail and block further node deployments.</p>
<p>Moreover, most CLI commands (such as <code>rabbitmq-diagnostics</code>) has a performance impact because the CLI joins the <a href="https://www.erlang.org/doc/reference_manual/./distributed" target="_blank" rel="noopener noreferrer">Erlang
distribution</a> (the same mechanism used for clustering RabbitMQ nodes).
Joining and leaving this cluster on every probe execution has unnecessary overhead.</p>
<p><a href="/rabbitmq-website/kubernetes/operator/operator-overview">RabbitMQ Kubernetes Operator</a> configures a TCP port check on the AMQP port
as the <code>readinessProbe</code> and defines no <code>livenessProbe</code> at all. This should be considered the best practice.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="clusters">Monitoring of Clusters<a href="#clusters" class="hash-link" aria-label="Direct link to Monitoring of Clusters" title="Direct link to Monitoring of Clusters">​</a></h2>
<p>Monitoring a single node is easy and straightforward.</p>
<p>When monitoring clusters it is important to understand the guarantees provided by API endpoints used.
In a clustered environment every node can serve metric endpoint requests. In addition, some metrics
are node-specific while others are cluster-wide.</p>
<p>Every node provides access to <a href="#node-metrics">node-specific metrics</a>
for itself. Like with <a href="#system-metrics">infrastructure and OS metrics</a>,
node-specific metrics must be collected for each cluster node.</p>
<p>Prometheus and management plugin API endpoints have important differences when it comes to
what metrics they serve and how cluster-wide metrics are aggregated.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prometheus">Prometheus<a href="#prometheus" class="hash-link" aria-label="Direct link to Prometheus" title="Direct link to Prometheus">​</a></h3>
<p>With the Prometheus pluginm every node provides access to <a href="#node-metrics">node-specific metrics</a>.
Prometheus queries the metric endpoint, <code>{hostname}:15692/metrics</code>, and stores the results.
Cluster-wide metrics are then computed from this node-specific data.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="management-plugin">Management Plugin<a href="#management-plugin" class="hash-link" aria-label="Direct link to Management Plugin" title="Direct link to Management Plugin">​</a></h3>
<p>With management plugin, every node provides access to <a href="#node-metrics">node-specific metrics</a>
for itself as well as other cluster nodes.</p>
<p>Cluster-wide metrics can be fetched from any node that <a href="/rabbitmq-website/docs/next/management#clustering">can contact its peers</a>.
That node will collect and combine data from its peers as needed before producing a response.</p>
<p>With management plugin, inter-node connectivity issues will <a href="/rabbitmq-website/docs/next/management#clustering">affect HTTP API behaviour</a>.
Choose a random online node for monitoring requests.
For example, using a load balancer or <a href="https://en.wikipedia.org/wiki/Round-robin_DNS" target="_blank" rel="noopener noreferrer">round-robin DNS</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deprecations">Deprecated Health Checks and Monitoring Features<a href="#deprecations" class="hash-link" aria-label="Direct link to Deprecated Health Checks and Monitoring Features" title="Direct link to Deprecated Health Checks and Monitoring Features">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="legacy-intrusive-health-check">Legacy Intrusive Health Check<a href="#legacy-intrusive-health-check" class="hash-link" aria-label="Direct link to Legacy Intrusive Health Check" title="Direct link to Legacy Intrusive Health Check">​</a></h3>
<p>Earlier versions of RabbitMQ provided a single opinionated and intrusive health check command (and its respective HTTP API endpoint):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># DO NOT USE: this health check is long deprecated and in modern versions it is a no-op</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics node_health_check</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The above command is <strong>deprecated</strong> will be <strong>removed in a future version</strong> of RabbitMQ and is to be avoided.
Systems that use it should adopt one of the <a href="#health-checks">fine grained modern health checks</a> instead.</p>
<p>The above check forced every connection, queue leader replica, and channel in the system to emit certain metrics.
With a large number of concurrent connections and queues, this can be very resource-intensive and too likely
to produce false positives.</p>
<p>The above check is also not suitable to be used as a <a href="#readiness-probes">readiness probe</a> as it implicitly
assumes a fully booted node.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-tools">Monitoring Tools<a href="#monitoring-tools" class="hash-link" aria-label="Direct link to Monitoring Tools" title="Direct link to Monitoring Tools">​</a></h2>
<p>The following is an alphabetised list of third-party tools commonly used to collect RabbitMQ metrics. These
tools vary in capabilities but usually can collect both <a href="#system-metrics">infrastructure-level</a> and
<a href="#rabbitmq-metrics">RabbitMQ metrics</a>.</p>
<p>Note that this list is by no means complete.</p>
<table><thead><tr><td>Monitoring Tool</td><td>Online Resource(s)</td></tr></thead><tbody><tr><td>AppDynamics</td><td><p><a href="https://www.appdynamics.com/community/exchange/extension/rabbitmq-monitoring-extension/">AppDynamics</a>,
<a href="https://github.com/Appdynamics/rabbitmq-monitoring-extension">GitHub</a></p></td></tr><tr><td>AWS CloudWatch</td><td><a href="https://github.com/noxdafox/rabbitmq-cloudwatch-exporter">GitHub</a></td></tr><tr><td>collectd</td><td><a href="https://github.com/signalfx/collectd-rabbitmq">GitHub</a></td></tr><tr><td>DataDog</td><td><p><a href="https://docs.datadoghq.com/integrations/rabbitmq/">DataDog RabbitMQ integration</a>,
<a href="https://github.com/DataDog/integrations-core/tree/master/rabbitmq">GitHub</a></p></td></tr><tr><td>Dynatrace</td><td><a href="https://www.dynatrace.com/technologies/rabbitmq-monitoring/">Dynatrace RabbitMQ monitoring</a></td></tr><tr><td>Ganglia</td><td><a href="https://github.com/ganglia/gmond_python_modules/tree/master/rabbit">GitHub</a></td></tr><tr><td>Graphite</td><td><a href="http://graphite.readthedocs.io/en/latest/tools.html">Tools that work with Graphite</a></td></tr><tr><td>Munin</td><td><p><a href="http://munin-monitoring.org/">Munin docs</a>,
<a href="https://github.com/ask/rabbitmq-munin">GitHub</a></p></td></tr><tr><td>Nagios</td><td><a href="https://github.com/nagios-plugins-rabbitmq/nagios-plugins-rabbitmq">GitHub</a></td></tr><tr><td>Nastel AutoPilot</td><td><a href="https://www.nastel.com/rabbitmq/">Nastel RabbitMQ Solutions</a></td></tr><tr><td>New Relic</td><td><a href="https://newrelic.com/instant-observability/rabbitmq">New Relic RabbitMQ monitoring</a></td></tr><tr><td>Prometheus</td><td><p><a href="./prometheus">Prometheus guide</a>,
<a href="https://github.com/rabbitmq/rabbitmq-prometheus">GitHub</a></p></td></tr><tr><td>Sematext</td><td><p><a href="https://sematext.com/docs/integration/rabbitmq/">Sematext RabbitMQ monitoring integration</a>,
<a href="https://sematext.com/docs/integration/rabbitmq-logs/">Sematext RabbitMQ logs integration</a></p></td></tr><tr><td>Zabbix</td><td><a href="https://git.zabbix.com/projects/ZBX/repos/zabbix/browse/templates/app/rabbitmq_http">Zabbix by HTTP</a>,
<a href="https://git.zabbix.com/projects/ZBX/repos/zabbix/browse/templates/app/rabbitmq_agent">Zabbix by Agent</a>,
<a href="http://blog.thomasvandoren.com/monitoring-rabbitmq-queues-with-zabbix.html">Blog article</a></td></tr><tr><td>Zenoss</td><td><p><a href="https://www.zenoss.com/product/zenpacks/rabbitmq">RabbitMQ ZenPack</a>,
<a href="http://www.youtube.com/watch?v=CAak2ayFcV0">Instructional Video</a></p></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-aggregation">Log Aggregation<a href="#log-aggregation" class="hash-link" aria-label="Direct link to Log Aggregation" title="Direct link to Log Aggregation">​</a></h2>
<p><a href="/rabbitmq-website/docs/next/logging">Logs</a> are also very important in troubleshooting a distributed system. Like metrics, logs can provide
important clues that will help identify the root cause. Collect logs from all RabbitMQ nodes as well
as all applications (if possible).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rabbitmq/rabbitmq-website/tree/main/docs/monitoring/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rabbitmq-website/docs/next/troubleshooting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Troubleshooting RabbitMQ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rabbitmq-website/docs/next/prometheus"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Prometheus and Grafana</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#fundamentals" class="table-of-contents__link toc-highlight">What is Monitoring?</a><ul><li><a href="#health-checks-role-in-monitoring" class="table-of-contents__link toc-highlight">Health Checks&#39; Role in Monitoring</a></li><li><a href="#system-and-rabbitmq-metrics" class="table-of-contents__link toc-highlight">System and RabbitMQ Metrics</a></li><li><a href="#system-metrics" class="table-of-contents__link toc-highlight">Infrastructure and Kernel Metrics</a></li></ul></li><li><a href="#with-prometheus" class="table-of-contents__link toc-highlight">Monitoring with Prometheus-compatible Tools</a><ul><li><a href="#how-to-enable-it" class="table-of-contents__link toc-highlight">How to Enable It</a></li><li><a href="#http-api-endpoint" class="table-of-contents__link toc-highlight">HTTP API Endpoint</a></li></ul></li><li><a href="#with-management" class="table-of-contents__link toc-highlight">Monitoring using Management Plugin</a><ul><li><a href="#how-to-enable-it-1" class="table-of-contents__link toc-highlight">How to Enable It</a></li><li><a href="#http-api-endpoint-1" class="table-of-contents__link toc-highlight">HTTP API Endpoint</a></li></ul></li><li><a href="#on-kubernetes" class="table-of-contents__link toc-highlight">Monitoring of Kubernetes Operator-deployed Clusters</a></li><li><a href="#with-cli-observer" class="table-of-contents__link toc-highlight">Interactive Command Line-Based Observer Tool</a></li><li><a href="#overhead" class="table-of-contents__link toc-highlight">Resource Use and Overhead of Monitoring</a><ul><li><a href="#monitoring-frequency" class="table-of-contents__link toc-highlight">Frequency of Monitoring</a></li></ul></li><li><a href="#rabbitmq-metrics" class="table-of-contents__link toc-highlight">RabbitMQ Metrics</a><ul><li><a href="#cluster-wide-metrics" class="table-of-contents__link toc-highlight">Cluster-wide Metrics</a></li><li><a href="#node-metrics" class="table-of-contents__link toc-highlight">Node Metrics</a></li><li><a href="#queue-metrics" class="table-of-contents__link toc-highlight">Individual Queue Metrics</a></li></ul></li><li><a href="#app-metrics" class="table-of-contents__link toc-highlight">Application-level Metrics</a></li><li><a href="#health-checks" class="table-of-contents__link toc-highlight">Health Checks</a><ul><li><a href="#individual-checks" class="table-of-contents__link toc-highlight">Individual Node Checks</a></li><li><a href="#readiness-probes" class="table-of-contents__link toc-highlight">Health Checks as Readiness Probes</a></li></ul></li><li><a href="#clusters" class="table-of-contents__link toc-highlight">Monitoring of Clusters</a><ul><li><a href="#prometheus" class="table-of-contents__link toc-highlight">Prometheus</a></li><li><a href="#management-plugin" class="table-of-contents__link toc-highlight">Management Plugin</a></li></ul></li><li><a href="#deprecations" class="table-of-contents__link toc-highlight">Deprecated Health Checks and Monitoring Features</a><ul><li><a href="#legacy-intrusive-health-check" class="table-of-contents__link toc-highlight">Legacy Intrusive Health Check</a></li></ul></li><li><a href="#monitoring-tools" class="table-of-contents__link toc-highlight">Monitoring Tools</a></li><li><a href="#log-aggregation" class="table-of-contents__link toc-highlight">Log Aggregation</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn about RabbitMQ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Reach out to the RabbitMQ team</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rabbitmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/rabbitmq/rabbitmq-server/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact?utm_source=rmq_release-information_tableheader&amp;utm_medium=rmq_website&amp;utm_campaign=tanzu">Long Term Commercial Support</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact">Contact Us</a></li><li class="footer__item"><a href="https://www.rabbitmq.com/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Broadcom</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tanzu.vmware.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VMware Tanzu<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/legal.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/trademark-guidelines">Trademark Guidelines</a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy/california-privacy-rights.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Your California Privacy Rights<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item ot-sdk-show-settings">Cookie Settings</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2005-2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div>
</body>
</html>