<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-4.1 docs-doc-page docs-doc-id-networking" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Networking and RabbitMQ | RabbitMQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" name="twitter:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" property="og:url" content="https://www.rabbitmq.com/rabbitmq-website/docs/networking"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="4.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-4.1"><meta data-rh="true" name="docsearch:version" content="4.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-4.1"><meta data-rh="true" property="og:title" content="Networking and RabbitMQ | RabbitMQ"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/rabbitmq-website/img/rabbitmq-logo.svg"><link data-rh="true" rel="canonical" href="https://www.rabbitmq.com/rabbitmq-website/docs/networking"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/networking" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/docs/networking" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://H10VQIW16Y-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rabbitmq-website/blog/rss.xml" title="RabbitMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rabbitmq-website/blog/atom.xml" title="RabbitMQ Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="RabbitMQ" href="/rabbitmq-website/opensearch.xml">







<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,700">
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-domain-script="018ee308-473e-754f-b0c2-cbe82d25512f"></script>
<script>function OptanonWrapper(){}</script>
<script>function setGTM(e,t,o,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=t.getElementsByTagName(o)[0],a=t.createElement(o),s="dataLayer"!=n?"&l="+n:"";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+r+s,i.parentNode.insertBefore(a,i)}var timer;function waitForOnetrustActiveGroups(){document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?(clearTimeout(timer),setGTM(window,document,"script","dataLayer","GTM-TT84L8K")):timer=setTimeout(waitForOnetrustActiveGroups,250)}document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?setGTM(window,document,"script","dataLayer","GTM-TT84L8K"):waitForOnetrustActiveGroups()</script><link rel="stylesheet" href="/rabbitmq-website/styles.css">
<script src="/rabbitmq-website/runtime~main.js" defer="defer"></script>
<script src="/rabbitmq-website/main.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:var(--ifm-color-primary-contrast-background);color:var(--ifm-font-color-base)" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong style="font-size: var(--ifm-h4-font-size);"><a href="https://github.com/rabbitmq/rabbitmq-server/releases/tag/v4.1.0">RabbitMQ 4.1.0 is out</a></strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rabbitmq-website/"><div class="navbar__logo"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/rabbitmq-website/tutorials">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rabbitmq-website/docs">Docs</a><a class="navbar__item navbar__link" href="/rabbitmq-website/blog">Blog</a><a class="navbar__item navbar__link" href="/rabbitmq-website/contact">Support</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/rabbitmq-website/docs/networking">4.1</a><ul class="dropdown__menu"><li class=""><strong>Release series</strong></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/next/networking">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/rabbitmq-website/docs/networking">4.1</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/4.0/networking">4.0</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/3.13/networking">3.13</a></li><li><a href="https://v3-12.rabbitmq.com/documentation.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/rabbitmq-website/release-information">Release Information</a></li></ul></div><a href="https://github.com/rabbitmq/rabbitmq-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/release-information">Release Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/download">Install and Upgrade</a><button aria-label="Expand sidebar category &#x27;Install and Upgrade&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/use-rabbitmq">How to Use RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Use RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/rabbitmq-website/docs/manage-rabbitmq">How to Manage RabbitMQ</a><button aria-label="Collapse sidebar category &#x27;How to Manage RabbitMQ&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/cli">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/configure">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/relocate">File and Directory Locations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/logging">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/vhosts">Virtual Hosts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/access-control"> Authentication and Authorization</a><button aria-label="Expand sidebar category &#x27; Authentication and Authorization&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/parameters">Policies and Runtime Parameters</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/metadata-store">Metadata store</a><button aria-label="Expand sidebar category &#x27;Metadata store&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/definitions">Schema Definitions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/rabbitmq-website/docs/networking">Networking</a><button aria-label="Collapse sidebar category &#x27;Networking&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/nettick">Net Tick Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/ssl">TLS Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/troubleshooting-networking">Troubleshooting Connectivity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/troubleshooting-ssl">Troubleshooting TLS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/rabbitmq-website/docs/clustering">Clustering</a><button aria-label="Expand sidebar category &#x27;Clustering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/rabbitmq-website/docs/memory-use">Resource Management</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/backup">Backup and Restore</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/rabbitmq-website/docs/runtime">Tuning</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/production-checklist">Deployment Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/kubernetes/operator/operator-overview">RabbitMQ on Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rabbitmq-website/docs/troubleshooting">Troubleshooting RabbitMQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/rabbitmq-website/docs/monitoring">How to Monitor RabbitMQ</a><button aria-label="Expand sidebar category &#x27;How to Monitor RabbitMQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/rabbitmq-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/rabbitmq-website/docs/manage-rabbitmq"><span itemprop="name">How to Manage RabbitMQ</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Networking</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Networking and RabbitMQ</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>Clients communicate with RabbitMQ over the network. All
protocols supported by the broker are TCP-based. Both
RabbitMQ and the operating system provide a number
of knobs that can be tweaked. Some of them are directly
related to TCP and IP operations, others have to do with
application-level protocols such as TLS. This guide covers
multiple topics related to networking in the context of
RabbitMQ.</p>
<p>Some tuneable parameters discussed are OS-specific. This guide focuses on Linux when
covering OS-specific subjects, as it is the most common
platform RabbitMQ is deployed on.</p>
<p>Networking is a very broad topic. Therefore, this guide covers multiple topics,
such as</p>
<ul>
<li><a href="#interfaces">Interfaces</a> the node listens on for client connections</li>
<li>IP version preferences: <a href="#dual-stack">dual stack</a>, <a href="#single-stack-ipv6">IPv6-only</a> and <a href="#single-stack-ipv4">IPv4-only</a></li>
<li><a href="#ports">Ports</a> used by clients, <a href="#distribution-port-range">inter-node traffic</a> in clusters and <a href="/rabbitmq-website/docs/cli">CLI tools</a></li>
<li><a href="#distribution-ipv6">IPv6 support</a> for inter-node traffic</li>
<li><a href="#tls-support">TLS</a> for client connections</li>
<li>Tuning for a <a href="#tuning-for-large-number-of-connections">large number of concurrent connections</a></li>
<li><a href="#dealing-with-high-connection-churn">High client connection churn</a> scenarios and resource exhaustion</li>
<li>TCP buffer size (affects <a href="#tuning-for-throughput-tcp-buffers">throughput</a> and <a href="#tuning-for-large-number-of-connections-tcp-buffer-size">how much memory is used per connection</a>)</li>
<li><a href="#dns">Hostname resolution</a>-related topics such as <a href="#dns-reverse-dns-lookups">reverse DNS lookups</a></li>
<li><a href="#distribution">Inter-node communication</a> interface and port</li>
<li><a href="#epmd">epmd</a> and what role it plays in inter-node communication</li>
<li>How to <a href="#listener-suspension">suspend and resume listeners</a> to temporarily stop and resume new client connections</li>
<li>Other TCP socket settings</li>
<li><a href="#proxy-protocol">Proxy protocol</a> support for client connections</li>
<li>Kernel TCP settings and limits (e.g. <a href="#tcp-keepalives">TCP keepalives</a> and <a href="#open-file-handle-limit">open file handle limit</a>)</li>
<li>How to allow Erlang runtime to accept inbound connections
when <a href="#firewalls-mac-os">MacOS Application Firewall</a> is enabled</li>
<li><a href="#os-tuning">OS-level tuning</a> related to networking</li>
</ul>
<p>Except for OS kernel parameters and DNS, all RabbitMQ settings
are <a href="/rabbitmq-website/docs/configure">configured via RabbitMQ configuration file(s)</a>.</p>
<p>Networking is a broad topic. There are many configuration options
that can have positive or negative effect on certain workloads.
As such, this guide does not try to be a complete reference but rather
offer an index of key tunable parameters and serve as a starting
point.</p>
<p>In addition, this guide touches on a few topics closely related to networking,
such as</p>
<ul>
<li>Hostnames, <a href="#dns">hostname resolution and DNS</a></li>
<li><a href="#logging">connection lifecycle logging</a></li>
<li><a href="#heartbeats">Heartbeats</a> (a.k.a. keepalives)</li>
<li><a href="#intermediaries">proxies and load balancers</a></li>
</ul>
<p><a href="https://docs.vmware.com/en/VMware-RabbitMQ-for-Kubernetes/index.html" target="_blank" rel="noopener noreferrer">VMware Tanzu RabbitMQ</a> commercial offerings provide an <a href="https://docs.vmware.com/en/VMware-Tanzu-RabbitMQ-for-Kubernetes/3.13/tanzu-rabbitmq-kubernetes/clustering-compression-rabbitmq.html" target="_blank" rel="noopener noreferrer">Intra-cluster Compression</a> feature. The previous documentation link goes to the Tanzu RabbitMQ for Kubernetes commercial offering.</p>
<p>A methodology for <a href="/rabbitmq-website/docs/troubleshooting-networking">troubleshooting of networking-related issues</a>
is covered in a separate guide.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="interfaces">Network Interfaces for Client Connections<a href="#interfaces" class="hash-link" aria-label="Direct link to Network Interfaces for Client Connections" title="Direct link to Network Interfaces for Client Connections">​</a></h2>
<p>For RabbitMQ to accept client connections, it needs to bind to one or more
interfaces and listen on (protocol-specific) ports. One such interface/port pair is called a listener
in RabbitMQ parlance. Listeners are configured using the <code>listeners.tcp.*</code> configuration option(s).</p>
<p>TCP listeners configure both an interface and port. The following example
demonstrates how to configure AMQP 0-9-1 and AMQP 1.0 listener to use a specific IP and the standard port:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.1 = 192.168.1.99:5672</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default, RabbitMQ will listen on port 5672 on <strong>all available interfaces</strong>. It is possible to
limit client connections to a subset of the interfaces or even just one, for example, IPv6-only
interfaces. The following few sections demonstrate how to do it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dual-stack">Listening on Dual Stack (Both IPv4 and IPv6) Interfaces<a href="#dual-stack" class="hash-link" aria-label="Direct link to Listening on Dual Stack (Both IPv4 and IPv6) Interfaces" title="Direct link to Listening on Dual Stack (Both IPv4 and IPv6) Interfaces">​</a></h3>
<p>The following example demonstrates how to configure RabbitMQ
to listen on localhost only for both IPv4 and IPv6:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.1 = 127.0.0.1:5672</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.2 = ::1:5672</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With modern Linux kernels and Windows releases,
when a port is specified and RabbitMQ is configured to
listen on all IPv6 addresses but IPv4 is not deactivated
explicitly, IPv4 address will be included, so</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.1 = :::5672</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>is equivalent to</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.1 = 0.0.0.0:5672</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.2 = :::5672</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="single-stack-ipv6">Listening on IPv6 Interfaces Only<a href="#single-stack-ipv6" class="hash-link" aria-label="Direct link to Listening on IPv6 Interfaces Only" title="Direct link to Listening on IPv6 Interfaces Only">​</a></h3>
<p>In this example RabbitMQ will listen on an IPv6 interface only:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.1 = fe80::2acf:e9ff:fe17:f97b:5672</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In IPv6-only environments the node must also be configured
to <a href="#distribution-ipv6">use IPv6 for inter-node communication and CLI tool connections</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="single-stack-ipv4">Listening on IPv4 Interfaces Only<a href="#single-stack-ipv4" class="hash-link" aria-label="Direct link to Listening on IPv4 Interfaces Only" title="Direct link to Listening on IPv4 Interfaces Only">​</a></h3>
<p>In this example RabbitMQ will listen on an IPv4 interface with specified IP address only:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp.1 = 192.168.1.99:5672 # Plain AMQP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listeners.ssl.1 = 192.168.1.99:5671 # TLS (AMQPS)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It is possible to deactivate non-TLS connections by deactivating all regular TCP listeners.
Only <a href="/rabbitmq-website/docs/ssl">TLS-enabled</a> clients will be able to connect:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># deactivates non-TLS listeners, only TLS-enabled (activated) clients will be able to connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listeners.tcp = none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listeners.ssl.default = 5671</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_options.cacertfile = /path/to/ca_certificate.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_options.certfile   = /path/to/server_certificate.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_options.keyfile    = /path/to/server_key.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_options.verify     = verify_peer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_options.fail_if_no_peer_cert = false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ports">Port Access<a href="#ports" class="hash-link" aria-label="Direct link to Port Access" title="Direct link to Port Access">​</a></h2>
<p>RabbitMQ nodes bind to ports (open server TCP sockets) in order to accept client and CLI tool connections.
Other processes and tools such as SELinux may prevent RabbitMQ from binding to a port. When that happens,
the node will fail to start.</p>
<p>CLI tools, client libraries and RabbitMQ nodes also open connections (client TCP sockets).
Firewalls can prevent nodes and CLI tools from communicating with each other.
Make sure the following ports are accessible:</p>
<ul>
<li>4369: <a href="http://erlang.org/doc/man/epmd.html" target="_blank" rel="noopener noreferrer">epmd</a>, a peer discovery service used by RabbitMQ nodes and CLI tools</li>
<li>5672, 5671: used by AMQP 0-9-1 and AMQP 1.0 clients without and with TLS</li>
<li>5552, 5551: used by the <a href="/rabbitmq-website/docs/streams">RabbitMQ Stream protocol</a> clients without and with TLS</li>
<li>6000 through 6500: used for <a href="/rabbitmq-website/docs/streams">stream</a> replication</li>
<li>25672: used for inter-node and CLI tools communication (Erlang distribution server port)
and is allocated from a dynamic range (limited to a single port by default,
computed as AMQP port + 20000). Unless external connections on these ports are really necessary (e.g.
the cluster uses <a href="/rabbitmq-website/docs/federation">federation</a> or CLI tools are used on machines outside the subnet),
these ports should not be publicly exposed</li>
<li>35672-35682: this client TCP port range is used by CLI tools for <a href="#distribution">communication with nodes</a>.
By default, the range computed as <code>(server distribution port + 10000)</code> through <code>(server distribution port + 10010)</code></li>
<li>15672, 15671: <a href="/rabbitmq-website/docs/management">HTTP API</a> clients, <a href="/rabbitmq-website/docs/management">management UI</a> and <a href="/rabbitmq-website/docs/management-cli">rabbitmqadmin</a>, without and with TLS
(only if the <a href="/rabbitmq-website/docs/management">management plugin</a> is enabled)</li>
<li>61613, 61614: <a href="https://stomp.github.io/stomp-specification-1.2.html" target="_blank" rel="noopener noreferrer">STOMP clients</a> without and with TLS (only if the <a href="/rabbitmq-website/docs/stomp">STOMP plugin</a> is enabled)</li>
<li>1883, 8883: <a href="http://mqtt.org/" target="_blank" rel="noopener noreferrer">MQTT clients</a> without and with TLS, if the <a href="/rabbitmq-website/docs/mqtt">MQTT plugin</a> is enabled</li>
<li>15674: STOMP-over-WebSockets clients (only if the <a href="/rabbitmq-website/docs/web-stomp">Web STOMP plugin</a> is enabled)</li>
<li>15675: MQTT-over-WebSockets clients (only if the <a href="/rabbitmq-website/docs/web-mqtt">Web MQTT plugin</a> is enabled)</li>
<li>15692, 15691: Prometheus metrics, without and with TLS (only if the <a href="/rabbitmq-website/docs/prometheus">Prometheus plugin</a> is enabled)</li>
</ul>
<p>It is possible to <a href="/rabbitmq-website/docs/configure">configure RabbitMQ</a>
to use <a href="/rabbitmq-website/docs/networking">different ports and specific network interfaces</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="listener-suspension">How to Temporarily Stop New Client Connections<a href="#listener-suspension" class="hash-link" aria-label="Direct link to How to Temporarily Stop New Client Connections" title="Direct link to How to Temporarily Stop New Client Connections">​</a></h2>
<p>Client connection listeners can be <em>suspended</em> to prevent new client
connections from being accepted. Existing connections will not be affected in any way.</p>
<p>This can be useful during node operations and is one of the steps performed
when a node is <a href="/rabbitmq-website/docs/upgrade#maintenance-mode">put into maintenance mode</a>.</p>
<p>To suspend all listeners on a node and prevent new client connections to it, use <code>rabbitmqctl suspend_listeners</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl suspend_listeners</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As all other CLI commands, this command can be invoked against an arbitrary node (including remote ones)
using the <code>-n</code> switch:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># suspends listeners on node rabbit@node2.cluster.rabbitmq.svc: it won&#x27;t accept any new client connections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl suspend_listeners </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> rabbit@node2.cluster.rabbitmq.svc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To resume all listeners on a node and make it accept new client connections again, use <code>rabbitmqctl resume_listeners</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl resume_listeners</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># resumes listeners on node rabbit@node2.cluster.rabbitmq.svc: it will accept new client connections again</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl resume_listeners </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> rabbit@node2.cluster.rabbitmq.svc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Both operations will leave <a href="/rabbitmq-website/docs/logging">log entries</a> in the node&#x27;s log.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="epmd">EPMD and Inter-node Communication<a href="#epmd" class="hash-link" aria-label="Direct link to EPMD and Inter-node Communication" title="Direct link to EPMD and Inter-node Communication">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-epmd-and-how-is-it-used">What is EPMD and How is It Used?<a href="#what-is-epmd-and-how-is-it-used" class="hash-link" aria-label="Direct link to What is EPMD and How is It Used?" title="Direct link to What is EPMD and How is It Used?">​</a></h3>
<p><a href="http://www.erlang.org/doc/man/epmd.html" target="_blank" rel="noopener noreferrer">epmd</a> (for Erlang Port Mapping Daemon)
is a small additional daemon that runs alongside every RabbitMQ node and is used by
the <a href="/rabbitmq-website/docs/runtime">runtime</a> to discover what port a particular node listens on for
inter-node communication. The port is then used by peer nodes and <a href="/rabbitmq-website/docs/cli">CLI tools</a>.</p>
<p>When a node or CLI tool needs to contact node <code>rabbit@hostname2</code> it will do the following:</p>
<ul>
<li>Resolve <code>hostname2</code> to an IPv4 or IPv6 address using the standard OS resolver or a custom one specified in the <a href="http://erlang.org/doc/apps/erts/inet_cfg.html" target="_blank" rel="noopener noreferrer">inetrc file</a></li>
<li>Contact <code>epmd</code> running on <code>hostname2</code> using the above address</li>
<li>Ask <code>epmd</code> for the port used by node <code>rabbit</code> on it</li>
<li>Connect to the node using the resolved IP address and the discovered port</li>
<li>Proceed with communication</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="epmd-interface">EPMD Interface<a href="#epmd-interface" class="hash-link" aria-label="Direct link to EPMD Interface" title="Direct link to EPMD Interface">​</a></h3>
<p><code>epmd</code> will listen on all interfaces by default. It can
be limited to a number of interfaces using the <code>ERL_EPMD_ADDRESS</code>
environment variable:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># makes epmd listen on loopback IPv6 and IPv4 interfaces</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ERL_EPMD_ADDRESS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;::1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When <code>ERL_EPMD_ADDRESS</code> is changed, both RabbitMQ node and <code>epmd</code> on the host must be stopped.
For <code>epmd</code>, use</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Stops local epmd process.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use after shutting down RabbitMQ.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">epmd </span><span class="token parameter variable" style="color:#36acaa">-kill</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>to terminate it. The service will be started by the local RabbitMQ node automatically on boot.</p>
<p>The loopback interface will be implicitly added
to that list (in other words, <code>epmd</code> will always bind to the loopback interface).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="epmd-port">EPMD Port<a href="#epmd-port" class="hash-link" aria-label="Direct link to EPMD Port" title="Direct link to EPMD Port">​</a></h3>
<p>The default epmd port is 4369, but this can be changed using the <code>ERL_EPMD_PORT</code> environment
variable:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># makes epmd bind to port 4369</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ERL_EPMD_PORT</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;4369&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>All hosts in a <a href="/rabbitmq-website/docs/clustering">cluster</a> must use the same port.</p>
<p>When <code>ERL_EPMD_PORT</code> is changed, both RabbitMQ node and <code>epmd</code> on the host must be stopped.
For <code>epmd</code>, use</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Stops local epmd process.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Use after shutting down RabbitMQ.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">epmd </span><span class="token parameter variable" style="color:#36acaa">-kill</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>to terminate it. The service will be started by the local RabbitMQ node automatically on boot.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="distribution">Inter-node Communication<a href="#distribution" class="hash-link" aria-label="Direct link to Inter-node Communication" title="Direct link to Inter-node Communication">​</a></h2>
<p>RabbitMQ nodes will listen for inbound connections from peers and CLI tools.
It is important to only expose these ports to the hosts and subnets that
run other cluster nodes, or where CLI tools are used, and <a href="https://erlef.org/blog/eef/epmd-public-exposure" target="_blank" rel="noopener noreferrer">not exposed to the public Internet</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="distribution-interface">Inter-node Communication Interface<a href="#distribution-interface" class="hash-link" aria-label="Direct link to Inter-node Communication Interface" title="Direct link to Inter-node Communication Interface">​</a></h3>
<p>In order to configure the RabbitMQ inter-node communication listener to listen only
on a specific address, use <code>distribution.listener.interface</code> in <a href="/rabbitmq-website/docs/configure"><code>rabbitmq.conf</code></a>.</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Instructs the node to only listen for inter-node communication connections on a local interface.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This affects both connections from cluster peers and CLI tools.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distribution.listener.interface = 192.168.10.84</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Limit inter-node communication listener to a local interface (using an IPv4 address).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This particular configuration only makes sense for single-node clusters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For multi-node clusters, nodes must listen on an &quot;internal network-local&quot; interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># that would allow cluster peers to connect but not be exposed to the public Internet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distribution.listener.interface = 127.0.0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Limit inter-node communication listener to a local interface (using an IPv6 address).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This particular configuration only makes sense for single-node clusters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For multi-node clusters, nodes must listen on an &quot;internal network-local&quot; interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># that would allow cluster peers to connect but not be exposed to the public Internet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distribution.listener.interface = ::1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="distribution-port-range">Inter-node Communication Port Range<a href="#distribution-port-range" class="hash-link" aria-label="Direct link to Inter-node Communication Port Range" title="Direct link to Inter-node Communication Port Range">​</a></h3>
<p>RabbitMQ nodes will use a port from a certain range known as the inter-node communication port range.
The same port is used by CLI tools when they need to contact the node.
The range can be modified.</p>
<p>RabbitMQ nodes communicate with CLI tools and other nodes using a port known as
the <em>distribution port</em>. It is dynamically allocated from a range of values.
For RabbitMQ, the default range is limited to a single value computed as
<code>RABBITMQ_NODE_PORT</code> (AMQP 0-9-1 and AMQP 1.0 port) + 20000, which results
in using port 25672. This single port can be <a href="/rabbitmq-website/docs/configure">configured</a>
using the <code>RABBITMQ_DIST_PORT</code> environment variable.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>When configuring firewall rules, remote connections
on the inter-node communication port must be allowed from every cluster node&#x27;s IP address and every host where
CLI tools might be used</p></div></div>
<p>RabbitMQ <a href="/rabbitmq-website/docs/cli">command line tools</a> also use a range of ports. The default range is computed by taking the RabbitMQ
distribution port value and adding 10000 to it. The next 10 ports are also part
of this range. Thus, by default, this range is 35672 through 35682. This range
can be configured using the <code>RABBITMQ_CTL_DIST_PORT_MIN</code>
and <code>RABBITMQ_CTL_DIST_PORT_MAX</code> environment variables.
Note that limiting the range to a single port will prevent more than one CLI
tool from running concurrently on the same host and may affect CLI commands
that require parallel connections to multiple cluster nodes. A port range of 10
is therefore a recommended value.</p>
<p>When configuring firewall rules, remote connections
on the inter-node communication port must be allowed from every cluster node&#x27;s IP address and every host where
CLI tools might be used. epmd port must be open for CLI tools and clustering
to function.</p>
<p>On Windows, the following settings have no effect when RabbitMQ runs as a service.
Please see <a href="/rabbitmq-website/docs/windows-configuration">Windows Configuration</a> for details.</p>
<p>The range used by RabbitMQ can also be controlled via two configuration keys
in <code>rabbitmq.conf</code>:</p>
<ul>
<li><code>inet_dist_listen_min</code></li>
<li><code>inet_dist_listen_max</code></li>
</ul>
<p>They define the range&#x27;s lower and upper bounds, inclusive.</p>
<p>The example below uses a range with a single port but a value different from default:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">inet_dist_listen_min = 33672</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet_dist_listen_max = 33672</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To verify what port is used by a node for inter-node and CLI tool communication,
run</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">epmd </span><span class="token parameter variable" style="color:#36acaa">-names</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>on that node&#x27;s host. It will produce output that looks like this:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">epmd: up and running on port 4369 with data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name rabbit at port 25672</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="distribution-buffer-limit">Inter-node Communication Buffer Size Limit<a href="#distribution-buffer-limit" class="hash-link" aria-label="Direct link to Inter-node Communication Buffer Size Limit" title="Direct link to Inter-node Communication Buffer Size Limit">​</a></h3>
<p>Inter-node connections use a buffer for data pending to be sent. Temporary
throttling on inter-node traffic is applied when the buffer is at max allowed
capacity. The limit is controlled via the <code>RABBITMQ_DISTRIBUTION_BUFFER_SIZE</code>
<a href="/rabbitmq-website/docs/configure#supported-environment-variables">environment variable</a>
in kilobytes. Default value is 128 MB (<code>128000</code> kB).</p>
<p>In clusters with heavy inter-node traffic increasing this value may
have a positive effect on throughput. Values lower than 64 MB are not
recommended.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="distribution-ipv6">Using IPv6 for Inter-node Communication (and CLI Tools)<a href="#distribution-ipv6" class="hash-link" aria-label="Direct link to Using IPv6 for Inter-node Communication (and CLI Tools)" title="Direct link to Using IPv6 for Inter-node Communication (and CLI Tools)">​</a></h2>
<p>In addition to <a href="#single-stack-ipv6">exclusive IPv6 use for client connections</a> for client connections,
a node can also be configured to use IPv6 exclusively for inter-node and CLI tool connectivity.</p>
<p>This involves configuration in a few places:</p>
<ul>
<li>Inter-node communication protocol setting in the <a href="/rabbitmq-website/docs/runtime">runtime</a></li>
<li>Configuring IPv6 to be used by CLI tools</li>
<li><a href="#epmd">epmd</a>, a service involved in inter-node communication (discovery)</li>
</ul>
<p>It is possible to use IPv6 for inter-node and CLI tool communication but use IPv4 for client
connections or vice versa. Such configurations can be hard to troubleshoot and reason about,
so using the same IP version (e.g. IPv6) across the board or a dual stack setup is recommended.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inter-node-communication-protocol">Inter-node Communication Protocol<a href="#inter-node-communication-protocol" class="hash-link" aria-label="Direct link to Inter-node Communication Protocol" title="Direct link to Inter-node Communication Protocol">​</a></h3>
<p>To instruct the runtime to use IPv6 for inter-node communication and related tasks, use
the <code>RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS</code> environment variable to pass a couple of flags:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># these flags will be used by RabbitMQ nodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-kernel inetrc &#x27;/etc/rabbitmq/erl_inetrc&#x27; -proto_dist inet6_tcp&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># these flags will be used by CLI tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">RABBITMQ_CTL_ERL_ARGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-proto_dist inet6_tcp&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS</code> above uses two closely related flags:</p>
<ul>
<li><code>-kernel inetrc</code> to configure a path to an <a href="http://erlang.org/doc/apps/erts/inet_cfg.html" target="_blank" rel="noopener noreferrer">inetrc file</a>
that controls hostname resolution</li>
<li><code>-proto_dist inet6_tcp</code> to tell the node to use IPv6 when connecting to peer nodes and
listening for CLI tool connections</li>
</ul>
<p>The <code>erl_inetrc</code> file at <code>/etc/rabbitmq/erl_inetrc</code> will control hostname resolution settings.
For IPv6-only environments, it must include the following line:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">%% Tells DNS client on RabbitMQ nodes and CLI tools to resolve hostnames to IPv6 addresses.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%% The trailing dot is not optional.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">inet6,true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-tools">CLI Tools<a href="#cli-tools" class="hash-link" aria-label="Direct link to CLI Tools" title="Direct link to CLI Tools">​</a></h3>
<p>With CLI tools, use the same runtime flag as used for RabbitMQ nodes above but provide it
using a different environment variable, <code>RABBITMQ_CTL_ERL_ARGS</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">RABBITMQ_CTL_ERL_ARGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-proto_dist inet6_tcp&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that once instructed to use IPv6, CLI tools won&#x27;t be able to connect to nodes that
do not use IPv6 for inter-node communication. This involves the <code>epmd</code> service running on the same
host as target RabbitMQ node.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="epmd-and-inter-node-communication">epmd and Inter-node Communication<a href="#epmd-and-inter-node-communication" class="hash-link" aria-label="Direct link to epmd and Inter-node Communication" title="Direct link to epmd and Inter-node Communication">​</a></h3>
<p><code>epmd</code> is a small helper daemon that runs next to a RabbitMQ node and lets its peers and CLI
tools discover what port they should use to communicate to it. It can be configured to bind
to a specific interface, much like RabbitMQ listeners. This is done using the <code>ERL_EPMD_ADDRESS</code>
environment variable:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># instructs epmd to only listen on a local interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ERL_EPMD_ADDRESS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;::1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default RabbitMQ nodes will use an IPv4 interface when connecting to <code>epmd</code>.
Nodes that are <a href="#distribution-ipv6">configured to use IPv6</a> for inter-node communication
will also use IPv6 to connect to <code>epmd</code>.</p>
<p>When <code>epmd</code> is configured to use IPv6 exclusively but RabbitMQ nodes are not,
RabbitMQ will log an error message similar to this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Protocol </span><span class="token string" style="color:#e3116c">&#x27;inet_tcp&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> register/listen error: econnrefused</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In order to configure the RabbitMQ inter-node communication listener to listen only
on a specific address, use <code>distribution.listener.interface</code> in <a href="/rabbitmq-website/docs/configure"><code>rabbitmq.conf</code></a>.</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Instructs the node to only listen for inter-node communication connections on a local interface.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This affects both connections from cluster peers and CLI tools.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This particular configuration only makes sense for single-node clusters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For multi-node clusters, nodes must listen on an &quot;internal network-local&quot; interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># that would allow cluster peers to connect but not be exposed to the public Internet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distribution.listener.interface = ::1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="systemd-unit-file">systemd Unit File<a href="#systemd-unit-file" class="hash-link" aria-label="Direct link to systemd Unit File" title="Direct link to systemd Unit File">​</a></h4>
<p>On distributions that use systemd, the <code>epmd.socket</code> service controls network settings of <code>epmd</code>.
It is possible to configure <code>epmd</code> to only listen on IPv6 interfaces:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ListenStream=[::1]:4369</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The service will need reloading after its unit file has been updated:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart epmd.socket epmd.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="intermediaries">Intermediaries: Proxies and Load Balancers<a href="#intermediaries" class="hash-link" aria-label="Direct link to Intermediaries: Proxies and Load Balancers" title="Direct link to Intermediaries: Proxies and Load Balancers">​</a></h2>
<p>Proxies and load balancers are fairly commonly used to distribute client connections
between <a href="/rabbitmq-website/docs/clustering">cluster nodes</a>. Proxies can also be useful
to make it possible for clients to access RabbitMQ nodes without exposing them publicly.
Intermediaries can also have side effects on connections.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="proxy-effects">Proxy Effects<a href="#proxy-effects" class="hash-link" aria-label="Direct link to Proxy Effects" title="Direct link to Proxy Effects">​</a></h3>
<p>Proxies and load balancers introduce an extra network hop (or even multiple ones)
between client and its target node. Intermediaries also can become a network
contention point: their throughput will then become a limiting factor for the entire system.
Network bandwidth overprovisioning and throughput monitoring for proxies and load balancers
are therefore very important.</p>
<p>Intermediaries also may terminate &quot;idle&quot; TCP connections
when there&#x27;s no activity on them for a certain period of
time. Most of the time it is not desirable. Such events will result in
<a href="/rabbitmq-website/docs/logging#connection-lifecycle-events">abrupt connection closure log messages</a>
on the server end and I/O exceptions on the client end.</p>
<p>When <a href="/rabbitmq-website/docs/heartbeats">heartbeats</a> are enabled on a connection, it results in
periodic light network traffic. Therefore heartbeats have a side effect
of guarding client connections that can go idle for periods of
time against premature closure by proxies and load balancers.</p>
<p>Heartbeat timeouts from 10 to 30 seconds will produce periodic
network traffic often enough (roughly every 5 to 15 seconds)
to satisfy defaults of most proxy tools and load balancers.
Values that are too low will produce false positives.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="proxy-protocol">Proxy Protocol<a href="#proxy-protocol" class="hash-link" aria-label="Direct link to Proxy Protocol" title="Direct link to Proxy Protocol">​</a></h3>
<p>RabbitMQ supports <a href="http://www.haproxy.org/download/3.1/doc/proxy-protocol.txt" target="_blank" rel="noopener noreferrer">Proxy protocol</a>
versions 1 (text header format) and 2 (binary header format).</p>
<p>The protocol makes servers such as RabbitMQ aware of the actual client IP address
when connections go over a proxy (e.g. <a href="http://cbonte.github.io/haproxy-dconv/1.8/configuration.html#send-proxy" target="_blank" rel="noopener noreferrer">HAproxy</a> or <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/network/load-balancer-target-groups.html#proxy-protocol" target="_blank" rel="noopener noreferrer">AWS ELB</a>).
This makes it easier for the operator to inspect connection origins in the management UI
or CLI tools.</p>
<p>The protocol spec dictates that either it must be applied to all connections or none of them for
security reasons, this feature is turned off by default and needs to be turned on
for individual protocols supported by RabbitMQ. To turn it on for AMQP 0-9-1 and AMQP 1.0 clients:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">proxy_protocol = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When proxy protocol is turned on, clients won&#x27;t be able to connect to RabbitMQ directly unless
they themselves support the protocol.
Therefore, when this option is turned on, all client connections must go through
a proxy that also supports the protocol and is configured to send a Proxy protocol header. <a href="http://www.haproxy.org/download/3.1/doc/proxy-protocol.txt" target="_blank" rel="noopener noreferrer">HAproxy</a>
and <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/network/load-balancer-target-groups.html#proxy-protocol" target="_blank" rel="noopener noreferrer">AWS ELB</a> documentation
explains how to do it.</p>
<p>When proxy protocol is turned on and connections go through a compatible proxy, no action
or modifications are required from client libraries. The communication is entirely
transparent to them.</p>
<p><a href="/rabbitmq-website/docs/stomp#proxy-protocol">STOMP</a> and <a href="/rabbitmq-website/docs/mqtt#proxy-protocol">MQTT</a>,
as well as <a href="/rabbitmq-website/docs/web-stomp#proxy-protocol">Web STOMP</a> and
<a href="/rabbitmq-website/docs/web-mqtt#proxy-protocol">Web MQTT</a>
have their own settings that enable support for the proxy protocol.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tls-support">TLS (SSL) Support<a href="#tls-support" class="hash-link" aria-label="Direct link to TLS (SSL) Support" title="Direct link to TLS (SSL) Support">​</a></h2>
<p>It is possible to encrypt connections using TLS with RabbitMQ. Authentication
using peer certificates is also possible. Please refer to the <a href="/rabbitmq-website/docs/ssl">TLS/SSL guide</a>
for more information.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-throughput">Tuning for Throughput<a href="#tuning-for-throughput" class="hash-link" aria-label="Direct link to Tuning for Throughput" title="Direct link to Tuning for Throughput">​</a></h2>
<a id="tuning-for-throughput-intro"></a>
<p>Tuning for throughput is a common goal. Improvements can be achieved by</p>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Starting with RabbitMQ 4.1, <a href="https://www.rabbitmq.com/blog/2025/04/08/4.1-performance-improvements" target="_blank" rel="noopener noreferrer">connections automatically adjust their TCP buffer size</a>
based on message rates and sizes.</p></div></div>
<ul>
<li>Ensuring Nagle&#x27;s algorithm is turned off</li>
<li>Turning on optional TCP features and extensions</li>
<li>Increase the (initial) connection TCP buffer size</li>
</ul>
<p>For the latter two, see the OS-level tuning section below.</p>
<p>Note that tuning for throughput will involve trade-offs. For example, increasing TCP buffer
sizes will increase the amount of RAM used by every connection, which can be a significant
total server RAM use increase.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-throughput-tcp-buffers">TCP Buffer Size<a href="#tuning-for-throughput-tcp-buffers" class="hash-link" aria-label="Direct link to TCP Buffer Size" title="Direct link to TCP Buffer Size">​</a></h3>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Starting with RabbitMQ 4.1, <a href="https://www.rabbitmq.com/blog/2025/04/08/4.1-performance-improvements" target="_blank" rel="noopener noreferrer">connections automatically adjust their TCP buffer size</a>
based on message rates and sizes.</p><p>Manually adjusted TCP buffer size is therefore
only has an effect very early on in the connection&#x27;s lifetime,
and has become significantly less relevant than in earlier series.</p></div></div>
<p>This is one of the key tunable parameters. Every TCP connection has buffers
allocated for it. Generally speaking, the larger these buffers are, the more RAM
is used per connection and better the throughput. On Linux, the OS will automatically
tune TCP buffer size by default, typically settling on a value between 80 and 120 KB.</p>
<p>For maximum throughput, it is possible to increase buffer size using a group of config options:</p>
<ul>
<li><code>tcp_listen_options</code> for AMQP 0-9-1 and AMQP 1.0</li>
<li><code>mqtt.tcp_listen_options</code> for MQTT</li>
<li><code>stomp.tcp_listen_options</code> for STOMP</li>
</ul>
<p>Note that increasing TCP buffer size will increase how much <a href="/rabbitmq-website/docs/memory-use">RAM the node uses</a>
for every client connection.</p>
<p>The following example sets TCP buffers for AMQP 0-9-1 connections to 192 KiB:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.backlog = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.nodelay = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.linger.on      = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.linger.timeout = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Starting with RabbitMQ 4.1, connections automatically adjust their TCP buffer size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># based on message rates and sizes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Manually adjusted TCP buffer size is therefore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># only has an effect very early on in the connection&#x27;s lifetime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># and has become significantly less relevant than in earlier series.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.sndbuf = 196608</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.recbuf = 196608</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The same example for MQTT:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.backlog = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.nodelay = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.linger.on      = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.linger.timeout = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Starting with RabbitMQ 4.1, connections automatically adjust their TCP buffer size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># based on message rates and sizes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Manually adjusted TCP buffer size is therefore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># only has an effect very early on in the connection&#x27;s lifetime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># and has become significantly less relevant than in earlier series.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.sndbuf = 196608</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.recbuf = 196608</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and STOMP:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.backlog = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.nodelay = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.linger.on      = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.linger.timeout = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Starting with RabbitMQ 4.1, connections automatically adjust their TCP buffer size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># based on message rates and sizes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Manually adjusted TCP buffer size is therefore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># only has an effect very early on in the connection&#x27;s lifetime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># and has become significantly less relevant than in earlier series.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.sndbuf = 196608</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.recbuf = 196608</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that setting send and receive buffer sizes to different values
can be dangerous and <strong>not recommended</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-large-number-of-connections">Tuning for a Large Number of Connections<a href="#tuning-for-large-number-of-connections" class="hash-link" aria-label="Direct link to Tuning for a Large Number of Connections" title="Direct link to Tuning for a Large Number of Connections">​</a></h2>
<a id="tuning-for-large-number-of-connections-intro"></a>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>Starting with RabbitMQ 4.1, <a href="https://www.rabbitmq.com/blog/2025/04/08/4.1-performance-improvements" target="_blank" rel="noopener noreferrer">connections automatically adjust their TCP buffer size</a>
based on message rates and sizes.</p><p>Manually adjusted TCP buffer size is therefore
only has an effect very early on in the connection&#x27;s lifetime,
and has become significantly less relevant than in earlier series.</p></div></div>
<p>Some workloads, often referred to as &quot;the Internet of
Things&quot;, assume a large number of client connections per
node, and a relatively low volume of traffic from each node.
One such workload is sensor networks: there can be hundreds
of thousands or millions of sensors deployed, each emitting
data every several minutes. Optimising for the maximum
number of concurrent clients can be more important than for
total throughput.</p>
<a id="tuning-for-large-number-of-connections-limitations"></a>
<p>Several factors can limit how many concurrent connections a single node can support:</p>
<ul>
<li>Maximum number of <a href="#open-file-handle-limit">open file handles</a> (including sockets) as well as other kernel-enforced resource limits</li>
<li>Amount of <a href="/rabbitmq-website/docs/memory-use">RAM used by each connection</a></li>
<li>Amount of CPU resources used by each connection</li>
<li>Maximum number of Erlang processes the VM is configured to allow.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="open-file-handle-limit">Open File Handle Limit<a href="#open-file-handle-limit" class="hash-link" aria-label="Direct link to Open File Handle Limit" title="Direct link to Open File Handle Limit">​</a></h3>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>When overriding the max open file handle limit to
a higher value, the <code>ERL_MAX_PORTS</code> environment variable must be <a href="/rabbitmq-website/docs/configure">overridden</a> accordingly.</p></div></div>
<p>Most operating systems limit the number of file handles that
can be opened at the same time. When an OS process (such as RabbitMQ&#x27;s Erlang VM) reaches
the limit, it won&#x27;t be able to open any new files or accept any more
TCP connections. The limit will also affect how much memory the <a href="/rabbitmq-website/docs/runtime">Erlang runtime</a>
will allocate upfront. This means that the limit on some modern distributions
<a href="/rabbitmq-website/blog/2022/08/30/high-initial-memory-consumption-of-rabbitmq-nodes-on-centos-stream-9">can be too high</a> and need
lowering.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-override-the-limit">How to Override the Limit<a href="#how-to-override-the-limit" class="hash-link" aria-label="Direct link to How to Override the Limit" title="Direct link to How to Override the Limit">​</a></h4>
<p>How the limit is configured <a href="https://github.com/basho/basho_docs/blob/master/content/riak/kv/2.2.3/using/performance/open-files-limit.md" target="_blank" rel="noopener noreferrer">varies from OS to OS</a> and distribution to distribution, e.g. depending on whether systemd is used.
For Linux, Controlling System Limits on Linux
in our <a href="/rabbitmq-website/docs/install-debian#kernel-resource-limits">Debian</a> and <a href="/rabbitmq-website/docs/install-rpm#kernel-resource-limits">RPM</a>
installation guides provides. Linux kernel limit management is covered by many resources on the Web,
including the <a href="https://ro-che.info/articles/2017-03-26-increase-open-files-limit" target="_blank" rel="noopener noreferrer">open file handle limit</a>.</p>
<p>With Docker, <a href="https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file" target="_blank" rel="noopener noreferrer">Docker daemon configuration file</a>
in the host controls the limits.</p>
<p>MacOS uses a <a href="https://superuser.com/questions/433746/is-there-a-fix-for-the-too-many-open-files-in-system-error-on-os-x-10-7-1" target="_blank" rel="noopener noreferrer">similar system</a>.</p>
<p>On Windows, the limit for the Erlang runtime is controlled exclusively using the <code>ERL_MAX_PORTS</code> environment variable.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="erl-max-ports">The ERL_MAX_PORTS Environment Variable<a href="#erl-max-ports" class="hash-link" aria-label="Direct link to The ERL_MAX_PORTS Environment Variable" title="Direct link to The ERL_MAX_PORTS Environment Variable">​</a></h4>
<p>The <a href="/rabbitmq-website/docs/runtime">runtime</a> has a related limit, controlled via the <code>ERL_MAX_PORTS</code> environment
variable.</p>
<p>By default the limit is usually set to 65536. When overriding the max open file handle limit to
a higher value, <code>ERL_MAX_PORTS</code> must be <a href="/rabbitmq-website/docs/configure">overridden</a> accordingly.</p>
<p>To find out the effective <code>ERL_MAX_PORTS</code> value of a RabbitMQ node,
use the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmqctl </span><span class="token builtin class-name">eval</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;erlang:system_info(port_limit).&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="basic-estimates-of-the-necessary-limit">Basic Estimates of the Necessary Limit<a href="#basic-estimates-of-the-necessary-limit" class="hash-link" aria-label="Direct link to Basic Estimates of the Necessary Limit" title="Direct link to Basic Estimates of the Necessary Limit">​</a></h4>
<p>When optimising for the number of concurrent connections,
make sure your system has enough file descriptors to
support not only client connections but also files the node
may use. To calculate a ballpark limit, multiply the number
of connections per node by 1.5. For example, to support 100,000
connections, set the limit to 150,000.</p>
<p>Increasing the limit slightly increases the amount of
RAM idle machine uses but this is a reasonable trade-off.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-large-number-of-connections-tcp-buffer-size">Per Connection Memory Consumption: TCP Buffer Size<a href="#tuning-for-large-number-of-connections-tcp-buffer-size" class="hash-link" aria-label="Direct link to Per Connection Memory Consumption: TCP Buffer Size" title="Direct link to Per Connection Memory Consumption: TCP Buffer Size">​</a></h3>
<p>See the section above for an overview.</p>
<p>For maximum number of concurrent client connections, it is possible to decrease TCP buffer size
using a group of config options:</p>
<ul>
<li><code>tcp_listen_options</code> for AMQP 0-9-1 and AMQP 1.0</li>
<li><code>mqtt.tcp_listen_options</code> for MQTT</li>
<li><code>stomp.tcp_listen_options</code> for STOMP</li>
</ul>
<p>Decreasing TCP buffer size will decrease how much <a href="/rabbitmq-website/docs/memory-use">RAM the node uses</a>
for every client connection.</p>
<p>This is often necessary in environments where the number of concurrent connections
sustained per node is more important than throughput.</p>
<p>The following example sets TCP buffers for AMQP 0-9-1 connections to 32 KiB:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.backlog = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.nodelay = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.linger.on      = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.linger.timeout = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.sndbuf  = 32768</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.recbuf  = 32768</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The same example for MQTT:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.backlog = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.nodelay = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.linger.on      = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.linger.timeout = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.sndbuf  = 32768</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mqtt.tcp_listen_options.recbuf  = 32768</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and for STOMP:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.backlog = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.nodelay = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.linger.on      = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.linger.timeout = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.sndbuf  = 32768</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stomp.tcp_listen_options.recbuf  = 32768</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that lowering TCP buffer sizes will result in a proportional throughput drop,
so an optimal value between throughput and per-connection RAM use needs to be
found for every workload.</p>
<p>Setting send and receive buffer sizes to different values is dangerous
and is not recommended. Values lower than 8 KiB are not recommended.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-large-number-of-connections-cpu-footprint">Reducing CPU Footprint of Stats Emission<a href="#tuning-for-large-number-of-connections-cpu-footprint" class="hash-link" aria-label="Direct link to Reducing CPU Footprint of Stats Emission" title="Direct link to Reducing CPU Footprint of Stats Emission">​</a></h3>
<p>A large number of concurrent connections will generate a lot of metric (stats) emission events.
This increases CPU consumption even with mostly idle connections. To reduce this footprint,
increase the statistics collection interval using the <code>collect_statistics_interval</code> key:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># sets the interval to 60 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">collect_statistics_interval = 60000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The default is 5 seconds (5000 milliseconds).</p>
<p>Increasing the interval value to 30-60s will reduce CPU footprint and peak memory consumption.
This comes with a downside: with the value in the example above, metrics of said entities
will refresh every 60 seconds.</p>
<p>This can be perfectly reasonable in an <a href="/rabbitmq-website/docs/monitoring#monitoring-frequency">externally monitored</a> production system
but will make management UI less convenient to use for operators.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-large-number-of-connections-channel-max">Limiting Number of Channels on a Connection<a href="#tuning-for-large-number-of-connections-channel-max" class="hash-link" aria-label="Direct link to Limiting Number of Channels on a Connection" title="Direct link to Limiting Number of Channels on a Connection">​</a></h3>
<p>Channels also consume RAM. By optimising how many channels applications use, that amount
can be decreased. It is possible to cap the max number of channels on a connection using
the <code>channel_max</code> configuration setting:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">channel_max = 16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that some libraries and tools that build on top of RabbitMQ clients may implicitly require
a certain number of channels. Values above 200 are rarely necessary.
Finding an optimal value is usually a matter of trial and error.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-large-number-of-connections-nodelay">Nagle&#x27;s Algorithm (&quot;nodelay&quot;)<a href="#tuning-for-large-number-of-connections-nodelay" class="hash-link" aria-label="Direct link to Nagle&#x27;s Algorithm (&quot;nodelay&quot;)" title="Direct link to Nagle&#x27;s Algorithm (&quot;nodelay&quot;)">​</a></h3>
<p>Turning off <a href="http://en.wikipedia.org/wiki/Nagle&#x27;s_algorithm">Nagle&#x27;s
algorithm</a> is primarily useful for reducing latency but
can also improve throughput.</p>
<p><code>kernel.inet_default_connect_options</code> and <code>kernel.inet_default_listen_options</code> must
include <code>{nodelay, true}</code> to turn off Nagle&#x27;s algorithm for inter-node connections.</p>
<p>When configuring sockets that serve client connections,
<code>tcp_listen_options</code> must include the same option. This is the default.</p>
<p>The following example demonstrates that. First, <code>rabbitmq.conf</code>:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.backlog = 4096</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.nodelay = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>which should be used together with the following bits in the <a href="/rabbitmq-website/docs/configure#advanced-config-file">advanced config file</a>:</p>
<div class="language-erlang codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-erlang codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">kernel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">inet_default_connect_options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">nodelay</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">inet_default_listen_options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">nodelay</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When using the <a href="/rabbitmq-website/docs/configure#erlang-term-config-file">classic config format</a>,
everything is configured in a single file:</p>
<div class="language-erlang codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-erlang codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">kernel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">inet_default_connect_options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">nodelay</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">inet_default_listen_options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">nodelay</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">rabbit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">tcp_listen_options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">backlog</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">nodelay</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">linger</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">exit_on_close</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-large-number-of-connections-async-thread-pool">Erlang VM I/O Thread Pool Tuning<a href="#tuning-for-large-number-of-connections-async-thread-pool" class="hash-link" aria-label="Direct link to Erlang VM I/O Thread Pool Tuning" title="Direct link to Erlang VM I/O Thread Pool Tuning">​</a></h3>
<p>Adequate Erlang VM I/O thread pool size is also important when tuning for a large number of
concurrent connections. See the section above.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tuning-for-large-number-of-connections-connection-backlog">Connection Backlog<a href="#tuning-for-large-number-of-connections-connection-backlog" class="hash-link" aria-label="Direct link to Connection Backlog" title="Direct link to Connection Backlog">​</a></h3>
<p>With a low number of clients, new connection rate is very unevenly distributed
but is also small enough to not make much difference. When the number reaches tens of thousands
or more, it is important to make sure that the server can accept inbound connections.
Unaccepted TCP connections are put into a queue with bounded length. This length has to be
sufficient to account for peak load hours and possible spikes, for instance, when many clients
disconnect due to a network interruption or choose to reconnect.
This is configured using the <code>tcp_listen_options.backlog</code>
option:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.backlog = 4096</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_listen_options.nodelay = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the <a href="/rabbitmq-website/docs/configure#erlang-term-config-file">classic config format</a>:</p>
<div class="language-erlang codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-erlang codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">rabbit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">tcp_listen_options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">backlog</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">nodelay</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">linger</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token atom">exit_on_close</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Default value is 128. When pending connection queue length grows beyond this value,
connections will be rejected by the operating system. See also <code>net.core.somaxconn</code>
in the kernel tuning section.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dealing-with-high-connection-churn">Dealing with High Connection Churn<a href="#dealing-with-high-connection-churn" class="hash-link" aria-label="Direct link to Dealing with High Connection Churn" title="Direct link to Dealing with High Connection Churn">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dealing-with-high-connection-churn-overview">Why is High Connection Churn Problematic?<a href="#dealing-with-high-connection-churn-overview" class="hash-link" aria-label="Direct link to Why is High Connection Churn Problematic?" title="Direct link to Why is High Connection Churn Problematic?">​</a></h3>
<p>Workloads with high connection churn (a high rate of connections being opened and closed) will require
TCP setting tuning to avoid exhaustion of certain resources: max number of file handles,
Erlang processes on RabbitMQ nodes, kernel&#x27;s ephemeral port range (for hosts that <em>open</em> a lot
of connections, including <a href="/rabbitmq-website/docs/federation">Federation</a> links and <a href="/rabbitmq-website/docs/shovel">Shovel</a> connections), and others.
Nodes that are exhausted of those resources <strong>won&#x27;t be able to accept new connections</strong>,
which will negatively affect overall system availability.</p>
<p>Due to a combination of certain TCP features
and defaults of most modern Linux distributions, closed connections can be detected after
a prolonged period of time. This is covered in the <a href="/rabbitmq-website/docs/heartbeats">heartbeats guide</a>.
This can be one contributing factor to connection build-up. Another is the <code>TIME_WAIT</code> TCP
connection state. The state primarily exists to make sure that retransmitted segments from closed
connections won&#x27;t &quot;reappear&quot; on a different (newer) connection with the same client host and port.
Depending on the OS and TCP stack configuration connections can spend minutes in this state,
which on a busy system is guaranteed to lead to a connection build-up.</p>
<p>See <a href="http://vincent.bernat.im/en/blog/2014-tcp-time-wait-state-linux.html" target="_blank" rel="noopener noreferrer">Coping with the TCP TIME_WAIT connections on busy servers</a> for details.</p>
<p>TCP stack configuration can reduce peak number of connection in closing states and
avoid resource exhaustion, in turn allowing nodes to accept new connections at all times.</p>
<p>High connection churn can also mean developer mistakes or incorrect assumptions about how
the messaging protocols supported by RabbitMQ are meant to be used. All supported protocols
assume long lived connections. Applications that open and almost immediately close connections
unnecessarily waste resources (network bandwidth, CPU, RAM) and contribute to the problem
described in this section.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dealing-with-high-connection-churn-troubleshooting">Inspecting Connections and Gathering Evidence<a href="#dealing-with-high-connection-churn-troubleshooting" class="hash-link" aria-label="Direct link to Inspecting Connections and Gathering Evidence" title="Direct link to Inspecting Connections and Gathering Evidence">​</a></h3>
<p>If a node fails to accept connections it is important to first gather data (metrics, evidence) to
determine the state of the system and the limiting factor (exhausted resource).
Tools such as <a href="https://en.wikipedia.org/wiki/Netstat" target="_blank" rel="noopener noreferrer">netstat</a>,
<a href="https://linux.die.net/man/8/ss" target="_blank" rel="noopener noreferrer">ss</a>, <a href="https://en.wikipedia.org/wiki/Lsof" target="_blank" rel="noopener noreferrer">lsof</a> can be used
to inspect TCP connections of a node. See <a href="/rabbitmq-website/docs/troubleshooting-networking">Troubleshooting Networking</a> for examples.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dealing-with-high-connection-churn-tcp-keepalives">The Role of TCP Keepalives<a href="#dealing-with-high-connection-churn-tcp-keepalives" class="hash-link" aria-label="Direct link to The Role of TCP Keepalives" title="Direct link to The Role of TCP Keepalives">​</a></h3>
<p>While <a href="/rabbitmq-website/docs/heartbeats">heartbeats</a> are sufficient for detecting defunct connections,
they are not going to be sufficient in high connection churn scenarios. In those cases
heartbeats should be combined with <a href="#tcp-keepalives">TCP keepalives</a> to speed
up disconnected client detection.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dealing-with-high-connection-churn-time-wait">Reducing Amount of Time Spent in TIME_WAIT<a href="#dealing-with-high-connection-churn-time-wait" class="hash-link" aria-label="Direct link to Reducing Amount of Time Spent in TIME_WAIT" title="Direct link to Reducing Amount of Time Spent in TIME_WAIT">​</a></h3>
<p>TCP stack tuning can also reduce the amount of time connections spend in the <code>TIME_WAIT</code> state.
The <code>net.ipv4.tcp_fin_timeout</code> setting specifically can help here:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_fin_timeout = 30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that like other settings prefixed with <code>net.ipv4.</code>, this one applies to both IPv4 and IPv6
connections despite the name.</p>
<p>If inbound connections (from clients, plugins, CLI tools and so on) do not rely on NAT,
<code>net.ipv4.tcp_tw_reuse</code> can be set to <code>1</code> (enabled) to allow the kernel
to reuse sockets in the <code>TIME_WAIT</code> state for outgoing connections. This setting can
be applied on client hosts or intermediaries such as proxies and load balancers. Note that
if NAT is used the setting is not safe and can lead to hard to track down issues.</p>
<p>The settings above generally should be combined with reduced <a href="#tcp-keepalives">TCP keepalive</a>
values, for example:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_fin_timeout = 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_keepalive_time=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_keepalive_intvl=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_keepalive_probes=4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_tw_reuse = 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="os-tuning">OS Level Tuning<a href="#os-tuning" class="hash-link" aria-label="Direct link to OS Level Tuning" title="Direct link to OS Level Tuning">​</a></h2>
<p>Operating system settings can affect operation of RabbitMQ.
Some are directly related to networking (e.g. TCP settings), others
affect TCP sockets as well as other things (e.g. open file handles limit).</p>
<p>Understanding these limits is important, as they may change depending on
the workload.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-relevant-kernel-options">Key Relevant Kernel Options<a href="#key-relevant-kernel-options" class="hash-link" aria-label="Direct link to Key Relevant Kernel Options" title="Direct link to Key Relevant Kernel Options">​</a></h3>
<p>A few important configurable kernel options include (note that despite option names they
are effective for both IPv4 and IPv6 connections):</p>
<table><thead><tr><th>Kernel setting</th><th>Description</th></tr></thead><tbody><tr><td><code>fs.file-max</code></td><td><p>Max number of files the kernel will allocate. Limits and current value
can be inspected using <code>/proc/sys/fs/file-nr</code>.</p></td></tr><tr><td><code>net.ipv4.ip_local_port_range</code></td><td><p>Local IP port range, define as a pair of values. The range must provide enough
entries for the peak number of concurrent connections.</p></td></tr><tr><td><code>net.ipv4.tcp_tw_reuse</code></td><td><p>When enabled, allows the kernel to reuse sockets in <code>TIME_WAIT</code>
state when it&#x27;s safe to do so. See <a href="#dealing-with-high-connection-churn">Dealing with High Connection Churn</a>.
This option is dangerous when clients and peers connect using NAT.</p></td></tr><tr><td><code>net.ipv4.tcp_fin_timeout</code></td><td><p>Lowering this timeout to a value in the 15-30 second range reduces the amount of time closed connections
will stay in the TIME_WAIT state. See <a href="#dealing-with-high-connection-churn">Dealing with High Connection Churn</a>.</p></td></tr><tr><td><code>net.core.somaxconn</code></td><td><p>Size of the listen queue (how many connections are in
the process of being established at the same time).
Default is 128. Increase to 4096 or higher to support
inbound connection bursts, e.g. when clients reconnect
en masse.</p></td></tr><tr><td><code>net.ipv4.tcp_max_syn_backlog</code></td><td><p>Maximum number of remembered connection requests which
did not receive an acknowledgment yet from
connecting client. Default is 128, max value is 65535. 4096 and 8192 are
recommended starting values when optimising for throughput.</p></td></tr><tr><td><code>net.ipv4.tcp_keepalive_*</code></td><td><p><code>net.ipv4.tcp_keepalive_time</code>, <code>net.ipv4.tcp_keepalive_intvl</code>,
and <code>net.ipv4.tcp_keepalive_probes</code> configure TCP keepalive.</p><p>AMQP 0-9-1 and STOMP have <a href="./heartbeats">Heartbeats</a> which partially
undo its effect, namely that it can take minutes to detect an unresponsive peer,
for example, in case of a hardware or power failure. MQTT also has its own keepalives
mechanism which is the same idea under a different name.</p><p>When enabling TCP keepalive with default settings, we
recommend setting heartbeat timeout to 8-20 seconds. Also see a note on TCP keepalives
later in this guide.</p></td></tr><tr><td><code>net.ipv4.conf.default.rp_filter</code></td><td><p>Activating or turning on reverse path filtering. If <a href="http://en.wikipedia.org/wiki/IP_address_spoofing">IP address spoofing</a>
is not a concern for your system, deactivate it.</p></td></tr></tbody></table>
<p>Note that default values for these vary between Linux kernel releases and distributions.
Using a recent kernel version (such as 6.x or later) is recommended.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sysctl-based-configuration">sysctl-based Configuration<a href="#sysctl-based-configuration" class="hash-link" aria-label="Direct link to sysctl-based Configuration" title="Direct link to sysctl-based Configuration">​</a></h3>
<p>Kernel parameter tuning differs from OS to OS. This guide focuses on Linux.
To configure a kernel parameter interactively, use <code>sysctl -w</code> (requires superuser
privileges), for example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sysctl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> fs.file-max </span><span class="token number" style="color:#36acaa">200000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To make the changes permanent (stick between reboots), they need to be added to
<code>/etc/sysctl.conf</code>. See <a href="http://man7.org/linux/man-pages/man8/sysctl.8.html" target="_blank" rel="noopener noreferrer">sysctl(8)</a>
and <a href="http://man7.org/linux/man-pages/man5/sysctl.conf.5.html" target="_blank" rel="noopener noreferrer">sysctl.conf(5)</a>
for more details.</p>
<h3></h3>
<p>TCP stack tuning is a broad topic that is covered in much detail elsewhere:</p>
<ul>
<li><a href="https://psc.edu/index.php/services/networking/68-research/networking/641-tcp-tune" target="_blank" rel="noopener noreferrer">Enabling High Performance Data Transfers</a></li>
<li><a href="https://fasterdata.es.net/network-tuning/" target="_blank" rel="noopener noreferrer">Network Tuning Guide</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="socket-gen-tcp-options">TCP Socket Options<a href="#socket-gen-tcp-options" class="hash-link" aria-label="Direct link to TCP Socket Options" title="Direct link to TCP Socket Options">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="socket-gen-tcp-options-common">Common Options<a href="#socket-gen-tcp-options-common" class="hash-link" aria-label="Direct link to Common Options" title="Direct link to Common Options">​</a></h3>
<table><thead><tr><th>Kernel setting</th><th>Description</th></tr></thead><tbody><tr><td><code>tcp_listen_options.nodelay</code></td><td><p>When set to <code>true</code>, deactivates
<a href="http://en.wikipedia.org/wiki/Nagle&#x27;s_algorithm">Nagle&#x27;s algorithm</a>.
Default is true. Highly recommended for most users.</p></td></tr><tr><td><code>tcp_listen_options.sndbuf</code></td><td><p>See TCP buffers discussion earlier in this guide. Default value is
automatically tuned by the OS, typically in the 88 KiB to 128 KiB range on
modern Linux versions. Increasing buffer size improves consumer throughput
and RAM use for every connection. Decreasing has the opposite effect.</p></td></tr><tr><td><code>tcp_listen_options.recbuf</code></td><td><p>See TCP buffers discussion earlier in this guide. Default value effects
are similar to that of <code>tcp_listen_options.sndbuf</code> but
for publishers and protocol operations in general.</p></td></tr><tr><td><code>tcp_listen_options.backlog</code></td><td><p>Maximum size of the unaccepted TCP connections queue. When this size
is reached, new connections will be rejected. Set to 4096 or higher for
environments with thousands of concurrent connections and possible bulk client
reconnections.</p></td></tr><tr><td><code>tcp_listen_options.keepalive</code></td><td><p>When set to <code>true</code>, enables TCP keepalives (see above).
Default is <code>false</code>. Makes sense for environments where
connections can go idle for a long time (at least 10 minutes),
although using <a href="./heartbeats">heartbeats</a> is still recommended over
this option.</p></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="socket-gen-tcp-options-defaults">Defaults<a href="#socket-gen-tcp-options-defaults" class="hash-link" aria-label="Direct link to Defaults" title="Direct link to Defaults">​</a></h3>
<p>Below is the default TCP socket option configuration used by RabbitMQ:</p>
<ul>
<li>TCP connection backlog is limited to 128 connections</li>
<li>Nagle&#x27;s algorithm is deactivated</li>
<li>Server socket lingering is enabled with the timeout of 0</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="heartbeats">Heartbeats<a href="#heartbeats" class="hash-link" aria-label="Direct link to Heartbeats" title="Direct link to Heartbeats">​</a></h2>
<p>Some protocols supported by RabbitMQ, including AMQP 0-9-1, support <em>heartbeats</em>, a way to detect dead
TCP peers quicker. Please refer to the <a href="/rabbitmq-website/docs/heartbeats">Heartbeats guide</a>
for more information.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nettick">Net Tick Time<a href="#nettick" class="hash-link" aria-label="Direct link to Net Tick Time" title="Direct link to Net Tick Time">​</a></h2>
<p><a href="/rabbitmq-website/docs/heartbeats">Heartbeats</a> are used to detect peer or connection failure
between clients and RabbitMQ nodes. <a href="/rabbitmq-website/docs/nettick">net_ticktime</a> serves
the same purpose but for cluster node communication. Values lower than 5 (seconds)
may result in false positive and are not recommended.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-keepalives">TCP Keepalives<a href="#tcp-keepalives" class="hash-link" aria-label="Direct link to TCP Keepalives" title="Direct link to TCP Keepalives">​</a></h2>
<p>TCP contains a mechanism similar in purpose to the heartbeat
(a.k.a. keepalive) one in messaging protocols and net tick
timeout covered above: TCP keepalives. Due to inadequate
defaults, TCP keepalives often don&#x27;t work the way they are
supposed to: it takes a very long time (say, an hour or more)
to detect a dead peer. However, with tuning they can serve
the same purpose as heartbeats and clean up stale TCP connections
e.g. with clients that opted to not use heartbeats, intentionally or
not.</p>
<p>Below is an example sysctl configuration for TCP keepalives
that considers TCP connections dead or unreachable after 70
seconds (4 attempts every 10 seconds after connection idle for 30 seconds):</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_keepalive_time=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_keepalive_intvl=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_keepalive_probes=4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>TCP keepalives can be a useful additional defense mechanism
in environments where RabbitMQ operator has no control
over application settings or client libraries used.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="handshake-timeout">Connection Handshake Timeout<a href="#handshake-timeout" class="hash-link" aria-label="Direct link to Connection Handshake Timeout" title="Direct link to Connection Handshake Timeout">​</a></h2>
<p>RabbitMQ has a timeout for connection handshake, 10 seconds by
default. When clients run in heavily constrained environments,
it may be necessary to increase the timeout. This can be done via
the <code>rabbit.handshake_timeout</code> (in milliseconds):</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">handshake_timeout = 20000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It should be pointed out that this is only necessary with very constrained
clients and networks. Handshake timeouts in other circumstances indicate
a problem elsewhere.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tls-handshake">TLS Handshake<a href="#tls-handshake" class="hash-link" aria-label="Direct link to TLS Handshake" title="Direct link to TLS Handshake">​</a></h3>
<p>If <a href="/rabbitmq-website/docs/ssl">TLS is enabled</a>, it may be necessary to increase also the TLS
handshake timeout. This can be done via
the <code>rabbit.ssl_handshake_timeout</code> (in milliseconds):</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssl_handshake_timeout = 10000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dns">Hostname Resolution and DNS<a href="#dns" class="hash-link" aria-label="Direct link to Hostname Resolution and DNS" title="Direct link to Hostname Resolution and DNS">​</a></h2>
<p>In many cases, RabbitMQ relies on the Erlang runtime for inter-node communication (including
tools such as <code>rabbitmqctl</code>, <code>rabbitmq-plugins</code>, etc). Client libraries
also perform hostname resolution when connecting to RabbitMQ nodes. This section briefly
covers most common issues associated with that.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dns-resolution-by-clients">Performed by Client Libraries<a href="#dns-resolution-by-clients" class="hash-link" aria-label="Direct link to Performed by Client Libraries" title="Direct link to Performed by Client Libraries">​</a></h3>
<p>If a client library is configured to connect to a hostname, it performs
hostname resolution. Depending on DNS and local resolver (<code>/etc/hosts</code>
and similar) configuration, this can take some time. Incorrect configuration
may lead to resolution timeouts, e.g. when trying to resolve a local hostname
such as <code>my-dev-machine</code>, over DNS. As a result, client connections
can take a long time (from tens of seconds to a few minutes).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dns-resolution-by-nodes">Short and Fully-qualified RabbitMQ Node Names<a href="#dns-resolution-by-nodes" class="hash-link" aria-label="Direct link to Short and Fully-qualified RabbitMQ Node Names" title="Direct link to Short and Fully-qualified RabbitMQ Node Names">​</a></h3>
<p>RabbitMQ relies on the Erlang runtime for inter-node
communication. Erlang nodes include a hostname, either short
(<code>rmq1</code>) or fully-qualified
(<code>rmq1.dev.megacorp.local</code>). Mixing short and
fully-qualified hostnames is not allowed by the
runtime. Every node in a cluster must be able to resolve
every other node&#x27;s hostname, short or fully-qualified.</p>
<p>By default RabbitMQ will use short hostnames. Set the
<code>RABBITMQ_USE_LONGNAME</code> environment variable to
make RabbitMQ nodes use fully-qualified names,
e.g. <code>rmq1.dev.megacorp.local</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dns-reverse-dns-lookups">Reverse DNS Lookups<a href="#dns-reverse-dns-lookups" class="hash-link" aria-label="Direct link to Reverse DNS Lookups" title="Direct link to Reverse DNS Lookups">​</a></h3>
<p>If the <code>reverse_dns_lookups</code> configuration option is set to <code>true</code>,
RabbitMQ will complete reverse DNS lookups for client IP addresses and list hostnames
in connection information (e.g. in the <a href="/rabbitmq-website/docs/management">Management UI</a>).</p>
<p>Reverse DNS lookups can potentially take a long time if node&#x27;s hostname resolution is not
optimally configured. This can increase latency when accepting client connections.</p>
<p>To explicitly activate or turn on reverse DNS lookups:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reverse_dns_lookups = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To deactivate reverse DNS lookups:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reverse_dns_lookups = false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-inetrc-file">The inetrc File<a href="#the-inetrc-file" class="hash-link" aria-label="Direct link to The inetrc File" title="Direct link to The inetrc File">​</a></h3>
<p>The <a href="/rabbitmq-website/docs/runtime">Erlang runtime</a> allows for a number of hostname resolution-related settings to be tuned
using a file known as the <a href="http://erlang.org/doc/apps/erts/inet_cfg.html" target="_blank" rel="noopener noreferrer">inetrc file</a>.</p>
<p>The path to the file can be specified by adding an extra runtime argument using the <a href="/rabbitmq-website/docs/configure"><code>RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS</code> environment variable</a>:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">bash</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">PowerShell</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-kernel inetrc &#x27;/path/to/inetrc.file&#x27;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-PowerShell language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$env</span><span class="token plain">:ERL_INETRC = </span><span class="token string" style="color:#e3116c">&quot;-kernel inetrc &#x27;c:\path\to\inetrc.file&#x27;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>The file can be used to configure a number of settings related to hostname resolution on the node (not system-wide):</p>
<ul>
<li>Hostnames and host addresses (similarly to the <a href="https://en.wikipedia.org/wiki/Hosts_(file)" target="_blank" rel="noopener noreferrer">local host file</a>)</li>
<li>Local domain name</li>
<li>Nameservers</li>
<li>Preferred hostname lookup method (e.g. local host file vs. DNS)</li>
<li>Hostname caching interval</li>
<li>Search domains</li>
</ul>
<p>Please consult the <a href="http://erlang.org/doc/apps/erts/inet_cfg.html" target="_blank" rel="noopener noreferrer">inetrc file documentation</a> to learn more.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dns-verify-resolution">Verify Hostname Resolution<a href="#dns-verify-resolution" class="hash-link" aria-label="Direct link to Verify Hostname Resolution" title="Direct link to Verify Hostname Resolution">​</a></h3>
<p>Since hostname resolution is a <a href="/rabbitmq-website/docs/clustering#hostname-resolution-requirement">prerequisite for successful inter-node communication</a>,
CLI tools provide two commands that help verify
that hostname resolution on a node works as expected. The commands are not meant to replace
<a href="https://en.wikipedia.org/wiki/Dig_(command)" target="_blank" rel="noopener noreferrer"><code>dig</code></a> and other specialised DNS tools but rather
provide a way to perform most basic checks while taking <a href="https://erlang.org/doc/apps/erts/inet_cfg.html" target="_blank" rel="noopener noreferrer">Erlang runtime hostname resolver features</a>
into account.</p>
<p>The first command is <code>rabbitmq-diagnostics resolve_hostname</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># resolves node2.cluster.local.svc to IPv6 addresses on node rabbit@node1.cluster.local.svc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics resolve_hostname node2.cluster.local.svc --address-family IPv6 </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> rabbit@node1.cluster.local.svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># makes local CLI tool resolve node2.cluster.local.svc to IPv4 addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics resolve_hostname node2.cluster.local.svc --address-family IPv4 </span><span class="token parameter variable" style="color:#36acaa">--offline</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The second one is <code>rabbitmq-diagnostics resolver_info</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq-diagnostics resolver_info</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It will report key resolver settings such as the lookup order (whether CLI tools should prefer the OS resolver,
inetrc file, and so on) as well as inetrc hostname entries, if any:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Runtime Hostname Resolver (inetrc) Settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Lookup order: native</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hosts file: /etc/hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resolver conf file: /etc/resolv.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cache size:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inetrc File Host Entries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(none)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Connection Event Logging<a href="#logging" class="hash-link" aria-label="Direct link to Connection Event Logging" title="Direct link to Connection Event Logging">​</a></h2>
<p>See <a href="/rabbitmq-website/docs/logging#connection-lifecycle-events">Connection Lifecycle Events</a> in the logging guide.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-where-to-start">Troubleshooting Network Connectivity<a href="#troubleshooting-where-to-start" class="hash-link" aria-label="Direct link to Troubleshooting Network Connectivity" title="Direct link to Troubleshooting Network Connectivity">​</a></h2>
<p>A methodology for <a href="/rabbitmq-website/docs/troubleshooting-networking">troubleshooting of networking-related issues</a>
is covered in a separate guide.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="firewalls-mac-os">MacOS Application Firewall<a href="#firewalls-mac-os" class="hash-link" aria-label="Direct link to MacOS Application Firewall" title="Direct link to MacOS Application Firewall">​</a></h2>
<p>On MacOS systems with <a href="https://support.apple.com/en-us/HT201642" target="_blank" rel="noopener noreferrer">Application Firewall</a> enabled,
Erlang runtime processes must be allowed to bind to ports and accept connections.
Without this, RabbitMQ nodes won&#x27;t be able to bind to their <a href="#ports">ports</a> and will fail to start.</p>
<p>A list of blocked applications can be seen under <code>Security and Privacy</code> =&gt; <code>Firewall</code> in system settings.</p>
<p>To &quot;unblock&quot; a command line tool, use <code>sudo /usr/libexec/ApplicationFirewall/socketfilterfw</code>.
The examples below assume that Erlang is installed under <code>/usr/local/Cellar/erlang/{version}</code>,
used by the Homebrew Erlang formula:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># allow CLI tools and shell to bind to ports and accept inbound connections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> /usr/libexec/ApplicationFirewall/socketfilterfw </span><span class="token parameter variable" style="color:#36acaa">--add</span><span class="token plain"> /usr/local/Cellar/erlang/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/lib/erlang/bin/erl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> /usr/libexec/ApplicationFirewall/socketfilterfw </span><span class="token parameter variable" style="color:#36acaa">--unblockapp</span><span class="token plain"> /usr/local/Cellar/erlang/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/lib/erlang/bin/erl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># allow server nodes (Erlang VM) to bind to ports and accept inbound connections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> /usr/libexec/ApplicationFirewall/socketfilterfw </span><span class="token parameter variable" style="color:#36acaa">--add</span><span class="token plain"> /usr/local/Cellar/erlang/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/lib/erlang/erts-</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">erts version</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/bin/beam.smp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> /usr/libexec/ApplicationFirewall/socketfilterfw </span><span class="token parameter variable" style="color:#36acaa">--unblockapp</span><span class="token plain"> /usr/local/Cellar/erlang/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/lib/erlang/erts-</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">erts version</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/bin/beam.smp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that <code>socketfilterfw</code> command line arguments can vary between MacOS releases.
To see supports command line arguments, use</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> /usr/libexec/ApplicationFirewall/socketfilterfw </span><span class="token parameter variable" style="color:#36acaa">--help</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rabbitmq/rabbitmq-website/tree/main/versioned_docs/version-4.1/networking.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rabbitmq-website/docs/definitions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Schema Definitions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rabbitmq-website/docs/nettick"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Net Tick Time</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#interfaces" class="table-of-contents__link toc-highlight">Network Interfaces for Client Connections</a><ul><li><a href="#dual-stack" class="table-of-contents__link toc-highlight">Listening on Dual Stack (Both IPv4 and IPv6) Interfaces</a></li><li><a href="#single-stack-ipv6" class="table-of-contents__link toc-highlight">Listening on IPv6 Interfaces Only</a></li><li><a href="#single-stack-ipv4" class="table-of-contents__link toc-highlight">Listening on IPv4 Interfaces Only</a></li></ul></li><li><a href="#ports" class="table-of-contents__link toc-highlight">Port Access</a></li><li><a href="#listener-suspension" class="table-of-contents__link toc-highlight">How to Temporarily Stop New Client Connections</a></li><li><a href="#epmd" class="table-of-contents__link toc-highlight">EPMD and Inter-node Communication</a><ul><li><a href="#what-is-epmd-and-how-is-it-used" class="table-of-contents__link toc-highlight">What is EPMD and How is It Used?</a></li><li><a href="#epmd-interface" class="table-of-contents__link toc-highlight">EPMD Interface</a></li><li><a href="#epmd-port" class="table-of-contents__link toc-highlight">EPMD Port</a></li></ul></li><li><a href="#distribution" class="table-of-contents__link toc-highlight">Inter-node Communication</a><ul><li><a href="#distribution-interface" class="table-of-contents__link toc-highlight">Inter-node Communication Interface</a></li><li><a href="#distribution-port-range" class="table-of-contents__link toc-highlight">Inter-node Communication Port Range</a></li><li><a href="#distribution-buffer-limit" class="table-of-contents__link toc-highlight">Inter-node Communication Buffer Size Limit</a></li></ul></li><li><a href="#distribution-ipv6" class="table-of-contents__link toc-highlight">Using IPv6 for Inter-node Communication (and CLI Tools)</a><ul><li><a href="#inter-node-communication-protocol" class="table-of-contents__link toc-highlight">Inter-node Communication Protocol</a></li><li><a href="#cli-tools" class="table-of-contents__link toc-highlight">CLI Tools</a></li><li><a href="#epmd-and-inter-node-communication" class="table-of-contents__link toc-highlight">epmd and Inter-node Communication</a></li></ul></li><li><a href="#intermediaries" class="table-of-contents__link toc-highlight">Intermediaries: Proxies and Load Balancers</a><ul><li><a href="#proxy-effects" class="table-of-contents__link toc-highlight">Proxy Effects</a></li><li><a href="#proxy-protocol" class="table-of-contents__link toc-highlight">Proxy Protocol</a></li></ul></li><li><a href="#tls-support" class="table-of-contents__link toc-highlight">TLS (SSL) Support</a></li><li><a href="#tuning-for-throughput" class="table-of-contents__link toc-highlight">Tuning for Throughput</a><ul><li><a href="#tuning-for-throughput-tcp-buffers" class="table-of-contents__link toc-highlight">TCP Buffer Size</a></li></ul></li><li><a href="#tuning-for-large-number-of-connections" class="table-of-contents__link toc-highlight">Tuning for a Large Number of Connections</a><ul><li><a href="#open-file-handle-limit" class="table-of-contents__link toc-highlight">Open File Handle Limit</a></li><li><a href="#tuning-for-large-number-of-connections-tcp-buffer-size" class="table-of-contents__link toc-highlight">Per Connection Memory Consumption: TCP Buffer Size</a></li><li><a href="#tuning-for-large-number-of-connections-cpu-footprint" class="table-of-contents__link toc-highlight">Reducing CPU Footprint of Stats Emission</a></li><li><a href="#tuning-for-large-number-of-connections-channel-max" class="table-of-contents__link toc-highlight">Limiting Number of Channels on a Connection</a></li><li><a href="#tuning-for-large-number-of-connections-nodelay" class="table-of-contents__link toc-highlight">Nagle&#39;s Algorithm (&quot;nodelay&quot;)</a></li><li><a href="#tuning-for-large-number-of-connections-async-thread-pool" class="table-of-contents__link toc-highlight">Erlang VM I/O Thread Pool Tuning</a></li><li><a href="#tuning-for-large-number-of-connections-connection-backlog" class="table-of-contents__link toc-highlight">Connection Backlog</a></li></ul></li><li><a href="#dealing-with-high-connection-churn" class="table-of-contents__link toc-highlight">Dealing with High Connection Churn</a><ul><li><a href="#dealing-with-high-connection-churn-overview" class="table-of-contents__link toc-highlight">Why is High Connection Churn Problematic?</a></li><li><a href="#dealing-with-high-connection-churn-troubleshooting" class="table-of-contents__link toc-highlight">Inspecting Connections and Gathering Evidence</a></li><li><a href="#dealing-with-high-connection-churn-tcp-keepalives" class="table-of-contents__link toc-highlight">The Role of TCP Keepalives</a></li><li><a href="#dealing-with-high-connection-churn-time-wait" class="table-of-contents__link toc-highlight">Reducing Amount of Time Spent in TIME_WAIT</a></li></ul></li><li><a href="#os-tuning" class="table-of-contents__link toc-highlight">OS Level Tuning</a><ul><li><a href="#key-relevant-kernel-options" class="table-of-contents__link toc-highlight">Key Relevant Kernel Options</a></li><li><a href="#sysctl-based-configuration" class="table-of-contents__link toc-highlight">sysctl-based Configuration</a></li></ul></li><li><a href="#socket-gen-tcp-options" class="table-of-contents__link toc-highlight">TCP Socket Options</a><ul><li><a href="#socket-gen-tcp-options-common" class="table-of-contents__link toc-highlight">Common Options</a></li><li><a href="#socket-gen-tcp-options-defaults" class="table-of-contents__link toc-highlight">Defaults</a></li></ul></li><li><a href="#heartbeats" class="table-of-contents__link toc-highlight">Heartbeats</a></li><li><a href="#nettick" class="table-of-contents__link toc-highlight">Net Tick Time</a></li><li><a href="#tcp-keepalives" class="table-of-contents__link toc-highlight">TCP Keepalives</a></li><li><a href="#handshake-timeout" class="table-of-contents__link toc-highlight">Connection Handshake Timeout</a><ul><li><a href="#tls-handshake" class="table-of-contents__link toc-highlight">TLS Handshake</a></li></ul></li><li><a href="#dns" class="table-of-contents__link toc-highlight">Hostname Resolution and DNS</a><ul><li><a href="#dns-resolution-by-clients" class="table-of-contents__link toc-highlight">Performed by Client Libraries</a></li><li><a href="#dns-resolution-by-nodes" class="table-of-contents__link toc-highlight">Short and Fully-qualified RabbitMQ Node Names</a></li><li><a href="#dns-reverse-dns-lookups" class="table-of-contents__link toc-highlight">Reverse DNS Lookups</a></li><li><a href="#the-inetrc-file" class="table-of-contents__link toc-highlight">The inetrc File</a></li><li><a href="#dns-verify-resolution" class="table-of-contents__link toc-highlight">Verify Hostname Resolution</a></li></ul></li><li><a href="#logging" class="table-of-contents__link toc-highlight">Connection Event Logging</a></li><li><a href="#troubleshooting-where-to-start" class="table-of-contents__link toc-highlight">Troubleshooting Network Connectivity</a></li><li><a href="#firewalls-mac-os" class="table-of-contents__link toc-highlight">MacOS Application Firewall</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn about RabbitMQ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Reach out to the RabbitMQ team</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rabbitmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/rabbitmq/rabbitmq-server/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact?utm_source=rmq_release-information_tableheader&amp;utm_medium=rmq_website&amp;utm_campaign=tanzu">Long Term Commercial Support</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact">Contact Us</a></li><li class="footer__item"><a href="https://www.rabbitmq.com/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Broadcom</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tanzu.vmware.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VMware Tanzu<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/legal.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/trademark-guidelines">Trademark Guidelines</a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy/california-privacy-rights.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Your California Privacy Rights<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item ot-sdk-show-settings">Cookie Settings</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2005-2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div>
</body>
</html>