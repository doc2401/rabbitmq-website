<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Finding bottlenecks with RabbitMQ 3.3 | RabbitMQ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" name="twitter:image" content="https://www.rabbitmq.com/rabbitmq-website/img/rabbitmq-social-media-card.svg"><meta data-rh="true" property="og:url" content="https://www.rabbitmq.com/rabbitmq-website/blog/2014/04/14/finding-bottlenecks-with-rabbitmq-3-3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Finding bottlenecks with RabbitMQ 3.3 | RabbitMQ"><meta data-rh="true" name="description" content="One of the goals for RabbitMQ 3.3 was that you should be able to find bottlenecks in running systems more easily. Older versions of RabbitMQ let you see that you were rate-limited but didn&#x27;t easily let you see why. In this blog post we&#x27;ll talk through some of the new performance indicators in version 3.3."><meta data-rh="true" property="og:description" content="One of the goals for RabbitMQ 3.3 was that you should be able to find bottlenecks in running systems more easily. Older versions of RabbitMQ let you see that you were rate-limited but didn&#x27;t easily let you see why. In this blog post we&#x27;ll talk through some of the new performance indicators in version 3.3."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2014-04-14T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Performance,New Features"><link data-rh="true" rel="icon" href="/rabbitmq-website/img/rabbitmq-logo.svg"><link data-rh="true" rel="canonical" href="https://www.rabbitmq.com/rabbitmq-website/blog/2014/04/14/finding-bottlenecks-with-rabbitmq-3-3"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/blog/2014/04/14/finding-bottlenecks-with-rabbitmq-3-3" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.rabbitmq.com/rabbitmq-website/blog/2014/04/14/finding-bottlenecks-with-rabbitmq-3-3" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://H10VQIW16Y-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.rabbitmq.com/rabbitmq-website/blog/2014/04/14/finding-bottlenecks-with-rabbitmq-3-3","mainEntityOfPage":"https://www.rabbitmq.com/rabbitmq-website/blog/2014/04/14/finding-bottlenecks-with-rabbitmq-3-3","url":"https://www.rabbitmq.com/rabbitmq-website/blog/2014/04/14/finding-bottlenecks-with-rabbitmq-3-3","headline":"Finding bottlenecks with RabbitMQ 3.3","name":"Finding bottlenecks with RabbitMQ 3.3","description":"One of the goals for RabbitMQ 3.3 was that you should be able to find bottlenecks in running systems more easily. Older versions of RabbitMQ let you see that you were rate-limited but didn't easily let you see why. In this blog post we'll talk through some of the new performance indicators in version 3.3.","datePublished":"2014-04-14T00:00:00.000Z","author":{"@type":"Person","name":"Simon MacMullen"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.rabbitmq.com/rabbitmq-website/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/rabbitmq-website/blog/rss.xml" title="RabbitMQ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/rabbitmq-website/blog/atom.xml" title="RabbitMQ Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="RabbitMQ" href="/rabbitmq-website/opensearch.xml">







<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,700">
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-domain-script="018ee308-473e-754f-b0c2-cbe82d25512f"></script>
<script>function OptanonWrapper(){}</script>
<script>function setGTM(e,t,o,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=t.getElementsByTagName(o)[0],a=t.createElement(o),s="dataLayer"!=n?"&l="+n:"";a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+r+s,i.parentNode.insertBefore(a,i)}var timer;function waitForOnetrustActiveGroups(){document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?(clearTimeout(timer),setGTM(window,document,"script","dataLayer","GTM-TT84L8K")):timer=setTimeout(waitForOnetrustActiveGroups,250)}document.cookie.indexOf("OptanonConsent")>-1&&document.cookie.indexOf("groups=")>-1?setGTM(window,document,"script","dataLayer","GTM-TT84L8K"):waitForOnetrustActiveGroups()</script><link rel="stylesheet" href="/rabbitmq-website/styles.css">
<script src="/rabbitmq-website/runtime~main.js" defer="defer"></script>
<script src="/rabbitmq-website/main.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:var(--ifm-color-primary-contrast-background);color:var(--ifm-font-color-base)" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong style="font-size: var(--ifm-h4-font-size);"><a href="https://github.com/rabbitmq/rabbitmq-server/releases/tag/v4.1.0">RabbitMQ 4.1.0 is out</a></strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rabbitmq-website/"><div class="navbar__logo"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rabbitmq-website/img/rabbitmq-logo-with-name.svg" alt="RabbitMQ" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/rabbitmq-website/tutorials">Getting Started</a><a class="navbar__item navbar__link" href="/rabbitmq-website/docs">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rabbitmq-website/blog">Blog</a><a class="navbar__item navbar__link" href="/rabbitmq-website/contact">Support</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/rabbitmq-website/docs">4.1</a><ul class="dropdown__menu"><li class=""><strong>Release series</strong></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/next">Next</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs">4.1</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/4.0">4.0</a></li><li><a class="dropdown__link" href="/rabbitmq-website/docs/3.13">3.13</a></li><li><a href="https://v3-12.rabbitmq.com/documentation.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.12<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/rabbitmq-website/release-information">Release Information</a></li></ul></div><a href="https://github.com/rabbitmq/rabbitmq-website" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1"><article class=""><header><h1 class="title_f1Hy">Finding bottlenecks with RabbitMQ 3.3</h1><div class="container_mt6G margin-vert--md"><time datetime="2014-04-14T00:00:00.000Z">April 14, 2014</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Simon MacMullen</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>One of the goals for RabbitMQ 3.3 was that you should be able to find bottlenecks in running systems more easily. Older versions of RabbitMQ let you see that you were rate-limited but didn&#x27;t easily let you see why. In this blog post we&#x27;ll talk through some of the new performance indicators in version 3.3.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-flow-control">Understanding flow control<a href="#understanding-flow-control" class="hash-link" aria-label="Direct link to Understanding flow control" title="Direct link to Understanding flow control">​</a></h3>
<p><img decoding="async" loading="lazy" src="/rabbitmq-website/assets/images/flow-q-0bff0b55723d8a3ca5c1ab596f696c95.png" width="456" height="144" class="img_ev3q"></p>
<p>Since the introduction of flow control in RabbitMQ 2.8.0, you&#x27;ve been able to see when a connection has gone into the flow-controlled state. This (roughly) means that the client is being rate-limited; it would like to publish faster but the server can&#x27;t keep up. Of course, the next question you&#x27;ll want to ask is &quot;why?&quot;.</p>
<p>The flow control mechanism has always extended throughout the server; not just connections but channels and queues can be in the flow-control state, meaning that they would like to publish messages faster, but something ahead of them can&#x27;t keep up. So to make sense of the new flow control information you need to know that <strong>a component will go into flow control if anything it is publishing to is a bottleneck - or is in flow control itself</strong>. The order that components handle messages on their way into the server is:</p>
<p><em>Network</em><br>
<!-- -->   ↓<br>
<strong>Connection process</strong> - AMQP parsing, channel multiplexing<br>
<!-- -->   ↓<br>
<strong>Channel process</strong> - routing, security, coordination<br>
<!-- -->   ↓<br>
<strong>Queue process</strong> - in-memory messages, persistent queue indexing<br>
<!-- -->   ↓<br>
<strong>Message store</strong> - message persistence</p>
<p>So what possible outcomes are there?</p>
<ul>
<li><em>A connection is in flow control, but none of its channels are</em> - This means that one or more of the channels is the bottleneck; the server is CPU-bound on something the channel does, probably routing logic. This is most likely to be seen when publishing small transient messages.</li>
<li><em>A connection is in flow control, some of its channels are, but none of the queues it is publishing to are</em> - This means that one or more of the queues is the bottleneck; the server is either CPU-bound on accepting messages into the queue or I/O-bound on writing queue indexes to disc. This is most likely to be seen when publishing small persistent messages.</li>
<li><em>A connection is in flow control, some of its channels are, and so are some of the queues it is publishing to</em> - This means that the message store is the bottleneck; the server is I/O-bound on writing messages to disc. This is most likely to be seen when publishing larger persistent messages.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="consumer-utilisation">Consumer utilisation<a href="#consumer-utilisation" class="hash-link" aria-label="Direct link to Consumer utilisation" title="Direct link to Consumer utilisation">​</a></h3>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASUAAACUCAYAAADVhj8TAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB94EDhAkODRz/EQAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAU2klEQVR42u3df2jb973v8afuSZRvscBfOVCpXd2oDr1VYPEUmkuVcsGCLbdyDYl2btZqSSHyoLUubanaQqJCUkw2bpTL2mo04SjbJVZZ0ukkh0U9kMQ76aHyODfRHy7VXLjWYSRV526VC7UVsPG3cg86f/hHnNhulF+NG78e4ED0/er74yPl5ffnI6K3rVar1RARWSL+i4ZARBRKIiIKJRH5Lljx17/+VaMgIkuGTQvdIqLpm4iIQklEFEoiIgolEVEoiYgolEREoSQiolASEYWSiIhCSUREoSQiCiWR2+fDDz/UICiUREQUSiJyl1qhIZDl6vBXh+var2tVlwZLlZIsRVYpQyzoxbTZsNlsGG4vgUiSfAWw8kQ9HmIFq86DXef+AtV+dm3Zwr6BqkJJBCtPzB+h19NN7yejjI5+Qj4Tx2/lyZc1PN8KeyuvvnWILq9doSRCKUeu4iUWD+P3mJimB18gQiKTIea1yIWDHP70U3614R5sNgNfogiUyYS9mMZMZeUnki5isdj+YJWyxAIeDJsNm+kllMxTWZJVywD7tm1n3/Ej7Hl2G+3tOzlysZ9dW3ZyZGh2Jwb2bWPn4QtUZ5+zjT1H3mbXzm20t7ezfddxBsfmHvObtl/gyO7dHL9Qvfa+QHXoLG88P7WtfdtOdm5p5/mzIwoluUt4/PjNP5GIJcjkipSvSAqDQKaXrjVreOmjCWo1i0LcC5j44xkK5QkmJiYoZUMUYlGy5UX2twrEgxEKoQzlWo2JQhwSYeL5JTrFq45y/tRFmkMv8vMDcTrurec54xQ/trP51bdI/zrO+os9HOwbrn97vceqXqBnz9sUW+OkT7zHibe62OhUpSR3EyNAKvc7wmSJB9dxn9OG4fETTua+oZIxMK08iXAAn8eNJ/Aaf7pUorDIE6xCkowVIRn1YwKGJ0w8CLlsaYlOp5w8+frrdHW0sbF1HS57fc9pe6GTza3NuJo30dHawGhxhGq92+s8VvXCcc6Ob+LFzo24HHYcza20OlYqlOQuyyVvmEQ2T8mqMfH5IL3dPoovBwlnF0mZUpJgoJtKKEFvsYxV+YCnXQZYC1c+VrnE8KcpAm4T0zQxTTfBTBksi7t1OXxlg/2mti+2b3X0C6pOb31BqVCS76Yrg2Hqk7duYo9BqXh5pXtu3lTyWQqeOIloAI9pLHzUOfsbphvXIzHylQqVmR/Lopj0YXxHRsnOJJPVO//pmN3egH38M8a+gx/UKZSkvkjKx/H7IyQyeYrlCpVKiXw6TqLgIRT0gOHGa5bJ54pUrArlioXh9mCWsmTzZcqlPOlYjOywNZNq8/f3xwhZKaLxXooVC6tSotCbJp2rfEcSyUWLc5RzpwcYGh5i4NTbvN0/zuSduJSWzbSM9dFz9gIjI8MM9h0jOzSpUJK7a+oW81fIxoOsu8+J0+kllLSIZHMkfAbgIZyIQGIDznvchDNljECCdNQisek+7vNFyBgB/I0zNc/8/TH8JHMpfIUYfuc93OP0EurupfJdKZNo5qlXQzT17eW5yPO8cd7BprV3aB2nqY14vI3RnhfYsSNC4tQY9zq/G2tKakYpd5UPP/yQRx99VAMxzzAnn32eD7ve5Rcbl/ZCkyolkbtSlaFzffRfGGZsbIQLfUc4MdrC5palv/Kt//smcpcaPX+Ufe9/xiSw8t71dMTjtDVp+iai6Zto+iYiCiUREYWSiCiUREQUSiKiUBIRUSiJiCiUREShJCKiUBIRhZKIiEJJRBRKIiIKJRFRKMmdYFHKxgn53FMNGm0mHn+IWLpARYNzi4zQ/8Z2tu8foKrBUCjJNyulgvjCvbhjWYqjE4x+nicd9VBIpShaGp+bNXZuHzu3Rdj7/qgCaamoydI1eqa2tbGx9sTvPl9g48TUnx/9Q+3pHzTWgBqux2pdvxuc2jLxQe1pl6u2dfdLtScemdq+5on9tfMTswevfbB/a+2RRmpArXFNW63r5Oe12sSZ2hONj9T2D14+zwdPu2prXvpokeOuqv1gZ0/tow8uX0fjD7pqZ+Zc8sQnJ2svta2prYIajY/Utr51vjY6e6w1taff2l3b+gNXDR6p7R9c5Lrq1N/ffwMD/VXt///yp7X/+b//VPtK77o7TpXSUp64FTPkLT+xoHuBrQZYOaLBOOVIL6O1Gp9nQxSiIeKF6RLKGiaXh0g6zyeDJwkUuomlp3q0Wfk4kSR0FyaoTYyST0fw1ds1xBomlzemjvtREnemkw3RHP5Ens8/+YAoaWLJ4vS+12jFbX3KP6aKeGMpznyQ5sfDN3FdclfQd3QvZZUyFdPDIn0csfIpeo0w2ek21/hjJEJJIqkCiSRgrCGSTBCeboEUCZhECiUs3ICFVSlTKJYIerx4AxG8U0tY12asIZLsnj6uSdgXoxJNToenh3DQTapYxsIL0624e2eu0RMmHuwmki2Bb+pYL2Uy022apu5pwesSrSnJEmC6MSslKosEhVUpUzG9uI3L1ZPba1IpLbwEbpjGbOgY/gTpmJveyDqcNgOPP0L6hhapDEzDuOLvU+eZOtb1tuK+ddclCiW55QxvCL+RI9lbXiiSMEw3ZqVI2br8WLlQwfSYdRzdTTCRpVCuMfF5nm5PL9FoljIGBhYV69YEwfW34l7sukShJEugUgqS6PaR+2mASCpHoVShUi6SS8cI+mMUfFGCVoZ4Kk8FKOeTxHtNQtHF/sHPnfoliKdzFCsWhtuN2zQwTBPDcON3l8mmcxRLU+eKZYdvPJSusxX3oteld4NCSZZErYQ3lqPQE6ScDLHhISfO+3xEUiV8sSheM0CqN4E7HcRps3FfKIsvlZ1dn/nmwDMpJcP4nPdgs3mIlsJkUkFMvERTMdyZdtY95COaNQn6G2/iFq6zFfei13V7jPXtYlv7Vl55f5TxP+5ma/s2dp0b01vvDlLfN7mrqO+bKiUREYWSiCiUREQUSiKiUBIRUSiJiCiUREShJCKiUBIRhZKIiEJJRBRKIiIKJRFRKImIKJRERKEkIqJQEhG5c6GkFtTfPDx5oh4PscKcL+23egkaJuGcBVaeiHt6+9zHb8e5boOvh3P85pf/wB8uWmD9hT/89iDJAwc4cOAAyZ5TfPzl1zM7kv/tLzn43kVuax+T4ZM8295O+9U/295g8Op2udULHH++nfZnT3H5G8urXDi5h53bt7N92052HRlk9ot0R/rYs3MP+mbd6/et9n0rpYL4YhXCqSzFkA/TKlHoTdGdSlEMp/Dr2+HnMwKkCnkMj1Hf47fjXLckkb6k/5/74b938sMWA6y/497v/w++/+T9NK4YYfDUcU7/87082PnfaFzhwv/jDi7+39P861+idDx4m96mrh9z6MTmK9p1j57dy8unW2iyX5FenNq3j1PVhiufP9bP4WOjPHXoXTpWnuXl5w7SFzpER1OVCyeOMtr2Oo879BZeupVSpZdYvIA/3Usq4sdjGphuL4FIklw+id8Aq5Ai7DOx2WzY3H6imeLUb0orR9jtJhSPEfRObfcEE+Rnf41WyCVCeE0bNpsN0xMgmi1P/eY3vSSKlyu1XNiNJ1ZY5LgGvkiaQu7ydZi+KHM7HFmlLLGAZ6rSM72EklOdRKaO5SGcnKoEbba5551TiSx6PRa5cJDDn37KrzbcM3UtiSJYBboDQRJX9z674vFF7p8ymbAX05h63HD7iaSLdZ/rxl+PBQqzv/SR/2odT2xcPfWb0PgeGzb8V7632oGj8UHWb3DB+Ahj08USjnU84V/FYN/HXLqNb0u7w4Fj5sc+xPETQ7R2bcY1u8cI5/bvIut6kV885WLl3CePDzOKi2Yn4HiAB+xjfDZahZHz9JxrZsdTzUqYpRxKy7EFddhzXWUKgUwvXWvW8NJHE9RqFoV4fb1hF79/E388Q6E8wcTEBKVsiEIsSrZcx7lu4vVYoEzib/1/YdW6jdy/YuEq6uP+YRoeWodrzvbV3/ezerjAxUvfznt0+NRB+pw76Nw4U96MMXB4L4cnf8aBFzfScPUTGly4GKI4XIXRi1ysNtHiZKpK6uhUlbT0K6X6WlAnpts7u/0xEqEK2dR0VTPTgtrvxeMNEgmYlAul6TWHyy2oK4aJNxAhumD4LZQF0y2o/V48vhBh3yoeiyeJBb24PX7CQTflYhkLsKZbUCenr9HwhIkHIZctzR7rpUyGRCREMODH861NRxe7fwPTypMIB/B53HgCr/GnSyUKlXqC7mZej/mh88mXK7j/4dXz1gusv37Eez2/pb/hh/z0iQev3O64n3WNl/jzzFrT7TQ9FdvUtZnm2ZDaxxsXnuQX8TaaFnqO43Fe7PLStyfC9l2neaDzFdro4/C5FjqfdDJ4fA/Pbt/O9p27OHxuRGmz5EJpGbag/taWnRa7/1KSYKCbSihBb7GMVfmAp12X7+cbQ+kmXo/5vuLSf6zC1bBiXgX1Rf//Y+j+v+fZv9/A6nlVVANNxteMj9/+0R06fph+1w5+1uqYXcQeKX7GFx8f5LmtUwvgO968yORnB4m0v0zfdMa4Nr/KoXfe5d13DvFah4sLx44z3vEMreOnefN4lWcOvks63kzfwZ75i+dyZ0Npebagnh969VzP9V/uwvf/7/ksBU+cRDSAZ5ESdbFz3dzrUa8VNLY8zLqHm77dT1yuNtLH29lx2l6Yu5ZkZ92r73LmzJnZn2OvtLDygRdIn3mLtqaFj9PT30Lnk80wfIFx50ZamsDe3Ipr7DO+UCgttUpp+bWgnn+Aa1yP4cZrlsnnilSsCuVKfem02P03uj2YpSzZfJlyKU86FiM7bNV1LsN/46/HfKto/LuvGB6fPw1bde/DPNy4WCSNM2KtoKHhds6DqwweO0xxbSed6+w3eZyjTIZ+xkYH2J0uGsaHGKsytYDvuBenXYGztEJpObagnuda1+MhnIhAYgPOe9yEM+U6A3/h+3cHEqSjFolN93GfL0LGCOBvNOo7l3ETr8e8gqiRh1Z/zd/+/CVfXzV9+1vf7/l9/gsWXDUa+xt/vtTIw6tvYx01fJZfn11JxwuLrBtdz3H6W+ncPF1rNYfo2vQZB3fvYlfij7R0/oxWhVJd1LZbvhXWxd+TOr2Kn0Q7+F6dGXMp/xt+M7iRZzs3UO+vErXtVqUkUl+R+WAb/lWD/Ev/l9T1WdrYIH/If8W6H66nUcOnUBK55VasZuOWjXz9b8f514vXWCv7epj8yVN88dCT/PDBFRo7Td9Evrs0fVOlJCKiUBIRhZKIiEJJRBRKIiIKJRERhZKIKJRERBRKIqJQEhFRKImIQklERKEkIgolERGFktxiReIeGzYjRHbuV4pbeaJuGzYzTM5armMzQv8b29m+f4CFvtt/bOAk+1/ezpb2dtrbn+fk3K95H+nnyK7pbVt2suvIwOXW3Vzg8M522rdc1b67Osgb29pp37KPgeqc/ea0Dt+y/Xn2nxpiOfYaUCgtJ8YqGs0c3enS7EPlbDfZOT08lpuxc/vYuS3C3vdHFwmkt3l+z2nsP4pz6NgJThx7nc3Oy2HW9+Y+Tts7OXTiPU689RT20/t484oEggb7AD2nhy7n2Pkezs9rbbkS794TnDlzhvdOHONACP54+PB0aCmU5K5lEoiHsZLd01VRkXSiRDAeuCKWvrk1+XW2Of/G1t9Xtjnf/ZoPw5/m8tOn25pH87etr57j8dd555/+iTd/5Fxg6zBnD/fhevEAr3a00tzkwNHkwjHTAGCsyKkBJ5s722h22HGs3Uxnm53+08U51VID3h1tVLNHpwNmiPePDvPojkfndTeZaQludzhwrLTT0PwoLrtCSe72WPLFiHt66c6UqeQSpM0Ycb85N0Wu0Zr8etqcX6v195Vtzv9XJIqvkCQzU8hVciRzJuEbaut0K2Z1A7x/ESb79rKtvZ329i3s3HOE/plmt6NFhicdtMymix2n1wlDFxmdWymtfYqnXB/S0zfC2MBRTjlCPLP26rSZ5OOfb2fLli20t2/luV8P4f2RF6emb3L3T+E8hLuDlLpjdHfn8cXDeOZWSXW0Jq+7zXkdrb+vaHP+SIiYv0QqMxVqld4kOXeEiO+ORBLV0YuMYueBza/w6/fe4730L+gYz7IvcZYRoFodZxI7DXPyxW63w+TVU0EXbZ2PMnz0ID09Rdbu2IxrJfOnb68cIp1Oc+xYmoM/f4rqsd3sPTWsUJJlkEuBOFHjH/lVOUR34MqOt9fXmvwabc6vs/U3uAnG/JRTKQpWmWwqjzcaxnsnB2uli02PrqXJbsfuaiXUuQl7sY+LVbDbG1i5EibnBlm1CiudXF0HOVqfIcR5To88zo7Z1uBXnarBSVNTE01NLtZuDNG12UHx9AAjy+z9qVYRy5KXaLoH0wrhNbgibGZak+eKiflhYOWuL/zmtP72GFNrRJdbfy+8SmQGYgStKMmsm0LBRzzjuWOjZHd6cdHHx8NVHp9dSJoEe8NU6DjX4qKP4jC0OQCqjBZHwfXAAtOuZp6Mv0DDZBtr7dT3qVoVVtrtLLdlJVVKy3VtyR8helWVBLegNfkVx7qB1t9mgGjQ4p3Ia5QCcYLuOzhITev5SesYpw4eZWCkCiODZHv6sW/qwGsHHOvp8I5y9thZhsaqjF04S0/fGK2hVhaqhRzrOuhYpEqairsq1WqVanWEof6jHDw7hvfJ9ThUKcnynttNtSaPR2P4nf/OJVax5rEQsWToRuaJpHoTRCJBnC9fAtdjdM20/l704zQDfyzMmnfS+GMBzNt8u2N9u4gkPmYcgN1s/WMD6/em+T+PO4AmHo8f4JlEgj07TjBJAy0/epEDL7ZOVy9NtMVfp5h4k+d+8iasdLI+9Drxx28kRiYp/nwHW2f+2tDCps4DvLK5adm9BdX3TZYcKxfBEzHIFlP4r3ONW33fVCmJ3GIVepNZzHD+ugNJ7g5aU5KlpZwlmfMQjXo1FqqURJYAd4RcJaJxUKUkIqJQEhFRKImIQklERKEkIgolERGFkogolEREFEoiolASEfnW6VsCRESVkoiIQklEFEoiIgolEVEoiYgolEREoSQiolASEYWSiIhCSUREoSQiCiUREYWSiCiUREQUSiKiUBIRUSiJiEJJREShJCIKJRERhZKIiEJJRJag/wTQVl8LALATQgAAAABJRU5ErkJggg==" width="293" height="148" class="img_ev3q"></p>
<p>So hopefully you can now better understand the performance of the publishing side of your server. So what about the consuming side? The flow control mechanism doesn&#x27;t extend as far as consumers, but we do have a new metric to help you tell how hard your consumers are working.</p>
<p>That metric is <em>consumer utilisation</em>. The definition of <strong>consumer utilisation is the proportion of time that a queue&#x27;s consumers could take new messages</strong>. It&#x27;s thus a number from 0 to 1, or 0% to 100% (or N/A if the queue has no consumers). So if a queue has a consumer utilisation of 100% then it never needs to wait for its consumers; it&#x27;s always able to push messages out to them as fast as it can.</p>
<p>If its utilisation is less than 100% then this implies that its consumers are sometimes not able to take messages. Network congestion can limit the utilisation you can achieve, or low utilisation can be due to the use of too low a <a href="/rabbitmq-website/blog/2014/04/03/an-end-to-synchrony-performance-improvements-in-3-3">prefetch limit</a>, leading to the queue needing to wait while the consumer processes messages until it can send out more.</p>
<p>The following table shows some approximate values for consumer utilisation I observed when consuming tiny messages over localhost with a single consumer:</p>
<table><thead><tr><th>Prefetch limit</th><th>Consumer utilisation</th></tr></thead><tbody><tr><td>1</td><td>14%</td></tr><tr><td>3</td><td>25%</td></tr><tr><td>10</td><td>46%</td></tr><tr><td>30</td><td>70%</td></tr><tr><td>1000</td><td>74%</td></tr></tbody></table>
<p>You can see that the utilisation increases with the prefetch limit until we reach a limit of about 30. After that the network bandwidth limitation starts to dominate and increasing the limit has no further benefit. So you can see that consumer utilisation is an easy way to monitor the performance of our consumers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="learn-more">Learn More<a href="#learn-more" class="hash-link" aria-label="Direct link to Learn More" title="Direct link to Learn More">​</a></h2>
<ul>
<li>Webinar: <a href="https://content.pivotal.io/webinars/may-23-what-s-new-in-rabbitmq-3-8-webinar?utm_campaign=rabbitmq-blog-3.8-webinar-q319&amp;utm_source=rabbitmq&amp;utm_medium=website" target="_blank" rel="noopener noreferrer">What&#x27;s new in RabbitMQ 3.8?</a></li>
<li>Webinar: <a href="https://content.pivotal.io/webinars/dec-12-10-things-every-developer-using-rabbitmq-should-know-webinar?utm_campaign=rabbitmq-blog-10-things-q319&amp;utm_source=rabbitmq&amp;utm_medium=website" target="_blank" rel="noopener noreferrer">10 Things Every Developer Using RabbitMQ Should Know</a></li>
</ul>
<p>Process finished with exit code 0</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/rabbitmq-website/blog/tags/performance">Performance</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/rabbitmq-website/blog/tags/new-features">New Features</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/rabbitmq/rabbitmq-website/tree/main/blog/2014-04-14-finding-bottlenecks-with-rabbitmq-3-3/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/rabbitmq-website/blog/2014/10/30/understanding-memory-use-with-rabbitmq-3-4"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Understanding memory use with RabbitMQ 3.4</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rabbitmq-website/blog/2014/04/10/consumer-bias-in-rabbitmq-3-3"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Consumer Bias in RabbitMQ 3.3</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#understanding-flow-control" class="table-of-contents__link toc-highlight">Understanding flow control</a></li><li><a href="#consumer-utilisation" class="table-of-contents__link toc-highlight">Consumer utilisation</a></li><li><a href="#learn-more" class="table-of-contents__link toc-highlight">Learn More</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn about RabbitMQ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/tutorials">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Reach out to the RabbitMQ team</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/rabbitmq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/rabbitmq/rabbitmq-server/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact?utm_source=rmq_release-information_tableheader&amp;utm_medium=rmq_website&amp;utm_campaign=tanzu">Long Term Commercial Support</a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/contact">Contact Us</a></li><li class="footer__item"><a href="https://www.rabbitmq.com/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Broadcom</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tanzu.vmware.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VMware Tanzu<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/legal.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/rabbitmq-website/trademark-guidelines">Trademark Guidelines</a></li><li class="footer__item"><a href="https://www.vmware.com/help/privacy/california-privacy-rights.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Your California Privacy Rights<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item ot-sdk-show-settings">Cookie Settings</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2005-2025 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.</div></div></div></footer></div>
</body>
</html>